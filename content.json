{"meta":{"title":"TangShusen","subtitle":null,"description":null,"author":"TangShusen","url":"https://tangshusen.me"},"pages":[{"title":"About me","date":"2018-11-11T14:41:04.000Z","updated":"2019-01-06T10:00:39.760Z","comments":true,"path":"about/index.html","permalink":"https://tangshusen.me/about/index.html","excerpt":"","text":"è®¡ç®—æœºç ”ä¸€å°ç¡•ä¸€æšEmail: tangshusen96@gmail.com"},{"title":"æ ‡ç­¾","date":"2018-10-27T16:34:16.000Z","updated":"2018-11-10T16:18:46.450Z","comments":true,"path":"tags/index.html","permalink":"https://tangshusen.me/tags/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2018-10-27T16:30:26.000Z","updated":"2018-11-11T14:43:48.261Z","comments":true,"path":"categories/index.html","permalink":"https://tangshusen.me/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"TensorFlow AttentionWrapperæºç è¶…è¯¦ç»†å›¾è§£","slug":"tf-attention","date":"2019-03-09T10:37:19.000Z","updated":"2019-03-12T15:38:44.443Z","comments":true,"path":"2019/03/09/tf-attention/","link":"","permalink":"https://tangshusen.me/2019/03/09/tf-attention/","excerpt":"Attentionåœ¨seq2seqæ¨¡å‹ä¸­æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æœºåˆ¶ï¼Œç”±äºTensorFlowçƒ‚æˆç¿”çš„å®˜æ–¹æ–‡æ¡£ä»¥åŠç½‘ä¸Šå¾ˆå°‘è€Œä¸”æ™¦æ¶©éš¾æ‡‚çš„æ•™ç¨‹ï¼Œæˆ‘åœ¨å¦‚ä½•æ­£ç¡®ä½¿ç”¨TensorFlowç°æˆattentionæ¥å£ä¸Šé¢è´¹äº†å¾ˆå¤§ä¸€ç•ªåŠŸå¤«ã€‚æœ¬æ–‡ç”¨è¯¦ç»†å›¾è§£çš„æ–¹å¼æ¸…æ™°å±•ç°äº†å…¶æºä»£ç æ„æˆï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ä½¿ç”¨ã€‚æœ¬æ–‡ä¼šå…ˆç®€ç•¥çš„ä»‹ç»ä¸€ä¸‹seq2seq attentionçš„åŸç†ï¼Œç„¶åè¯¦ç»†å‰–æTensorFlowç›¸å…³çš„æºä»£ç ï¼Œæ‡’å¾—çœ‹æ–‡å­—åˆ†æçš„å¯ä»¥ç›´æ¥è·³åˆ°2.7èŠ‚çœ‹å›¾ã€‚","text":"Attentionåœ¨seq2seqæ¨¡å‹ä¸­æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æœºåˆ¶ï¼Œç”±äºTensorFlowçƒ‚æˆç¿”çš„å®˜æ–¹æ–‡æ¡£ä»¥åŠç½‘ä¸Šå¾ˆå°‘è€Œä¸”æ™¦æ¶©éš¾æ‡‚çš„æ•™ç¨‹ï¼Œæˆ‘åœ¨å¦‚ä½•æ­£ç¡®ä½¿ç”¨TensorFlowç°æˆattentionæ¥å£ä¸Šé¢è´¹äº†å¾ˆå¤§ä¸€ç•ªåŠŸå¤«ã€‚æœ¬æ–‡ç”¨è¯¦ç»†å›¾è§£çš„æ–¹å¼æ¸…æ™°å±•ç°äº†å…¶æºä»£ç æ„æˆï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ä½¿ç”¨ã€‚æœ¬æ–‡ä¼šå…ˆç®€ç•¥çš„ä»‹ç»ä¸€ä¸‹seq2seq attentionçš„åŸç†ï¼Œç„¶åè¯¦ç»†å‰–æTensorFlowç›¸å…³çš„æºä»£ç ï¼Œæ‡’å¾—çœ‹æ–‡å­—åˆ†æçš„å¯ä»¥ç›´æ¥è·³åˆ°2.7èŠ‚çœ‹å›¾ã€‚ 1. åŸç†ç®€ä»‹1.1 seq2seqseq2seqæ˜¯â€Sequence to Sequenceâ€çš„ç®€å†™ï¼Œseq2seqæ¨¡å‹çš„æ ¸å¿ƒå°±æ˜¯ç¼–ç å™¨ï¼ˆEncoderï¼‰å’Œè§£ç å™¨ï¼ˆDecoderï¼‰ç»„æˆçš„ï¼Œè¯¥æ¶æ„ç›¸ç»§åœ¨è®ºæ–‡[1][2]æå‡ºï¼Œåæ¥[3]åˆæå‡ºäº†åœ¨seq2seqç»“æ„ä¸­åŠ å…¥Attentionæœºåˆ¶ï¼Œä½¿seq2seqçš„æ€§èƒ½å¤§å¤§æå‡ï¼Œç°åœ¨seq2seqè¢«å¹¿æ³›åœ°ç”¨äºæœºå™¨ç¿»è¯‘ã€å¯¹è¯ç”Ÿæˆã€äººä½“å§¿æ€åºåˆ—ç”Ÿæˆç­‰å„ç§ä»»åŠ¡ä¸Šï¼Œå¹¶å–å¾—äº†éå¸¸å¥½çš„æ•ˆæœã€‚ å›¾1.1 seq2seqåŸºæœ¬ç»“æ„ æœªåŠ å…¥attentionæœºåˆ¶çš„seq2seqåŸºæœ¬æ¨¡å‹å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå·¦ä¾§çš„RNNç¼–ç å™¨å°†è¾“å…¥ç¼–ç æˆä¸€ä¸ªä¸­é—´çŠ¶æ€cå‘é‡ï¼Œå³ä¾§çš„è§£ç å™¨åœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥éƒ½ä¼šæ¥æ”¶cçš„è¾“å…¥ç„¶åè¿›è¡Œè§£ç ï¼Œå¾—åˆ°è¾“å‡ºç»“æœã€‚ä¾‹å¦‚å¦‚æœç¼–ç å™¨çš„è¾“å…¥ä¸ºâ€œæˆ‘çˆ±ä½ â€ï¼Œç¼–ç å™¨çš„æœŸæœ›è¾“å‡ºä¸ºâ€œI love youâ€ï¼Œé‚£ä¹ˆseq2seqå°±å®ç°äº†ç¿»è¯‘ä»»åŠ¡ï¼Œä»¥ä¸Šå°±æ˜¯æœ€åŸºæœ¬çš„seq2seqæ¨¡å‹åŸç†ã€‚ 1.2 attentionä»”ç»†è§‚å¯Ÿå›¾1.1æ‰€ç¤ºçš„æ¨¡å‹å°±å¯ä»¥å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œcå‘é‡æ˜¯è¿æ¥ç¼–ç å™¨å’Œè§£ç å™¨å”¯ä¸€çš„æ¡¥æ¢ï¼Œé‚£ä¹ˆcå‘é‡ä¸­å¿…é¡»åŒ…å«äº†åŸå§‹åºåˆ—ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå½“ç¼–ç å™¨è¾“å…¥åºåˆ—å¾ˆé•¿çš„æ—¶å€™ï¼Œç”±äºRNNå¹¶ä¸èƒ½å¾ˆå¥½åœ°å¯¹å¾ˆé•¿çš„åºåˆ—è¿›è¡Œå»ºæ¨¡ï¼Œcå‘é‡å°±å¾ˆéš¾å›Šæ‹¬è¾“å…¥åºåˆ—æ‰€æœ‰ä¿¡æ¯äº†ï¼Œæ­¤æ—¶è§£ç å™¨ä¹Ÿå°±å¾ˆéš¾æ­£ç¡®åœ°ç”Ÿæˆäº†ã€‚ Attentionæœºåˆ¶è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå¯ä»¥ä½¿å¾—åœ¨è¾“å…¥åºåˆ—é•¿çš„æ—¶å€™ç²¾ç¡®ç‡ä¹Ÿä¸ä¼šæœ‰æ˜æ˜¾ä¸‹é™ï¼Œå®ƒæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿæ—¢ç„¶ä¸€ä¸ªcå‘é‡å­˜ä¸äº†ï¼Œé‚£ä¹ˆå°±å¼•å…¥å¤šä¸ªcå‘é‡: $c_1, c_2, â€¦$ï¼Œç§°ä¸ºcontext vectorã€‚ å›¾1.2 å¸¦attentionçš„seq2seqç»“æ„ å¸¦attentionçš„seq2seqç»“æ„å¦‚å›¾1.2æ‰€ç¤ºï¼Œattentionæœºåˆ¶è·Ÿäººç±»ç¿»è¯‘å¥å­æ—¶å€™çš„æ€è·¯æœ‰äº›ç±»ä¼¼ï¼Œå³å°†æ³¨æ„åŠ›å…³æ³¨äºæˆ‘ä»¬ç¿»è¯‘è¯è¯­å¯¹åº”çš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ã€‚è€Œ $c_i$ å°±å­˜æ”¾äº†æ­¤åˆ»è¾“å…¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™æ ·å½“è§£ç å™¨è§£ç åˆ°ç¬¬ $i$ æ­¥çš„æ—¶å€™é€šè¿‡åˆ†ææ­¤æ—¶è¾“å…¥åºåˆ—çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å³å¯ç²¾å‡†åœ°è¿›è¡Œè§£ç ã€‚ ä¸‹é¢ç”¨å…¬å¼åŒ–çš„è¯­è¨€å™è¿°ä¸€ä¸‹åŠ å…¥attentionä¸å¦çš„seq2seqç»“æ„ã€‚åœ¨æ²¡æœ‰å¼•å…¥attentionä¹‹å‰ï¼Œç¼–ç å™¨åœ¨æŸä¸ªæ—¶åˆ»è§£ç çš„æ—¶å€™å®é™…ä¸Šæ˜¯ä¾èµ–äºä¸‰ä¸ªéƒ¨åˆ†çš„ï¼ˆå›¾1.1æ²¡æœ‰ç”»å‡ºï¼‰ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“RNNä¸­ï¼Œæ¯æ¬¡è¾“å‡ºç»“æœä¼šä¾èµ–äºéšè—æ€å’Œè¾“å…¥ï¼ˆåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¿™ä¸ªè¾“å…¥å°±æ˜¯ground truthï¼Œåœ¨æµ‹è¯•æ—¶è¿™ä¸ªè¾“å…¥å°±æ˜¯ä¸Šä¸€æ­¥çš„è¾“å‡ºï¼‰ï¼Œåœ¨seq2seqæ¨¡å‹ä¸­ï¼Œè¿˜éœ€è¦ä¾èµ–äºcå‘é‡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è®¾åœ¨ $i$ æ—¶åˆ»ï¼Œè§£ç å™¨è§£ç çš„æœŸæœ›è¾“å‡ºæ˜¯ $y_i$ï¼Œä¸Šä¸€æ¬¡è§£ç ç»“æœï¼ˆçš„ground truthï¼‰æ˜¯ $y_{i-1}$ï¼Œæ­¤æ—¶åˆ»éšè—æ€æ˜¯ $h_iâ€™$ï¼Œæ‰€ä»¥å®ƒä»¬æ»¡è¶³è¿™æ ·çš„å…³ç³»ï¼š$$y_i = f(y_{i-1}, h_iâ€™, c) \\tag{1.1}$$å³æ¯æ¬¡çš„è§£ç è¾“å‡ºæ˜¯ä¸Šä¸€ä¸ªéšè—æ€å’Œä¸Šä¸€ä¸ªè¾“å‡ºç»“æœå’Œcå‘é‡å…±åŒè®¡ç®—å¾—å‡ºçš„ã€‚ é‚£ä¹ˆåŠ å…¥attentionæœºåˆ¶åï¼Œå°†æ¯æ—¶åˆ»å›ºå®šçš„cå‘é‡æ¢æˆ $c_i$ï¼Œæœ‰$$y_i = f(y_{i-1}, h_iâ€™, c_i) \\tag{1.2}$$ é‚£ä¹ˆä¸Šä¸‹æ–‡ä¿¡æ¯ $c_i$ æ˜¯æ€ä¹ˆè®¡ç®—å¾—æ¥çš„å‘¢ï¼Ÿç›®å‰å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼å°±æ˜¯Bahdanau attention[3]å’ŒLuong attention[4]ï¼Œä¸‹é¢å°±åˆ†åˆ«æ¥ä»‹ç»ä¸€ä¸‹ã€‚ 1.2.1 Bahdanau attentionå‡è®¾ç¼–ç å™¨çš„æ‰€æœ‰æ—¶åˆ»çš„éšè—æ€ï¼ˆhidden stateï¼‰ä¸º $h_1, h_2, â€¦, h_{T_x}$ï¼Œåˆ™æœ‰$$c_i = \\sum_{j = 1}^{T_x} \\alpha_{ij}h_j \\tag{1.3}$$è¿™é‡Œ $\\alpha_{ij}$ ä¸ºæ¯ä¸€ä¸ªç¼–ç å™¨è¾“å‡ºçš„éšè—æ€ $h_j$ è¢«åˆ†é…åˆ°çš„æƒé‡ï¼Œå®ƒçš„å€¼è¶Šå¤§ä»£è¡¨å¯¹ç¼–ç å™¨ $j$ æ—¶åˆ»è¾“å…¥çš„æ³¨æ„åŠ›å°±è¶Šå¤§ã€‚è€Œ $\\alpha_{ij}$ çš„è®¡ç®—æ³•æ–¹å¼å¦‚ä¸‹ï¼š$$\\alpha _ { i j } = \\frac { \\exp \\left( e _ { i j } \\right) } { \\sum _ { k = 1 } ^ { T _ { x } } \\exp \\left( e _ { i k } \\right) } \\tag{1.4}$$$$e _ { i j } = a \\left( h_{i-1}â€™ , h _ { j } \\right) = v _ { a } ^ { T } \\tanh \\left( \\boldsymbol{W_a} h_{i-1}â€™ + \\boldsymbol{U_ a} h _ { j } \\right) \\tag{1.5}$$ä¹Ÿå°±æ˜¯è¯´ï¼Œæƒé‡ $\\alpha_{ij}$ å°±æ˜¯è§£ç å™¨éšè—æ€ $h_{i-1}â€™$ å’Œç¼–ç å™¨éšè—æ€ $h_j$ è®¡ç®—å¾—åˆ°ä¸€ä¸ªæ•°å€¼ $e_{ij}$ ï¼ˆä¸€èˆ¬ç§°ä¸ºå¾—åˆ†ï¼Œscoreï¼‰å†ç»è¿‡softmaxå½’ä¸€åŒ–å¾—åˆ°çš„ã€‚ 1.2.2 Luong attentionLuong attention[4]ä¸Bahdanau attentionæœ€å¤§çš„ä¸åŒå°±æ˜¯è®¡ç®—å¾—åˆ†çš„æ–¹å¼ä¸åŒï¼Œè®ºæ–‡[4]ä¸­ç»™å‡ºäº†ä¸€ä¸‹ä¸‰ç§è®¡ç®—æ–¹å¼ï¼š$$e_{ij} = \\text{score} (h_iâ€™, h_j) = \\begin{cases} \\begin{array} { l l } { h_iâ€™^ { \\top } h_j } &amp; { \\text { dot } } \\\\{ h_iâ€™^ { \\top } \\boldsymbol {W_a} h_j } &amp; { \\text { general } } \\\\ { v_a ^ { \\top } \\tanh \\left( \\boldsymbol { W_a } \\left[ h_iâ€™ ; h_j \\right] \\right) } &amp; { \\text { concat} } \\end{array} \\end{cases} \\tag{1.6}$$å¸¸ç”¨çš„è®¡ç®—æ–¹å¼å°±æ˜¯å¼ $(1.6)$ ä¸­çš„â€generalâ€ï¼Œå³ç”¨ $\\boldsymbol { W_a }$ ç»Ÿä¸€ $h_i$ å’Œ $h_j$ çš„ç»´åº¦å†ä½œå…§ç§¯ï¼ˆâ€dotâ€ç›¸å½“äºæ˜¯â€generalâ€çš„ç‰¹æ®Šæƒ…å†µï¼Œå³ $h_i$ å’Œ $h_j$ çš„ç»´åº¦å·²ç»ç»Ÿä¸€äº†ï¼‰ã€‚ 1.2.3 å°èŠ‚ç»¼ä¸Šï¼Œattentionæœºåˆ¶çš„å¤§è‡´åŸç†å°±æ˜¯é€šè¿‡åœ¨è§£ç çš„æ¯ä¸€æ­¥è®¡ç®—ä¸€ä¸‹æ­¤åˆ»åº”è¯¥å¯¹ç¼–ç å™¨æ¯æ—¶åˆ»çš„è¾“å…¥èµ‹äºˆå¤šå°‘æ³¨æ„åŠ›ï¼Œç„¶åå†æœ‰é’ˆå¯¹æ€§åœ°è¿›è¡Œè§£ç ã€‚ä½†é™¤äº†è®¡ç®—åˆ†æ•°çš„æ–¹å¼æœ‰å¾ˆå¤šæ–¹å¼ï¼Œattentionçš„å…·ä½“ç»†èŠ‚èŠ±æ ·è¿˜æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚æ˜¯å¦å°†è§£ç å™¨å‰ä¸€æ­¥å¾—åˆ°çš„ $c_{i-1}$ ä½œä¸ºæ­¤åˆ»è§£ç å™¨çš„è¾“å…¥ï¼Œæ˜¯å¦å°†ç¼–ç å™¨æ‰€æœ‰éšè—æ€éƒ½å‚ä¸æ³¨æ„åŠ›è®¡ç®—ç­‰ç­‰ã€‚ä¸‹ä¸€èŠ‚æˆ‘ä»¬é€šè¿‡å¯¹TensorFlowçš„æºç è¿›è¡Œå‰–ææ¥çœ‹çœ‹TensorFlowæ˜¯æ€ä¹ˆå®ç°çš„ã€‚ 2. TensorFlowæºç å‰–æ2.1 æ¦‚è§ˆåœ¨TensorFlowä¸­ï¼ŒAttention çš„ç›¸å…³å®ç°ä»£ç æ˜¯åœ¨tensorflow/contrib/seq2seq/python/ops/attention_wrapper.pyæ–‡ä»¶ä¸­ï¼Œè¿™é‡Œé¢æˆ‘ä»¬éœ€è¦å…³æ³¨çš„æœ‰å¦‚ä¸‹å‡ ä¸ªç±»ï¼š AttentionMechanism: æ‰€æœ‰attentionæœºåˆ¶çš„çˆ¶ç±»ï¼Œå†…éƒ¨æ²¡æœ‰ä»»ä½•å®ç°ã€‚ _BaseAttentionMechanism: ç»§æ‰¿è‡ªAttentionMechanismï¼Œå®šä¹‰äº†attentionæœºåˆ¶çš„ä¸€äº›å…¬å…±æ–¹æ³•å®ç°å’Œå±æ€§ã€‚ BahdanauAttentionå’ŒLuongAttentionï¼šå‡ç»§æ‰¿è‡ª_BaseAttentionMechanismï¼Œåˆ†åˆ«å®ç°äº†1.2èŠ‚æ‰€è¿°çš„ä¸¤ç§attentionæœºåˆ¶ã€‚ AttentionWrapper: ç”¨äºå°è£…RNNCellçš„ç±»ï¼Œç»§æ‰¿è‡ªRNNCellï¼Œæ‰€ä»¥è¢«å®ƒå°è£…åä¾ç„¶æ˜¯ä¸€ä¸ªRNNCellç±»ï¼Œåªä¸è¿‡æ˜¯å¸¦äº†attentionçš„åŠŸèƒ½ã€‚ AttentionWrapperStateï¼šç”¨æ¥å­˜æ”¾è®¡ç®—è¿‡ç¨‹ä¸­çš„stateï¼Œå‰é¢è¯´äº†AttentionWrapperå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªRNNCellï¼Œé‚£ä¹ˆå®ƒä¹Ÿæœ‰éšè—æ€ï¼ˆhidden stateï¼‰ä¿¡æ¯ï¼ŒAttentionWrapperStateå°±æ˜¯è¿™ä¸ªstateã€‚é™¤äº†RNN cell stateï¼Œå…¶ä¸­è¿˜é¢å¤–å­˜æ”¾äº†ä¸€äº›ä¿¡æ¯ã€‚ æ­¤å¤–è¿˜æœ‰_BaseMonotonicAttentionMechanismã€BahdanauMonotonicAttentionã€LuongMonotonicAttentionä»¥å®ç°å•è°ƒï¼ˆmonotonicï¼‰attentionæœºåˆ¶ï¼Œä»¥åŠä¸€äº›å…¬å…±çš„æ–¹æ³•ï¼Œå¦‚_luong_scoreã€_bahdanau_scoreã€_prepare_memoryç­‰ç­‰ã€‚ åœ¨è¿›ä¸€æ­¥åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥æ˜ç¡®ä»£ç ä¸­ä¸€äº›æœ¯è¯­çš„æ„æ€ï¼š key &amp; query: Attentionçš„æœ¬è´¨å¯ä»¥è¢«æè¿°ä¸ºä¸€ä¸ªæŸ¥è¯¢ï¼ˆqueryï¼‰ä¸ä¸€ç³»åˆ—ï¼ˆé”®key-å€¼valueï¼‰å¯¹ä¸€èµ·æ˜ å°„æˆä¸€ä¸ªè¾“å‡ºï¼šå°†queryå’Œæ¯ä¸ªkeyè¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—å¾—åˆ°æƒé‡å¹¶è¿›è¡Œå½’ä¸€åŒ–ï¼Œå°†æƒé‡å’Œç›¸åº”çš„é”®å€¼valueè¿›è¡ŒåŠ æƒæ±‚å’Œå¾—åˆ°æœ€åçš„attentionï¼Œè¿™é‡Œkey=valueã€‚ç®€å•ç†è§£å°±æ˜¯ï¼Œqueryç›¸å½“äºå‰é¢è¯´çš„è§£ç å™¨çš„éšè—æ€ $h_iâ€™$ ï¼Œè€Œkeyå°±æ˜¯ç¼–ç å™¨çš„éšè—æ€ $h_i$ã€‚ memory: è¿™ä¸ªmemoryå…¶å®æ‰æ˜¯ç¼–ç å™¨çš„æ‰€æœ‰éšè—æ€ï¼Œä¸å‰é¢çš„keyåŒºåˆ«å°±æ˜¯keyå¯èƒ½æ˜¯memoryç»è¿‡å¤„ç†ï¼ˆä¾‹å¦‚çº¿æ€§å˜æ¢ï¼‰åå¾—åˆ°çš„ã€‚ alignments: è®¡ç®—å¾—åˆ°çš„æ¯æ­¥ç¼–ç å™¨éšè—æ€ $h$ çš„æƒé‡å‘é‡ï¼Œå³ $[\\alpha_{i1}, \\alpha_{i2},â€¦, \\alpha_{iT_x}]$ã€‚ åé¢ä¼šé‡åˆ°è¿™äº›æœ¯è¯­ï¼Œå¦‚æœç°åœ¨è¿˜ä¸æ˜¯å¾ˆæ‡‚çš„å¯ä»¥ç»“åˆåé¢å†ä»”ç»†çœ‹çœ‹ã€‚ æˆ‘ä»¬å…ˆæ¥åˆ†æåˆ†æè¿™äº›ç±»ï¼Œç„¶å2.7èŠ‚ç»™å‡ºäº†æ•´ä¸ªAttentionWrapperçš„ä»£ç æµç¨‹å›¾ã€‚ 2.2 _BaseAttentionMechanismå…ˆæ¥çœ‹çœ‹æœ€åŸºç¡€çš„attentionç±»_BaseAttentionMechanismã€‚å®ƒçš„åˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹ï¼š123456789def __init__(self, query_layer, memory, probability_fn, memory_sequence_length=None, memory_layer=None, check_inner_dims_defined=True, score_mask_value=None, name=None): è¿™é‡Œæœ‰å¾ˆå¤šå‚æ•°ï¼Œä¸‹é¢ä¸€ä¸€è¯´æ˜è¿™äº›å‚æ•°çš„ä½œç”¨ï¼š query_layer: ä¸€ä¸ªtf.layers.Layerå®ä¾‹ï¼Œqueryä¼šé¦–å…ˆç»è¿‡è¿™ä¸€å±‚ï¼› memory: è§£ç æ—¶ç”¨åˆ°çš„æ‰€æœ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¯ç®€å•ç†è§£ä¸ºç¼–ç å™¨çš„æ‰€æœ‰éšè—æ€ï¼Œç»´åº¦ä¸€èˆ¬ä¸º[batch, max_time, enc_rnn_size]ï¼› probability_fn: å°†score $e_{ij}$ è®¡ç®—æˆæ¦‚ç‡ç”¨çš„å‡½æ•°ï¼Œé»˜è®¤ä½¿ç”¨softmaxï¼Œè¿˜å¯ä»¥æŒ‡å®šhardmaxç­‰å‡½æ•°ï¼› memory_sequence_length: å³memoryå˜é‡çš„å®é™…é•¿åº¦ä¿¡æ¯ï¼Œç±»ä¼¼dynamic_rnnä¸­çš„sequence_lengthï¼Œç»´åº¦ä¸º[batch]ï¼Œè¿™ä¼šè¢«ç”¨ä½œmaskæ¥å»é™¤è¶…è¿‡å®é™…é•¿åº¦çš„æ— ç”¨ä¿¡æ¯ï¼› memory_layer: ç±»ä¼¼query_layerï¼Œä¹Ÿæ˜¯ä¸€ä¸ªtf.layers.Layerå®ä¾‹ï¼ˆæˆ–Noneï¼‰ï¼Œmemoryä¼šç»è¿‡è¿™ä¸€å±‚ç„¶åå¾—åˆ°keysã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œï¼ˆç»è¿‡memory_layerå¤„ç†åå¾—åˆ°çš„ï¼‰keyåº”è¯¥å’Œï¼ˆç»è¿‡query_layerå¤„ç†å¾—åˆ°çš„ï¼‰queryçš„ç»´åº¦ç›¸åŒ¹é…ï¼Œç”¨å¼$(1.5)$ä¸ºä¾‹å°±æ˜¯ $W_a h_{i-1}â€™$ è¦å’Œ $U_ah_j$ çš„ç»´åº¦è¦ä¸€è‡´ï¼Œä¸ç„¶æ²¡æ³•ç›¸åŠ ã€‚ check_inner_dims_defined: boolå‹ï¼Œæ˜¯å¦æ£€æŸ¥memoryé™¤äº†æœ€å¤–é¢ä¸¤ç»´å…¶ä»–ç»´åº¦æ˜¯å¦æ˜¯æœ‰å®šä¹‰çš„ã€‚ score_mask_value: åœ¨ä½¿ç”¨probability_fnè®¡ç®—æ¦‚ç‡ä¹‹å‰ï¼Œå¯¹scoreé¢„å…ˆè¿›è¡Œmaskä½¿ç”¨çš„å€¼ï¼Œé»˜è®¤æ˜¯è´Ÿæ— ç©·ã€‚ä½†è¿™ä¸ªåªæœ‰åœ¨memory_sequence_lengthå‚æ•°å®šä¹‰çš„æ—¶å€™æœ‰æ•ˆã€‚ å…¶æ„é€ å‡½æ•°å®Œæˆçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯å°†è¾“å…¥çš„memoryè¿›è¡Œmaskç„¶åç»è¿‡memory_layerå¤„ç†ç§°ä¸ºkeysæ–¹ä¾¿åé¢ä½¿ç”¨ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š123self._values = _prepare_memory(memory, memory_sequence_length, check_inner_dims_defined=check_inner_dims_defined)self._keys = (self.memory_layer(self._values) if self.memory_layer else self._values) 2.3 BahdanauAttentionBahdanauAttentionæ˜¯ç»§æ‰¿è‡ª2.2èŠ‚çš„_BaseAttentionMechanismï¼Œå®ƒçš„æ„é€ å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š123456789def __init__(self, num_units, memory, memory_sequence_length=None, normalize=False, probability_fn=None, score_mask_value=None, dtype=None, name=\"BahdanauAttention\"): è¿™äº›å‚æ•°ä¸­ï¼Œé™¤äº†num_unitså’Œnormalizeå…¶ä»–éƒ½åœ¨_BaseAttentionMechanismå‡ºç°è¿‡è¿™é‡Œä¸å†èµ˜è¿°ã€‚å…ˆè¯´ä¸€ä¸‹num_unitsï¼Œæˆ‘ä»¬çŸ¥é“åœ¨è®¡ç®—å¼$(1.5)$çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ $h_{i-1}â€™$ å’Œ $h_i$ æ¥è¿›è¡Œè®¡ç®—ï¼Œè€ŒäºŒè€…çš„ç»´åº¦å¯èƒ½å¹¶ä¸æ˜¯ç»Ÿä¸€çš„ï¼Œéœ€è¦è¿›è¡Œå˜æ¢å’Œç»Ÿä¸€ï¼Œæ‰€ä»¥å°±æœ‰äº† $W_a$ å’Œ $U_a$ è¿™ä¸¤ä¸ªç³»æ•°ï¼Œå¯¹åº”åœ¨ä»£ç ä¸­å°±æ˜¯ç”¨num_unitsæ¥å£°æ˜äº†ä¸¤ä¸ªå…¨è¿æ¥ Dense ç½‘ç»œï¼Œç”¨äºç»Ÿä¸€äºŒè€…çš„ç»´åº¦ï¼š12345678super(BahdanauAttention, self).__init__( query_layer=layers_core.Dense(num_units, name=\"query_layer\", use_bias=False, dtype=dtype), memory_layer=layers_core.Dense(num_units, name=\"memory_layer\", use_bias=False, dtype=dtype), memory=memory, probability_fn=wrapped_probability_fn, memory_sequence_length=memory_sequence_length, score_mask_value=score_mask_value, name=name) å³è¿™é‡Œçš„num_unitsè®¾ç½®æˆä»»ä½•å€¼éƒ½å¯ä»¥ï¼Œå®ƒç¡®å®šäº†éœ€è¦ä¼ è¿›å…¶çˆ¶ç±»_BaseAttentionMechanismæ„é€ å‡½æ•°çš„å‚æ•°query_layerå’Œmemory_layerã€‚ ç„¶ånormalizeå³æ˜¯å¦è¦åœ¨è®¡ç®—åˆ†æ•°scoreæ—¶å®ç°æ ‡å‡†åŒ–ï¼Œå‡ºè‡ªè®ºæ–‡[5]ï¼Œé»˜è®¤è®¾ä¸ºFalseã€‚è¿™ä¸ªå‚æ•°åœ¨æ¥ä¸‹æ¥è¦è¯´çš„__call__æ–¹æ³•ä¸­ç”¨åˆ°ã€‚ æ¥ä¸‹æ¥å°±æ˜¯__call__æ–¹æ³•äº†:1234567def __call__(self, query, state): with variable_scope.variable_scope(None, \"bahdanau_attention\", [query]): processed_query = self.query_layer(query) if self.query_layer else query score = _bahdanau_score(processed_query, self._keys, self._normalize) # å‰é¢å®šä¹‰äº†query_layeræ˜¯ä¸€ä¸ªDenseå±‚ alignments = self._probability_fn(score, state) next_state = alignments return alignments, next_state è¾“å…¥çš„æ˜¯queryå’Œstate(å…ˆä¸ç®¡è¿™é‡Œçš„stateæ˜¯å•¥)ï¼Œç„¶åå…ˆæŠŠqueryç”¨query_layerï¼ˆå³å‰é¢è¯´çš„å…¨è¿æ¥å±‚ï¼‰è¿›è¡Œå¤„ç†ï¼Œç„¶åå†æŒ‰ç…§Bahdanau Attentionçš„è§„åˆ™è°ƒç”¨å‡½æ•°_bahdanau_scoreè®¡ç®—åˆ†æ•°scoreï¼Œè¿™ä¸ªè®¡ç®—è¿‡ç¨‹ä¸­å¯è®¾ç½®æ˜¯å¦éœ€è¦æ ‡å‡†åŒ–ã€‚å¾—åˆ°åˆ†æ•°åå†è°ƒç”¨_probability_fn(è¿™é‡Œå°±æ˜¯softmaxï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°stateæ²¡æœ‰ç”¨åˆ°)è®¡ç®—å¾—åˆ°æƒé‡å‘é‡alignmentsï¼Œç„¶åæœ€åè¿”å›çš„next_stateå…¶å®ä¹Ÿæ˜¯è¿™ä¸ªalignmentsï¼Œæ‰€ä»¥__call__çš„å‚æ•°stateå…¶å®å°±æ˜¯ä¸Šä¸ªæ—¶é—´æ­¥çš„alignmentså‘é‡ã€‚ æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼ŒBahdanauAttentionï¼ˆè°ƒç”¨__call__ï¼‰å°±æ˜¯æ ¹æ®æ­¤åˆ»çš„queryï¼ˆå³ $h_iâ€™$ï¼‰å’Œæ¯ä¸ªkeyæ ¹æ®å¼ $(1.4)(1.5)$ è®¡ç®—å¾—åˆ°æ¯ä¸ªkeyçš„æƒé‡ alignmentsã€‚ 2.4 LuongAttentionLuongAttentionåŒæ ·æ˜¯ç»§æ‰¿è‡ª2.2èŠ‚çš„_BaseAttentionMechanismï¼Œå®ƒçš„æ„é€ å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š123456789def __init__(self, num_units, memory, memory_sequence_length=None, scale=False, probability_fn=None, score_mask_value=None, dtype=None, name=\"LuongAttention\"): å‡ºç°äº†ä¸€ä¸ªæ–°å‚æ•°scaleï¼Œè¯¥å‚æ•°åœ¨è®¡ç®—åˆ†æ•°çš„å‡½æ•°_luong_scoreä¸­ä¼šç”¨åˆ°ï¼Œä»£è¡¨æ˜¯å¦å¯¹å¾—åˆ°çš„åˆ†æ•°è¿›è¡Œscaleæ“ä½œã€‚2.3èŠ‚ä¸­æåˆ°BahdanauAttentionæ„é€ å‡½æ•°ä¸­å‚æ•°num_unitsè®¾ç½®æˆä»»ä½•å€¼éƒ½å¯ä»¥ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸æ˜¯è¿™æ ·ï¼Œå› ä¸ºï¼š12345678super(LuongAttention, self).__init__( query_layer=None, memory_layer=layers_core.Dense(num_units, name=\"memory_layer\", use_bias=False, dtype=dtype), memory=memory, probability_fn=wrapped_probability_fn, memory_sequence_length=memory_sequence_length, score_mask_value=score_mask_value, name=name) æ³¨æ„è¿™é‡Œåªä¼ å…¥äº†memory_layerï¼ˆå¯¹åº”å¼$(1.6)$ä¸­çš„ $\\boldsymbol { W_a }$ï¼‰ï¼Œæ‰€ä»¥åªå¯¹memoryï¼ˆå³ å¼å­$(1.6)$ä¸­çš„ $h_j$ï¼‰è¿›è¡Œäº†å˜æ¢å¾—åˆ° $\\boldsymbol {W_a}h_j$ï¼Œå› æ­¤è¿™é‡Œnum_unitså¿…é¡»ç­‰äºqueryçš„æ·±åº¦ï¼ˆå³query.get_shape()[-1]ï¼‰ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå’ŒBahdanauAttentionç±»ä¼¼çš„ï¼ŒLuongAttentionï¼ˆè°ƒç”¨__call__ï¼‰å°±æ˜¯æ ¹æ®æ­¤åˆ»çš„queryï¼ˆå³ $h_iâ€™$ï¼‰å’Œæ¯ä¸ªkeyæ ¹æ®å¼ $(1.6)(1.4)$ è®¡ç®—å¾—åˆ°æ¯ä¸ªkeyçš„æƒé‡ alignmentsã€‚å’ŒBahdanauAttentionä¸åŒçš„æ˜¯è¿™é‡Œè¦åˆç†è®¾ç½®å‚æ•° num_unitså¦åˆ™queryå’Œkeyç»´åº¦ä¸åŒ¹é…ã€‚ 2.5 AttentionWrapperStateæ¥ä¸‹æ¥æˆ‘ä»¬å†çœ‹ä¸‹ AttentionWrapperState è¿™ä¸ªç±»ï¼Œè¿™ä¸ªç±»å…¶å®ç±»ä¼¼RNNCellæœ‰éšè—æ€ï¼ˆhidden stateï¼‰ï¼Œå°±æ˜¯å®šä¹‰äº†attentionè®¡ç®—è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦ä¿å­˜çš„å˜é‡ï¼Œå¦‚ cell_stateï¼ˆè¿™ä¸ªcell_stateå°±æ˜¯è¢«AttentionWrapperåŒ…è£¹çš„å†…éƒ¨RNNCellçš„éšè—æ€ï¼‰ã€attentionã€timeã€alignments ç­‰å†…å®¹ï¼ŒåŒæ—¶ä¹Ÿä¾¿äºåæœŸçš„å¯è§†åŒ–å‘ˆç°ï¼Œä»£ç å®ç°å¦‚ä¸‹ï¼š1234class AttentionWrapperState( collections.namedtuple(\"AttentionWrapperState\", (\"cell_state\", \"attention\", \"time\", \"alignments\", \"alignment_history\", \"attention_state\"))): å¯è§å®ƒå°±æ˜¯ç»§æ‰¿äº†namedtupleè¿™ä¸ªæ•°æ®ç»“æ„ï¼Œå…¶å®å¯ä»¥æŠŠè¿™ä¸ª AttentionWrapperStateçœ‹æˆä¸€ä¸ªç»“æ„ä½“ï¼Œå¯ä»¥ä¼ å…¥éœ€è¦çš„å­—æ®µç”Ÿæˆè¿™ä¸ªå¯¹è±¡ã€‚ 2.6 AttentionWrapperä¸ºäº†æ–¹ä¾¿ä½¿ç”¨äº†attentionï¼ŒTensorFlowæä¾›äº†ä¸€ä¸ªwrapperï¼Œè¿™å’Œå…¶ä»–çš„Wrapperä¾‹å¦‚DropoutWrapperã€ResidualWrapper ç­‰ç­‰ç±»ä¼¼ï¼Œå®ƒä»¬éƒ½æ˜¯ RNNCellçš„å®ä¾‹ã€‚å³AttentionWrapperå®ƒå¯¹RNNCellè¿›è¡Œäº†å°è£…ï¼Œå°è£…åä¾ç„¶è¿˜æ˜¯RNNCellçš„å®ä¾‹ã€‚å¦‚æœä½ æƒ³ç»™ä¸€ä¸ªæ™®é€šçš„RNNæ¨¡å‹åŠ å…¥attentionåŠŸèƒ½ï¼Œåªéœ€è¦åœ¨RNNCellå¤–é¢å¥—ä¸€å±‚AttentionWrapperå¹¶æŒ‡å®š AttentionMechanismçš„å®ä¾‹å°±å¥½äº†ã€‚ æˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹çœ‹å…¶æ„é€ å‡½æ•°ï¼š1234567891011class AttentionWrapper(rnn_cell_impl.RNNCell): def __init__(self, cell, attention_mechanism, attention_layer_size=None, alignment_history=False, cell_input_fn=None, output_attention=True, initial_cell_state=None, name=None, attention_layer=None): ä¸‹é¢å¯¹å…¶å‚æ•°ä¸€ä¸€è¯´æ˜ï¼š cell: è¢«åŒ…è£¹çš„RNNCellå®ä¾‹ï¼› attention_mechanism: attentionæœºåˆ¶å®ä¾‹ï¼Œä¾‹å¦‚BahdanauAttentionï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªattentionå®ä¾‹ç»„æˆçš„åˆ—è¡¨ï¼› attention_layer_size: æ˜¯æ•°å­—æˆ–è€…æ•°å­—åšæˆçš„åˆ—è¡¨ï¼Œå¦‚æœæ˜¯ Noneï¼ˆé»˜è®¤ï¼‰ï¼Œç›´æ¥ä½¿ç”¨åŠ æƒæ±‚å’Œå¾—åˆ°çš„ä¸Šä¸‹æ–‡å‘é‡ $c_i$ ä½œä¸ºè¾“å‡ºï¼ˆè¯¦è§æœ¬å°èŠ‚æœ€åçš„_compute_attentionä»£ç ï¼‰ï¼Œå¦‚æœä¸æ˜¯Noneï¼Œé‚£ä¹ˆå°† $c_i$ å’Œcellçš„è¾“å‡º cell_outputè¿›è¡Œconcatå¹¶åšçº¿æ€§å˜æ¢ï¼ˆè¾“å‡ºç»´åº¦ä¸ºattention_layer_sizeï¼‰å†è¾“å‡ºã€‚ è¿™é‡Œæ‰€è¯´çš„â€è¾“å‡ºâ€åœ¨ä»£ç é‡Œæ˜¯ç”¨â€attentionâ€è¡¨ç¤ºçš„ï¼Œè§æœ¬å°èŠ‚æœ€åçš„_compute_attentionå‡½æ•°ä»£ç ã€‚ alignment_history: å³æ˜¯å¦å°†ä¹‹å‰çš„alignmentså­˜å‚¨åˆ° state ä¸­ï¼Œä»¥ä¾¿äºåæœŸè¿›è¡Œå¯è§†åŒ–å±•ç¤ºï¼Œé»˜è®¤Falseï¼Œä¸€èˆ¬è®¾ç½®ä¸ºTrueã€‚ cell_input_fn: æ€æ ·å¤„ç†è¾“å…¥ã€‚é»˜è®¤ä¼šå°†ä¸Šä¸€æ­¥çš„å¾—åˆ°çš„è¾“å‡ºä¸çš„å®é™…è¾“å…¥è¿›è¡Œconcatæ“ä½œä½œä¸ºè¾“å…¥ã€‚ä»£ç ï¼š 12if cell_input_fn is None: cell_input_fn = (lambda inputs, attention: array_ops.concat([inputs, attention], -1)) output_attention: é»˜è®¤falseï¼Œå¦‚æœä¸ºtrueï¼Œåˆ™è¾“å‡ºä¸æ˜¯attentionçš„è®¡ç®—ç»“æœï¼Œè€Œæ˜¯cellå¾—åˆ°çš„cell_outputã€‚ initial_cell_state: åˆå§‹çŠ¶æ€ï¼Œé»˜è®¤å³å¯ã€‚ attention_layer: è¿™ä¸ªå‚æ•°å…¶å®æ˜¯å’Œattention_layer_sizeæ˜¯äº’æ–¥çš„ï¼Œå¦‚æœè®¾ç½®äº†attention_layer_sizeä¸ä¸ºNoneï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°å¿…é¡»ä¸ºNoneã€‚å› ä¸ºä»–ä¿©åŠŸèƒ½ç±»ä¼¼ï¼Œå®ƒä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªtf.layers.Layerçš„åˆ—è¡¨ï¼Œå®šä¹‰è¾“å‡ºè¦ç»è¿‡çš„å˜æ¢ã€‚è‹¥ä¸ºNoneï¼Œç›´æ¥ä½¿ç”¨åŠ æƒæ±‚å’Œå¾—åˆ°çš„ä¸Šä¸‹æ–‡å‘é‡ $c_i$ ä½œä¸ºè¾“å‡ºï¼Œå¦‚æœä¸æ˜¯Noneï¼Œé‚£ä¹ˆå°† $c_i$ å’Œcellçš„è¾“å‡º cell_outputè¿›è¡Œconcatå†ç»è¿‡attention_layeråè¾“å‡ºã€‚ æ„é€ å‡½æ•°ä¸­å…³äºattention_layerçš„ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627if attention_layer_size is not None: attention_layer_sizes = tuple(attention_layer_size if isinstance(attention_layer_size, (list, tuple)) else (attention_layer_size,)) self._attention_layers = tuple(layers_core.Dense( attention_layer_size, name=\"attention_layer\", use_bias=False, dtype=attention_mechanisms[i].dtype) for i, attention_layer_size in enumerate(attention_layer_sizes)) self._attention_layer_size = sum(attention_layer_sizes)elif attention_layer is not None: self._attention_layers = tuple( attention_layer if isinstance(attention_layer, (list, tuple)) else (attention_layer,)) self._attention_layer_size = sum( tensor_shape.dimension_value(layer.compute_output_shape( [None, cell.output_size + tensor_shape.dimension_value( mechanism.values.shape[-1])])[-1]) for layer, mechanism in zip( self._attention_layers, attention_mechanisms))else: self._attention_layers = None self._attention_layer_size = sum( tensor_shape.dimension_value(attention_mechanism.values.shape[-1]) for attention_mechanism in attention_mechanisms) å¯è§å‚æ•°attention_layer_sizeå’Œattention_layeréƒ½ä¼šå½±å“self._attention_layersçš„å€¼ï¼Œåªæœ‰åœ¨å®ƒä¿©éƒ½ä¸ºNoneï¼ˆé»˜è®¤ï¼‰æ—¶self._attention_layersæ‰ä¸ºNoneã€‚ æ¥ä¸‹æ¥çœ‹çœ‹å…¶callæ–¹æ³•ï¼Œå…¶è¾“å…¥è¾“å‡ºå’ŒRNNCellä¸­çš„callå…¶å®æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯é€šè¿‡ä¸Šä¸€æ­¥çš„inputså’Œstateè®¡ç®—å¾—åˆ°outputå’Œnext_stateã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748def call(self, inputs, state): # Step 1: æ ¹æ®è¾“å…¥å’Œä¸Šä¸€æ­¥çš„è¾“å‡ºè®¡ç®—çœŸæ­£çš„è¾“å…¥ cell_inputs = self._cell_input_fn(inputs, state.attention) # é»˜è®¤æ˜¯concatæ“ä½œ # Step 2: è°ƒç”¨å†…éƒ¨è¢«åŒ…è£¹çš„RNNCellå¾—åˆ°cell_outputå’Œnext_cell_state cell_state = state.cell_state cell_output, next_cell_state = self._cell(cell_inputs, cell_state) if self._is_multi: previous_attention_state = state.attention_state previous_alignment_history = state.alignment_history else: previous_attention_state = [state.attention_state] previous_alignment_history = [state.alignment_history] all_alignments = [] # ç”¨åˆ—è¡¨å­˜æ”¾ï¼Œå› ä¸ºattention_mechanismæ˜¯åˆ—è¡¨ all_attentions = [] all_attention_states = [] maybe_all_histories = [] # Step 3: æ ¹æ®attention_mechanismè®¡ç®—å¾—åˆ°attention, alignments for i, attention_mechanism in enumerate(self._attention_mechanisms): attention, alignments, next_attention_state = _compute_attention( attention_mechanism, cell_output, previous_attention_state[i], self._attention_layers[i] if self._attention_layers else None) alignment_history = previous_alignment_history[i].write( state.time, alignments) if self._alignment_history else () all_attention_states.append(next_attention_state) all_alignments.append(alignments) all_attentions.append(attention) maybe_all_histories.append(alignment_history) # Step 4: ç»„åˆæˆ AttentionWrapperState ä½œä¸ºä¸‹ä¸€æ­¥çš„çŠ¶æ€ attention = array_ops.concat(all_attentions, 1) next_state = AttentionWrapperState( time=state.time + 1, cell_state=next_cell_state, attention=attention, attention_state=self._item_or_tuple(all_attention_states), alignments=self._item_or_tuple(all_alignments), alignment_history=self._item_or_tuple(maybe_all_histories)) # Step 5: è¾“å‡º if self._output_attention: return attention, next_state else: return cell_output, next_state æ¥ä¸€æ­¥ä¸€æ­¥åœ°åˆ†æï¼š Step 1: è°ƒç”¨äº†_cell_input_fn()æ–¹æ³•ï¼Œå¯¹inputså’Œstate.attentionè¿›è¡Œå¤„ç†ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨concatå‡½æ•°æ‹¼æ¥ï¼Œä½œä¸ºå½“å‰æ—¶é—´æ­¥çš„è¾“å…¥ã€‚ Step 2: è°ƒç”¨å…¶å†…éƒ¨è¢«åŒ…è£¹çš„RNNCellçš„callæ–¹æ³•ï¼Œå¾—åˆ°cellçš„è¾“å‡ºå’Œä¸‹ä¸€çŠ¶æ€ã€‚ Step 3: è¿™ä¸€æ­¥å°±æ˜¯è°ƒç”¨_compute_attentionè¿›è¡Œè®¡ç®—æ“ä½œï¼Œå¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºï¼Œå…ˆè°ƒç”¨äº†attention_mechanismè¿›è¡Œå¯¹åº”ç±»å‹çš„æ³¨æ„åŠ›è®¡ç®—å¾—åˆ° $\\alpha_{ij}$ï¼Œç„¶åè¿›è¡ŒåŠ æƒæ±‚å’Œæ“ä½œå¾—åˆ°ä¸Šä¸‹æ–‡å‘é‡ $c_i$ï¼Œç„¶åå†é€šè¿‡attention_layerè¿›è¡Œå¯¹åº”çš„å˜æ¢æ“ä½œï¼Œæœ€åå†è¿”å›ã€‚ 12345678910111213141516def _compute_attention(attention_mechanism, cell_output, attention_state, attention_layer):\"\"\"Computes the attention and alignments for a given attention_mechanism.\"\"\"# è¿™é‡Œçš„(next_)attention_stateå…¶å®å°±æ˜¯alignments, è¯¦è§2.3èŠ‚ä¸­çš„callæ–¹æ³•alignments, next_attention_state = attention_mechanism(cell_output, state=attention_state)# Reshape from [batch_size, memory_time] to [batch_size, 1, memory_time]expanded_alignments = array_ops.expand_dims(alignments, 1)context = math_ops.matmul(expanded_alignments, attention_mechanism.values) # åŠ æƒæ±‚å’Œæ“ä½œ, å³å¼(1.3)context = array_ops.squeeze(context, [1])if attention_layer is not None: attention = attention_layer(array_ops.concat([cell_output, context], 1))else: attention = contextreturn attention, alignments, next_attention_state Step 4: æ ¹æ®å‰é¢çš„æ„å»ºæ–°çš„stateä½œä¸ºnext_stateã€‚ Step 5: è‹¥output_attentionä¸ºTrueï¼Œåˆ™è¾“å‡ºattentionå’Œnext_stateï¼Œå¦åˆ™è¾“å‡ºcell_outputå’Œnext_stateã€‚ ç»¼ä¸Šï¼ŒAttentionWrapperçš„callå‡½æ•°æ¥æ”¶inputå’Œstateç„¶åè¾“å‡ºoutputå’Œä¸‹ä¸€ä¸ªstateï¼Œè¿™å°±ç¬¦åˆRNNCellçš„è°ƒç”¨å‡½æ•°ï¼Œå³1output, next_state = RNNCell(input, state) æ‰€ä»¥å°±å¯ä»¥åƒä½¿ç”¨æ™®é€šRNNCellä¸€æ ·ä½¿ç”¨å¸¦æ³¨æ„åŠ›æœºåˆ¶çš„RNNCelläº†ã€‚ 2.7 å›¾è§£ å›¾2.1 AttentionWrapperå·¥ä½œæµç¨‹ å‚è€ƒæ–‡çŒ®[1] Cho K, Van MerriÃ«nboer B, Gulcehre C, et al. Learning phrase representations using RNN encoder-decoder for statistical machine translation[J]. arXiv preprint arXiv:1406.1078, 2014. [2] Sutskever I, Vinyals O, Le Q V. Sequence to sequence learning with neural networks[C]//Advances in neural information processing systems. 2014: 3104-3112. [3] Bahdanau D, Cho K, Bengio Y. Neural machine translation by jointly learning to align and translate[J]. arXiv preprint arXiv:1409.0473, 2014. [4] Luong M T, Pham H, Manning C D. Effective approaches to attention-based neural machine translation[J]. arXiv preprint arXiv:1508.04025, 2015. [5] Salimans T, Kingma D P. Weight normalization: A simple reparameterization to accelerate training of deep neural networks[C]//Advances in Neural Information Processing Systems. 2016: 901-909.","categories":[{"name":"Deep Learning","slug":"Deep-Learning","permalink":"https://tangshusen.me/categories/Deep-Learning/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"https://tangshusen.me/tags/tensorflow/"},{"name":"attention","slug":"attention","permalink":"https://tangshusen.me/tags/attention/"},{"name":"seq2seq","slug":"seq2seq","permalink":"https://tangshusen.me/tags/seq2seq/"}]},{"title":"ç»Ÿè®¡å­¦ä¹ ç†è®ºä¹‹VCç»´ç©¶ç«Ÿæ˜¯ä»€ä¹ˆ","slug":"vc-dimension","date":"2018-12-09T04:23:52.000Z","updated":"2018-12-30T09:16:22.473Z","comments":true,"path":"2018/12/09/vc-dimension/","link":"","permalink":"https://tangshusen.me/2018/12/09/vc-dimension/","excerpt":"å­¦ä¹ æœºå™¨å­¦ä¹ ä¸å¯é¿å…çš„ä¼šæ¥è§¦åˆ°VCç»´ï¼Œå®ƒåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸæ˜¯ä¸€ä¸ªå¾ˆåŸºç¡€ä½†å¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒç»™æœºå™¨å­¦ä¹ æä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ã€‚ä½†ç›´åˆ°åœ¨æˆ‘å†™è¿™ç¯‡åšå®¢ä¹‹å‰ï¼Œæˆ‘å¯¹VCçš„ç†è§£è¿˜åªåœç•™åœ¨å®ƒèƒ½åˆ»ç”»å‡è®¾ç©ºé—´çš„å¤æ‚åº¦è¿™æ ·æµ…æ˜¾çš„å±‚æ¬¡ã€‚æœ¬æ–‡å°±æ¥ç†ä¸€ç†VCç»´(Vapnikâ€“Chervonenkis dimension)çš„æ¥é¾™å»è„‰ï¼Œææ¸…æ¥šå…¶æœ¬è´¨ã€‚","text":"å­¦ä¹ æœºå™¨å­¦ä¹ ä¸å¯é¿å…çš„ä¼šæ¥è§¦åˆ°VCç»´ï¼Œå®ƒåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸæ˜¯ä¸€ä¸ªå¾ˆåŸºç¡€ä½†å¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒç»™æœºå™¨å­¦ä¹ æä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ã€‚ä½†ç›´åˆ°åœ¨æˆ‘å†™è¿™ç¯‡åšå®¢ä¹‹å‰ï¼Œæˆ‘å¯¹VCçš„ç†è§£è¿˜åªåœç•™åœ¨å®ƒèƒ½åˆ»ç”»å‡è®¾ç©ºé—´çš„å¤æ‚åº¦è¿™æ ·æµ…æ˜¾çš„å±‚æ¬¡ã€‚æœ¬æ–‡å°±æ¥ç†ä¸€ç†VCç»´(Vapnikâ€“Chervonenkis dimension)çš„æ¥é¾™å»è„‰ï¼Œææ¸…æ¥šå…¶æœ¬è´¨ã€‚ 1. å¯å­¦ä¹ çš„æ¡ä»¶æ—¢ç„¶è¯´VCç»´ç»™æœºå™¨å­¦ä¹ æä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ï¼Œé‚£ä¹ˆå°±æœ‰å¿…è¦æ¥çœ‹çœ‹æœºå™¨å­¦ä¹ ç®—æ³•å¯å­¦ä¹ çš„æ¡ä»¶æ˜¯ä»€ä¹ˆã€‚ 1.1 å­¦ä¹ çš„è¿‡ç¨‹ä¸€ä¸ªåŸºæœ¬çš„æœºå™¨å­¦ä¹ è¿‡ç¨‹å¦‚å›¾1.1æ‰€ç¤º(æœ¬æ–‡å›¾ç‰‡è‹¥æ— ç‰¹åˆ«è¯´æ˜å³æ¥è‡ªäºå°å¤§æœºå™¨å­¦ä¹ åŸºçŸ³è¯¾ç¨‹è¯¾ä»¶ï¼ŒCourseraè¯¾ç¨‹åœ°å€)ã€‚è§£é‡Šä¸€ä¸‹ä¸‹å›¾ä¸­çš„ä¸€äº›æ¦‚å¿µï¼š$\\mathcal{A}$ è¡¨ç¤ºå­¦ä¹ ç®—æ³•ï¼Œ$f$ è¡¨ç¤ºå­¦ä¹ çš„ç›®æ ‡å‡è®¾(å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ†å¸ƒ)ï¼Œ$\\mathcal{H}$ è¡¨ç¤ºå‡è®¾ç©ºé—´ï¼Œ$g$ è¡¨ç¤ºæˆ‘ä»¬æ±‚è§£çš„ç”¨æ¥é¢„æµ‹çš„å‡è®¾ï¼Œ$g$ æ˜¯å±äº $\\mathcal{H}$ çš„ã€‚æœºå™¨å­¦ä¹ çš„è¿‡ç¨‹å°±æ˜¯ï¼šé€šè¿‡ç®—æ³• $\\mathcal{A}$ï¼Œåœ¨å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­ï¼Œæ ¹æ®è®­ç»ƒæ ·æœ¬é›† $\\mathcal{D}$ï¼Œé€‰æ‹©æœ€å¥½çš„å‡è®¾ä½œä¸º $g$ ä½¿ $g$ è¿‘ä¼¼äº $f$ã€‚ å›¾1.1 å›¾1.1ä¸­çš„ $E_{out}(g)$ å’Œ $E_{in}(g)$ æ˜¯ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š $E_{out}(g)$ï¼Œå­¦åˆ°çš„å‡è®¾ $g$ åœ¨é™¤äº†è®­ç»ƒæ ·æœ¬å¤–çš„å…¶ä»–æ‰€æœ‰æ ·æœ¬(out-of-sample)ä¸Šçš„æŸå¤±ï¼Œç§°ä¸ºæœŸæœ›è¯¯å·®ï¼Œä¹Ÿç§°æ³›åŒ–è¯¯å·®ã€‚ $E_{in}(g)$ï¼Œå­¦åˆ°çš„å‡è®¾ $g$ åœ¨è®­ç»ƒæ ·æœ¬(in-of-sample)ä¸Šçš„æŸå¤±ï¼Œç§°ä¸ºç»éªŒè¯¯å·®ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€‰æ‹©æœ€å¥½çš„å‡è®¾ä½œä¸º $g$ ä½¿ $g$ è¿‘ä¼¼äº $f$ï¼Œè€Œ $E_{out}(f) = 0$ï¼Œä¹Ÿå³æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿ $E_{out}(g) \\approx 0$ã€‚ä½†æˆ‘ä»¬æ˜¯æ²¡æ³•è·å¾—è®­ç»ƒæ ·æœ¬å¤–çš„å…¶ä»–æ‰€æœ‰æ ·æœ¬çš„ï¼Œé‚£ä¹Ÿå°±æ²¡æ³•è®¡ç®— $E_{out}(g)$ äº†ï¼Œè¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ 1.2 Hoeffdingä¸ç­‰å¼åœ¨å›ç­”1.1æœ€åçš„é—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹Hoeffdingä¸ç­‰å¼ã€‚æ¥çœ‹å›¾1.2æ‰€è¿°çš„é—®é¢˜: è®¾ç“¶å­é‡Œçš„æ©™è‰²çƒå æ¯”ä¸º $\\mu$ï¼Œä»ç“¶å­ä¸­éšæœºæŠ½å–å‡ºNä¸ªæ ·æœ¬ï¼Œè¿™Nä¸ªæ ·æœ¬ä¸­æ©™è‰²çƒå æ¯”æ˜¯ $\\nu$ã€‚æˆ‘ä»¬å¯ä»¥å°† $\\mu$ çœ‹ä½œ1.1èŠ‚ä¸­çš„$E_{out}(g)$ï¼Œå°† $\\nu$ çœ‹ä½œæ˜¯ $E_{in}(g)$ï¼Œæˆ‘ä»¬ç°åœ¨å¹¶ä¸çŸ¥é“ $\\mu$ å’Œ $E_{out}(g)$ï¼ŒåªçŸ¥é“ $\\nu$ å’Œ $E_{in}(g)$ï¼Œæˆ‘ä»¬å¯ä»¥ä» $\\nu$ æ¨æ–­å‡ºå…³äº $\\mu$ çš„ä»€ä¹ˆå—ï¼Ÿ å¯ä»¥å°† $\\nu$ çœ‹ä½œæ˜¯æ ·æœ¬æœŸæœ›ï¼Œ$\\mu$ åˆ™æ˜¯æ€»ä½“æœŸæœ›ã€‚ å›¾1.2 ç›´è§‰ä¸Šï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ›´å¤šçš„æ ·æœ¬(æŠ½å‡ºå¾ˆå¤šçš„çƒ)ï¼Œåˆ™ $\\nu$ åº”è¯¥è¶Šæ¥è¶Šæ¥è¿‘æ€»ä½“æœŸæœ› $\\mu$ã€‚äº‹å®ä¸Šï¼Œè¿™é‡Œå¯ä»¥ç”¨hoeffdingä¸ç­‰å¼è¡¨ç¤ºå¦‚ä¸‹ï¼š$$\\mathbb{P}[|\\nu - \\mu| &gt; \\epsilon] \\leq 2 \\exp \\left(-2 \\epsilon^2 N \\right) \\tag{1.2.1}$$ ä»hoeffdingä¸ç­‰å¼å¯ä»¥çœ‹å‡ºï¼Œå½“Nè¶Šæ¥è¶Šå¤§æ—¶ï¼Œ$\\nu$ å’Œ $\\mu$ ä¹‹å·®å¤§äº $\\epsilon$ çš„æ¦‚ç‡çš„ä¸Šç•Œè¶Šæ¥è¶Šæ¥è¿‘0ï¼Œæ‰€ä»¥æ ·æœ¬æœŸæœ› $\\nu$ è¶Šæ¥è¶Šæ¥è¿‘æ€»ä½“æœŸæœ› $\\mu$ï¼Œå³ $\\nu$ å’Œ $\\mu$ æ¦‚ç‡è¿‘ä¼¼ç›¸ç­‰(probably approximately correct, PAC)äº†ã€‚ 1.3 å¯å­¦ä¹ çš„æ¡ä»¶æœ‰äº†1.2èŠ‚çš„é“ºå«ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥å›ç­”1.1èŠ‚çš„é—®é¢˜äº†ã€‚ å¯¹äºä»»æ„å›ºå®šçš„å‡è®¾ $h$ï¼Œå½“è®­ç»ƒæ ·æœ¬é‡Nè¶³å¤Ÿå¤§ï¼Œç±»æ¯”äº1.2èŠ‚çš„ä¾‹å­ï¼Œå¯ä»¥é€šè¿‡æ ·æœ¬é›†ä¸Šçš„ç»éªŒè¯¯å·® $E_{in}(h)$ æ¨æµ‹æ€»ä½“çš„æœŸæœ›è¯¯å·® $E_{out}(h)$ã€‚åŸºäºhoeffdingä¸ç­‰å¼ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸‹é¢å¼å­ï¼š$$\\mathbb{P}[|E_{in}(h) - E_{out}(h)| &gt; \\epsilon] \\leq 2 \\exp(-2 \\epsilon^2 N) \\tag{1.3.1}$$ æ ¹æ®ä¸Šé¢ä¸ç­‰å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­ï¼Œå½“Nè¶³å¤Ÿå¤§æ—¶ï¼Œ$E_{in}(h)$ å’Œ $E_{out}(h)$ å°†éå¸¸æ¥è¿‘ã€‚ æ³¨æ„åœ¨ä¸Šé¢æ¨å¯¼ä¸­ï¼Œæˆ‘ä»¬æ˜¯é’ˆå¯¹æŸä¸€ä¸ªç‰¹å®šçš„å‡è®¾ $h$ã€‚åœ¨æˆ‘ä»¬çš„å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­ï¼Œå¾€å¾€æœ‰å¾ˆå¤šä¸ªå‡è®¾(ç”šè‡³äºæ— ç©·å¤šä¸ª)ã€‚é‚£ä¹ˆå¯¹äºå‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­çš„ä»»æ„çš„å‡è®¾ $h$ï¼Œ$E_{in}(h)$ å’Œ $E_{out}(h)$ ä¹‹å·®å¤§äº $\\epsilon$ çš„æ¦‚ç‡çš„ä¸Šç•Œä¼šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å‘ç”Ÿæ¦‚ç‡å¾ˆå°çš„äº‹ä»¶åœ¨å¾ˆå¤šæ¬¡å®éªŒä¸­å‘ç”Ÿæ¦‚ç‡å°±ä¼šå˜å¾—å¾ˆå¤§ã€‚ä¾‹å¦‚è¿ç»­ä¸¢5æ¬¡ç¡¬å¸ï¼Œäº‹ä»¶â€äº”æ¬¡éƒ½æ˜¯æ­£é¢æœä¸Šâ€çš„æ¦‚ç‡æ˜¯ $\\frac 1 {32}$ã€‚ä½†æ˜¯å¦‚æœ100ä¸ªäººåšè¿™ä¸ªå®éªŒï¼Œäº‹ä»¶â€äº”æ¬¡éƒ½æ˜¯æ­£é¢æœä¸Šâ€çš„å‘ç”Ÿçš„æ¦‚ç‡å°±æ˜¯ $1 - ({\\frac {31} {32}})^{100} &gt; 0.95$ã€‚æ‰€ä»¥å¯¹äºç‰¹å®šçš„å‡è®¾ $h$ï¼Œ$E_{in}(h)$ å’Œ $E_{out}(h)$ å¾ˆæ¥è¿‘ï¼Œä½†æ˜¯å¯¹äº $\\mathcal{H}$ ä¸­ä»»æ„çš„å‡è®¾è¿™å°±ä¸ä¸€å®šäº†ã€‚ è¿™é‡Œå‡å®š $\\mathcal{H}$ ä¸­æœ‰ $M$ ä¸ªå‡è®¾ $h_1,h_2,â€¦h_M$ï¼Œåˆ™æœ‰å¦‚ä¸‹æ¨å¯¼:$$\\mathbb{P}[\\mathbf{E}(h_1)&gt; \\epsilon \\cup \\mathbf{E}(h_2)&gt; \\epsilon \\space â€¦ \\cup \\mathbf{E}(h_M)&gt; \\epsilon] \\\\\\leq \\mathbb{P}[\\mathbf{E}(h_1)&gt; \\epsilon] + \\mathbb{P}[\\mathbf{E}(h_2)&gt; \\epsilon] \\space â€¦ + \\mathbb{P}[\\mathbf{E}(h_M)&gt; \\epsilon] \\\\\\leq 2M\\exp(-2 \\epsilon^2 N) \\tag{1.3.2}$$å…¶ä¸­ $\\mathbf{E}(h_i) = |E_{in}(h_i) - E_{out}(h_i)|$ã€‚ æ ¹æ®å¼ $(1.3.2)$ çŸ¥$$\\forall g \\in \\mathcal{H}, \\mathbb{P}[|E_{in}(g) - E_{out}(g)| &gt; \\epsilon] \\leq 2M \\exp(-2 \\epsilon^2 N) \\tag{1.3.3}$$ ä¸Šé¢å¼å­çš„å«ä¹‰å°±æ˜¯ï¼šåœ¨å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªå‡è®¾ $g$ï¼Œ$E_{in}(g)$ å’Œ $E_{out}(g)$ ä¹‹å·®å¤§äº $\\epsilon$ çš„æ¦‚ç‡çš„ä¸Šç•Œæ˜¯ $2M \\exp(âˆ’2 \\epsilon^2 N)$ã€‚æ³¨æ„è¿™ä¸ªä¸Šç•Œä¸è®­ç»ƒæ ·æœ¬æ•° $N$ å’Œå‡è®¾ç©ºé—´å‡è®¾æ•° $M$ å¯†åˆ‡ç›¸å…³ã€‚ æœ¬æ–‡çš„æ‰€æœ‰è®¨è®ºéƒ½æ˜¯å›´ç»•å¼(1.3.3)è¿›è¡Œçš„!!! æ‰€ä»¥ï¼Œæ ¹æ®å¼ $(1.3.3)$ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†å¯å­¦ä¹ çš„ä¸¤ä¸ªæ ¸å¿ƒæ¡ä»¶æ˜¯: å­¦ä¹ ç®—æ³• $\\mathcal{A}$ èƒ½å¤Ÿä» $\\mathcal{H}$ é€‰å‡ºçš„å‡è®¾ $g$ æ»¡è¶³ $E_{in}(g) \\approx 0$ã€‚å†ç»“åˆæ¡ä»¶2å³è¾¾åˆ°äº† $E_{out}(g) \\approx 0$ çš„ç›®æ ‡ã€‚ å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­å‡è®¾æ•° $M$ æ˜¯æœ‰é™çš„ä¸”è®­ç»ƒæ ·æœ¬æ•° $N$ è¶³å¤Ÿå¤§ã€‚æ­¤æ—¶å¯ä¿è¯å¼(1.3.3)å³è¾¹ä¸Šç•Œè¶‹äº0ï¼Œå³å­¦ä¹ ç®—æ³• $\\mathcal{A}$ ä» $\\mathcal{H}$ é€‰å‡ºçš„ä»»æ„å‡è®¾ $g$ éƒ½æ»¡è¶³ $E_{in}(g) \\approx E_{out}(g)$ã€‚ ä¸Šé¢è¿™ä¸¤ä¸ªæ ¸å¿ƒæ¡ä»¶ï¼Œä¹Ÿæ­£å¥½å¯¹åº”ç€trainå’Œtestè¿™ä¸¤ä¸ªè¿‡ç¨‹: trainè¿‡ç¨‹å¸Œæœ›ç»éªŒè¯¯å·®$E_{in}(g)$ å°½å¯èƒ½å°ï¼› testè¿‡ç¨‹å¸Œæœ›åœ¨çœŸå®ç¯å¢ƒä¸­çš„æœŸæœ›è¯¯å·®$E_{out}(g)$ä¹Ÿå°½å¯èƒ½å°ï¼Œå³$E_{out}(g)$æ¥è¿‘äº$E_{in}(g)$ã€‚ æ‰€ä»¥æˆ‘ä»¬ä¸åº”è¯¥åªå…³å¿ƒå¦‚ä½•åˆ©ç”¨å­¦ä¹ ç®—æ³•æ‰¾åˆ°ä½¿ $E_{in}(g)$ å¾ˆå°çš„ $g$ã€‚å› ä¸ºå¦‚æœæƒ³è®©å­¦ä¹ å¯è¡Œï¼Œä¹Ÿè¦ä¿è¯$E_{out}(g)$æ¥è¿‘äº$E_{in}(g)$ã€‚ æ¥åˆ†æä¸€ä¸‹ $M$ çš„å¤§å°å¯¹äºä¸¤ä¸ªæ¡ä»¶çš„æ»¡è¶³æƒ…å†µï¼š å½“ $M$ è¾ƒå°æ—¶ï¼Œç”±å¼$(1.3.3)$çŸ¥æ¡ä»¶2å¾ˆå®¹æ˜“æ»¡è¶³ï¼Œä½†æ˜¯ç”±äºå¯é€‰çš„ $g$ çš„æ•°ç›® $M$ è¾ƒå°ï¼Œæ‰€ä»¥æ¡ä»¶1ä¸å®¹æ˜“æ»¡è¶³ï¼› å½“ $M$ è¾ƒå¤§æ—¶ï¼Œç”±äºå¯é€‰çš„ $g$ çš„æ•°ç›® $M$ è¾ƒå¤§ï¼Œæ‰€ä»¥æ¡ä»¶1å¾ˆå®¹æ˜“æ»¡è¶³ï¼Œä½†æ˜¯æ¡ä»¶2ä¸å®¹æ˜“æ»¡è¶³ã€‚ ç”±æ­¤å¯è§ï¼Œå‡è®¾æ•° $M$ åœ¨è¿™ä¸¤ä¸ªæ ¸å¿ƒæ¡ä»¶ä¸­æœ‰ç€é‡è¦ä½œç”¨ï¼Œåº”è¯¥åˆç†é€‰å–ã€‚ä½†æ˜¯å¾€å¾€ä¸€ä¸ªå‡è®¾ç©ºé—´(å¦‚äºŒç»´å¹³é¢çš„æ‰€æœ‰ç›´çº¿)çš„å‡è®¾æ•°æ˜¯å¾ˆå¤§çš„ç”šè‡³æ˜¯æ— ç©·çš„ï¼Œæ­¤æ—¶å¼$(1.3.3)$ä¸­çš„ä¸Šç•Œå°±æˆäº†æ— ç©·å¤§æ²¡æœ‰ä»»ä½•çº¦æŸæ„ä¹‰ï¼Œä¹Ÿå³ä¸æ»¡è¶³æ¡ä»¶2ï¼Œå­¦ä¹ å˜å¾—ä¸å¯è¡Œï¼Œè¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ 2. VCç»´2.1 æœ‰æ•ˆå‡è®¾æ•°åœ¨å¼$(1.3.2)$çš„æ¨å¯¼ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†è¿™æ ·ä¸€ä¸ªæ¦‚ç‡ä¸ç­‰å¼:$$\\mathbb{P}(A_1 \\cup A_2 \\space â€¦ \\cup A_M) \\leq \\sum_{i=1}^M\\mathbb{P}(A_i) \\tag{2.1.1}$$æˆ‘ä»¬çŸ¥é“ï¼Œå½“ $A_i$ ç›¸äº’ç‹¬ç«‹æ—¶ä¸Šå¼å–ç­‰å·ã€‚ä½†äº‹å®ä¸Šï¼Œå‡è®¾ç©ºé—´é‡Œçš„ $h_i$ ä¹‹é—´å¹¶ä¸æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œå®ƒä»¬æ˜¯æœ‰å¾ˆå¤§çš„é‡å çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨ $M$ ä¸ªå‡è®¾ä¸­ï¼Œæœ‰å¾ˆå¤šå‡è®¾éƒ½å¯ä»¥å½’ä¸ºåŒä¸€ç±»ã€‚ ä¸‹é¢ç”¨äºŒç»´å‡è®¾ç©ºé—´ä¸ºä¾‹è§£é‡Šä¸€ä¸‹ä¸Šè¿°é‡å æ€§ã€‚æˆ‘ä»¬çŸ¥é“äºŒç»´å‡è®¾ç©ºé—´çš„æ‰€æœ‰å‡è®¾æ•°(å³ç›´çº¿æ¡æ•°)ä¸º $\\infty$ï¼Œä½†æ˜¯å¦‚å›¾2.1æ‰€ç¤ºï¼Œå¯ä»¥å°†è¿™äº›å‡è®¾åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯æŠŠx1åˆ¤æ–­ä¸ºæ­£ä¾‹ï¼Œå¦ä¸€ç±»æ˜¯æŠŠx1åˆ¤æ–­ä¸ºè´Ÿä¾‹ã€‚ å›¾2.1 é‚£å¦‚æœåœ¨å¹³é¢ä¸Šæœ‰ä¸¤ä¸ªä¸åŒçš„æ•°æ®ç‚¹x1,x2ï¼Œè¿™æ ·çš„è¯ï¼Œå‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­çš„æ— æ•°æ¡ç›´çº¿å¯ä»¥åˆ†ä¸º4ç±»ã€‚é‚£ä¾æ¬¡ç±»æ¨ï¼Œ3ä¸ªæ•°æ®ç‚¹æƒ…å†µä¸‹ï¼Œ$\\mathcal{H}$ ä¸­æœ€å¤šæœ‰8ç±»(å½“ä¸‰ä¸ªç‚¹åœ¨åŒä¸€ç›´çº¿ä¸Šæ—¶åªæœ‰6ç±»)ã€‚4ä¸ªæ•°æ®ç‚¹æ—¶ï¼Œ$\\mathcal{H}$ ä¸­æœ€å¤šæœ‰14ç±»(æ³¨æ„ä¸æ˜¯16ç±»)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾2.2 ä»ä¸Šé¢çš„åˆ†æå¯çŸ¥ï¼Œè™½ç„¶å‡è®¾ç©ºé—´å‡è®¾æ•° $M$ ä¸€èˆ¬éå¸¸å¤§(ç”šè‡³æ— ç©·)ï¼Œä½†åœ¨ç‰¹å®šçš„æ ·æœ¬é›†ä¸Šï¼Œæœ‰æ•ˆçš„å‡è®¾æ•°ç›®æ˜¯æœ‰é™çš„ï¼Œä¹Ÿå³å¼$(1.3.3)$ä¸­çš„ $M$ æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥å¯ä»¥é‡å†™å¼$(1.3.3)$å¦‚ä¸‹:$$\\forall g \\in \\mathcal{H}, \\mathbb{P}[|E_{in}(g) - E_{out}(g)| &gt; \\epsilon] \\leq 2\\cdot \\text{effective}(M) \\exp(-2 \\epsilon^2 N) \\tag{2.1.2}$$ 2.2 å¯¹åˆ†å’Œå¢é•¿å‡½æ•°ä¸ºäº†æ¢ç©¶å¼$(2.1.2)$ä¸­çš„ $\\text{effective}(M)$ ï¼Œå…ˆå¼•å…¥å¯¹åˆ†(dichotomy) çš„æ¦‚å¿µ: å¯¹äºå‡è®¾ç©ºé—´ $\\mathcal{H} = \\lbrace h: \\mathcal{X} \\to \\lbrace+1,-1\\rbrace \\rbrace$ï¼Œæˆ‘ä»¬ç§°$$h(X_1, X_2,â€¦,X_N) = (h(X_1), h(X_2),â€¦,h(X_n)) \\in \\lbrace+1,-1 \\rbrace ^N$$ä¸ºä¸€ä¸ªå¯¹åˆ†ï¼Œå³ä¸€ä¸ªå¯¹åˆ†è¡¨ç¤ºæ ·æœ¬çš„ä¸€ç§æ ‡è®°ç»“æœï¼Œ$\\mathcal{H}(X_1, X_2,â€¦,X_N)$ è¡¨ç¤ºå‡è®¾ç©ºé—´ $\\mathcal{H}$ åœ¨è®­ç»ƒé›† $\\mathcal{D}$ ä¸Šçš„æ‰€æœ‰å¯¹åˆ†ã€‚ ä¾‹å¦‚ï¼Œè‹¥ $N = 4$ä¸”æ•°æ®ä¸ºäºŒç»´æ—¶ï¼Œå‚è§å›¾2.2ï¼Œæœ‰å¦‚ä¸‹è¡¨æ ¼: å‡è®¾ç©ºé—´ $\\mathcal{H}$ $\\mathcal{H}(X_1, X_2,X_3,X_4)$ æ‰€æœ‰å…ƒç´  å¹³é¢ä¸Šçš„æ‰€æœ‰ç›´çº¿ {+1,+1,+1,+1}, {+1,+1,+1,-1}â€¦ å…ƒç´ ä¸ªæ•° $\\infty$ æœ€å¤§ä¸º14 (ä¸ä¼šè¶…è¿‡ $2^N$) æˆ‘ä»¬çŸ¥é“ï¼Œ $\\mathcal{H}(X_1, X_2,â€¦,X_N)$ çš„å…ƒç´ ä¸ªæ•°(å³ $|\\mathcal{H}(X_1, X_2,â€¦,X_N)|$ )æ˜¯å–å†³äºå…·ä½“çš„æ•°æ®é›† $\\mathcal{D}$ çš„ï¼Œä¾‹å¦‚å½“ $N=3$ æ—¶ä¸”ä¸‰ä¸ªç‚¹ä¸åœ¨ä¸€æ¡ç›´çº¿æ—¶å¯¹åˆ†æ•°ä¸º8ï¼Œè€Œåœ¨ä¸€æ¡ç›´çº¿æ—¶å¯¹åˆ†æ•°æ˜¯6ã€‚ä¸ºäº†å»æ‰å¯¹å…·ä½“ $\\mathcal{D}$ çš„ä¾èµ–æ€§ï¼Œæˆ‘ä»¬å¼•å…¥ å¢é•¿å‡½æ•°(growth function): å‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„å¢é•¿å‡½æ•° $m_{\\mathcal{H}}(N)$ ä¸º$$m_{\\mathcal{H}}(N) = \\underset{X_1,X2,â€¦,X_N \\in \\mathcal{X}}{max} |\\mathcal{H}(X_1, X_2,â€¦,X_N)|$$å¢é•¿å‡½æ•° $m_{\\mathcal{H}}(N)$ è¡¨ç¤ºå‡è®¾ç©ºé—´ $\\mathcal{H}$ å¯¹ä¸ªä»»æ„ $N$ ä¸ªæ ·æœ¬æ‰€èƒ½èµ‹äºˆæ ‡è®°çš„çš„æœ€å¤§å¯èƒ½ç»“æœæ•°ï¼Œå…¶ä¸Šç•Œä¸º $2^N$ ã€‚ æ˜¾ç„¶ï¼Œ$m_{\\mathcal{H}}(N)$ è¶Šå¤§ï¼Œ$\\mathcal{H}$ çš„è¡¨ç¤ºèƒ½åŠ›è¶Šå¼ºã€‚å› æ­¤ï¼Œå¢é•¿å‡½æ•°æè¿°äº†å‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„è¡¨ç¤ºèƒ½åŠ›ï¼Œç”±æ­¤åæ˜ å‡ºå‡è®¾ç©ºé—´çš„å¤æ‚åº¦ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£æˆ‘ä»¬å¯ä¸å¯ä»¥ç”¨ $m_{\\mathcal{H}}(N)$ ç›´æ¥æ›¿æ¢æ‰å¼$(2.1.2)$ ä¸­çš„ $\\text{effective}(M)$ å‘¢ï¼Œå³$$\\forall g \\in \\mathcal{H}, \\mathbb{P}[|E_{in}(g) - E_{out}(g)| &gt; \\epsilon] \\overset{?}{\\leq} 2 m_{\\mathcal{H}}(N) \\exp(-2 \\epsilon^2 N) \\tag{2.2.1}$$æˆ‘ä»¬å°†åœ¨åœ¨2.3èŠ‚å›ç­”è¿™ä¸ªé—®é¢˜ã€‚ 2.3 VCç•Œ2.3.1 æ‰“æ•£(shatter)åœ¨ä»‹ç»VCç»´ç•Œ(VC bound)ä¹‹å‰ï¼Œå…ˆå¼•å…¥æ‰“æ•£(shatter)çš„æ¦‚å¿µ, å½“å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä½œç”¨äºå¤§å°ä¸º $N$ çš„æ ·æœ¬é›† $\\mathcal{D}$ æ—¶ï¼Œäº§ç”Ÿçš„å¯¹åˆ†æ•°é‡ç­‰äº $2^N$ å³ $m_{\\mathcal{H}}(N)=2^N$ æ—¶ï¼Œå°±ç§° $\\mathcal{D}$ è¢« $\\mathcal{H}$ æ‰“æ•£äº†ã€‚ shatterçš„åŸæ„æ˜¯æ‰“ç¢ï¼Œåœ¨æ­¤æŒ‡ $N$ ä¸ªç‚¹çš„æ‰€æœ‰(ç¢ç‰‡èˆ¬çš„)å¯èƒ½æƒ…å½¢éƒ½è¢« $\\mathcal{H}$ äº§ç”Ÿäº†ã€‚ å›¾2.3 å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒäºŒç»´ç©ºé—´ä¸Šçš„çš„ä¸‰ä¸ªç‚¹(ä¸åœ¨ä¸€æ¡ç›´çº¿ä¸Š)å¯ä»¥è¢«å¹³é¢ä¸Šæ‰€æœ‰ç›´çº¿è¿™ä¸ªå‡è®¾ç©ºé—´æ‰“ç¢,æ­¤æ—¶ $m_{\\mathcal{H}}(3)= 8 = 2^3$ã€‚ä½†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å››ä¸ªç‚¹å°±ä¸èƒ½è¢«è¿™ä¸ªå‡è®¾ç©ºé—´æ‰“ç¢äº†ï¼Œå¯çŸ¥æ­¤æ—¶ $m_{\\mathcal{H}}(4)=14 \\neq 2^4$ã€‚ å›¾2.4 2.3.2 break pointå°½ç®¡å¢é•¿å‡½æ•°æŠŠå‡è®¾æ•°ä»æ— ç©·ç¼©å°åˆ° $2^N$ï¼Œä½†æ˜¯è¿™ä¸ªé‡çº§è¿˜æ˜¯å¤ªå¤§äº†ï¼Œå¾ˆéš¾ä¿è¯å¼$(1.3.3)$å³è¾¹è¿™ä¸ªä¸Šç•Œè¶‹äº0ï¼Œæ‰€ä»¥èƒ½ä¸èƒ½æŠŠé‡çº§å†ç¼©å°ä¸€ç‚¹? ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå…ˆç»™å‡ºbreak pointçš„å®šä¹‰: å¯¹äºå‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„å¢é•¿å‡½æ•° $m_{\\mathcal{H}}(N)$ ï¼Œä» $N=1$ å‡ºå‘é€æ¸å¢å¤§ï¼Œå½“å¢å¤§åˆ° $k$ æ—¶ï¼Œå‡ºç° $m_{\\mathcal{H}}(N) &lt; 2^N$ çš„æƒ…å½¢ï¼Œåˆ™æˆ‘ä»¬è¯´ $k$ æ˜¯è¯¥å‡è®¾ç©ºé—´çš„break pointã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºä»»ä½•å¤§å°ä¸º $N(N \\ge k)$ çš„æ•°æ®é›†ï¼Œ $\\mathcal{H}$ éƒ½æ²¡æœ‰åŠæ³•æ‰“ç¢å®ƒã€‚ ä¸¾ä¾‹æ¥è®²ï¼Œç”±2.3.1èŠ‚çŸ¥ï¼Œå½“å‡è®¾ç©ºé—´ $\\mathcal{H}$ å®šä¹‰ä¸ºå¹³é¢ä¸Šæ‰€æœ‰ç›´çº¿æ—¶ï¼Œå…¶break pointå°±ä¸º4ã€‚ æœ‰äº†break pointçš„æ¦‚å¿µï¼Œå†ç»è¿‡ä¸€ç³»åˆ—å½’çº³è¯æ˜(è¯¦è§å°å¤§æœºå™¨å­¦ä¹ è¯¾ç¨‹lecture6)ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªç»“è®º: è®¾break pointå­˜åœ¨ä¸”ä¸º $k$ çš„å‡è®¾ç©ºé—´çš„å¢é•¿å‡½æ•°ä¸Šç•Œä¸º $B(N,k)$ï¼Œåˆ™ $B(N,k)$ æ»¡è¶³$$m_{\\mathcal{H}}(N) \\le B(N,k) \\le \\sum_{i=0}^{k-1}{N \\choose i} \\le N^{k-1}$$æ³¨: ä¸Šå¼çš„è¯æ˜å¯è§è¿™ä¸ªçŸ¥ä¹å›ç­”ï¼Œå¦å¤–æœ€åä¸€ä¸ªä¸ç­‰å·ä»…åœ¨ $N \\ge 2$ ä¸” $k \\ge 2$ æ—¶æˆç«‹ã€‚å³break pointå­˜åœ¨æ—¶å¢é•¿å‡½æ•°ä¸Šç•Œæ˜¯ä¸€ä¸ªå¤šé¡¹å¼ï¼Œå¤šé¡¹å¼çš„æœ€é«˜å¹‚æ¬¡é¡¹ä¸º $N^{kâ€“1}$ã€‚ æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°ç»“è®ºï¼šå¦‚æœbreak pointå­˜åœ¨ï¼Œåˆ™å¢é•¿å‡½æ•° $m_{\\mathcal{H}}(N)$ æ˜¯å¤šé¡¹å¼çš„ã€‚å¤šé¡¹å¼çš„é‡çº§å°±æ¯” $2^N$ å°å¤šäº†ï¼Œè¿™å°±å¾ˆå®¹æ˜“ä¿è¯å¼$(1.3.3)$å³è¾¹è¿™ä¸ªä¸Šç•Œå¾ˆå°ï¼Œå­¦ä¹ å°±å¯è¡Œäº†! 2.3.3 VCç•Œä¸Šä¸€å°èŠ‚æåˆ°å¦‚æœbreak pointå­˜åœ¨ï¼Œå­¦ä¹ æ˜¯å¯è¡Œçš„ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬æ¥å›ç­”ä¸€ä¸‹2.2èŠ‚æœ€åæå‡ºçš„é—®é¢˜: å¯ä¸å¯ä»¥ç”¨ $m_{\\mathcal{H}}(N)$ ç›´æ¥æ›¿æ¢æ‰å¼$(2.1.2)$ ä¸­çš„ $\\text{effective}(M)$ å‘¢ï¼Œå³å¼$(2.2.1)$æ˜¯å¦æˆç«‹ã€‚ ç­”æ¡ˆæ˜¯ä¸èƒ½ç›´æ¥æ›¿æ¢,æ­£ç¡®çš„ä¸ç­‰å¼æ˜¯$$\\forall g \\in \\mathcal{H}, \\mathbb{P}[|E_{in}(g) - E_{out}(g)| &gt; \\epsilon] \\leq 4 m_{\\mathcal{H}}(2N) \\exp(-\\frac18 \\epsilon^2 N) \\tag{2.3.1}$$ ä¸Šå¼å…¶å®å’Œå¼ $(2.2.1)$ å·®ä¸å¤šï¼Œå…¶è¯æ˜ç•¥æ˜¾å¤æ‚æˆ‘ä»¬æš‚ä¸å»æ¢ç©¶ï¼Œå¯å‚è€ƒæ­¤å¤„ã€‚ å¼$(2.3.1)$å°±æ˜¯VCç•Œï¼Œè¿™ä¸ªå…¬å¼çš„æ„ä¹‰åœ¨äºï¼šå¦‚æœå‡è®¾ç©ºé—´ $\\mathcal{H}$ å­˜åœ¨æœ‰é™çš„break point $k$ï¼Œå³ $m_{\\mathcal{H}}(2N)$ ä¼šè¢«æœ€é«˜å¹‚æ¬¡ä¸º $kâ€“1$ çš„å¤šé¡¹å¼ä¸Šç•Œç»™çº¦æŸä½ï¼Œé‚£ä¹ˆï¼Œéšç€ $N$ çš„é€æ¸å¢å¤§ï¼ŒæŒ‡æ•°å¼ $exp(\\cdot)$ çš„ä¸‹é™ä¼šæ¯”å¤šé¡¹å¼ $m_{\\mathcal{H}}(2N)$ çš„å¢é•¿é€Ÿåº¦æ›´å¿«ï¼Œæ‰€ä»¥æ­¤æ—¶å¯ä»¥æ¨æ–­å‡ºVCç•Œæ˜¯æœ‰ç•Œçš„ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå½“ $N$ è¶³å¤Ÿå¤§æ—¶ï¼Œå¯¹äº $\\mathcal{H}$ ä¸­çš„ä»»æ„ä¸€ä¸ªå‡è®¾ $g$ ï¼Œ$E_{in}(g)$ éƒ½å°†æ¥è¿‘äº $E_{out}(g)$ï¼Œå³å­¦ä¹ æ˜¯å¯è¡Œçš„ã€‚ 2.4 VCç»´ç°åœ¨ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥å®šä¹‰VCç»´äº†: å‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„VCç»´æ˜¯èƒ½è¢« $\\mathcal{H}$ æ‰“æ•£çš„æœ€å¤§æ•°æ®é›†çš„å¤§å°ï¼Œå³$$VC(\\mathcal{H}) = max \\lbrace N: m_{\\mathcal{H}}(N) = 2^N\\rbrace$$æ ¹æ®æ­¤å®šä¹‰ï¼Œæœ‰ $VC(\\mathcal{H}) = k-1$ï¼Œå…¶ä¸­ $k$ æ˜¯ $\\mathcal{H}$ çš„break pointã€‚ $VC(\\mathcal{H}) = d$ è¡¨æ˜å­˜åœ¨å¤§å°ä¸º $d$ çš„æ•°æ®é›†èƒ½è¢«å‡è®¾ç©ºé—´ $\\mathcal{H}$ æ‰“æ•£ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™å¹¶ä¸æ„å‘³ç€æ‰€æœ‰å¤§å°ä¸º $d$ çš„æ•°æ®é›†éƒ½èƒ½è¢« $\\mathcal{H}$ æ‰“æ•£ï¼Œä¾‹å¦‚äºŒç»´å¹³é¢ä¸Šçš„æ‰€æœ‰ç›´çº¿æ„æˆçš„å‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„VCç»´ä¸º3ï¼Œä½†æ˜¯å®ƒå¹¶ä¸èƒ½æ‰“æ•£ä½äºåŒä¸€æ¡ç›´çº¿ä¸Šçš„ä¸‰ä¸ªç‚¹ã€‚äº‹å®ä¸Šï¼ŒVCç»´çš„å®šä¹‰ä¸æ•°æ®å…·ä½“åˆ†å¸ƒæ˜¯æ— å…³çš„ã€‚ å› ä¸º $VC(\\mathcal{H}) = k-1$ï¼Œæ‰€ä»¥ç”±2.3.2èŠ‚å¯çŸ¥å½“ $N \\ge 2$ ä¸” $k \\ge 2$ æ—¶ï¼Œæœ‰$$m_{\\mathcal{H}}(N) \\le N^{VC(\\mathcal{H})} \\tag{2.4.1}$$ å°†ä¸Šå¼ä»£å…¥$(2.3.1)$çš„å³è¾¹VCç•Œæœ‰$$\\forall g \\in \\mathcal{H}, \\mathbb{P}[|E_{in}(g) - E_{out}(g)| &gt; \\epsilon] \\leq 4 (2N)^{VC(\\mathcal{H})} \\exp(-\\frac18 \\epsilon^2 N) \\tag{2.4.2}$$ æ‰€ä»¥ï¼Œ1.3èŠ‚çš„å¯å­¦ä¹ çš„ä¸¤ä¸ªæ ¸å¿ƒæ¡ä»¶ç­‰ä»·äº: å­¦ä¹ ç®—æ³• $\\mathcal{A}$ èƒ½å¤Ÿä» $\\mathcal{H}$ é€‰å‡ºçš„å‡è®¾ $g$ æ»¡è¶³ $E_{in}(g) \\approx 0$ã€‚å†ç»“åˆæ¡ä»¶2å³è¾¾åˆ°äº† $E_{out}(g) \\approx 0$ çš„ç›®æ ‡ã€‚ å‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„VCç»´ $VC(\\mathcal{H})$ æ˜¯æœ‰é™çš„ä¸”è®­ç»ƒæ ·æœ¬æ•° $N$ è¶³å¤Ÿå¤§ã€‚æ­¤æ—¶å¯ä¿è¯å¼(2.4.2)å³è¾¹ä¸Šç•Œè¶‹äº0ï¼Œå³å­¦ä¹ ç®—æ³• $\\mathcal{A}$ ä» $\\mathcal{H}$ é€‰å‡ºçš„ä»»æ„å‡è®¾ $g$ éƒ½æ»¡è¶³ $E_{in}(g) \\approx E_{out}(g)$ã€‚ VCç»´åæ˜ äº†å‡½æ•°é›†çš„å­¦ä¹ èƒ½åŠ›ï¼ŒVCç»´è¶Šå¤§ï¼Œèƒ½å­¦åˆ°çš„æ¨¡å‹è¶Šå¤æ‚ã€‚æ ¹æ®å‰é¢çš„æ¨å¯¼ï¼Œæˆ‘ä»¬çŸ¥é“VCç»´çš„å¤§å°ä¸å­¦ä¹ ç®—æ³•æ— å…³ï¼Œä¸æ•°æ®é›†çš„å…·ä½“åˆ†å¸ƒæ— å…³ï¼Œä¸æˆ‘ä»¬æ±‚è§£çš„ç›®æ ‡å‡½æ•°ä¹Ÿæ— å…³ï¼Œåªä¸æ¨¡å‹å’Œå‡è®¾ç©ºé—´æœ‰å…³ã€‚å¦å¤–ï¼Œå®è·µä¸­æœ‰è¿™æ ·ä¸€ä¸ªè§„å¾‹ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå‡è®¾ç©ºé—´çš„VCç»´çº¦ç­‰äºå‡è®¾è‡ªç”±å˜é‡çš„æ•°ç›®ã€‚ 2.5 $E_{in}(g)$ ä¸ $E_{out}(g)$ çš„å…³ç³»ä»¤å¼$(2.4.2)$å³è¾¹çš„ $4 (2N)^{VC(\\mathcal{H})} \\exp(-\\frac18 \\epsilon^2 N) = \\delta$ï¼Œå³åäº‹å‘ç”Ÿçš„æ¦‚ç‡$$\\mathbb{P}[|E_{in}(g) - E_{out}(g)| &gt; \\epsilon] \\leq \\delta \\tag{2.5.1}$$åˆ™å¯åè§£å‡º$$\\epsilon = \\sqrt{\\frac 8 N \\ln \\left( \\frac {4(2N)^{VC(\\mathcal{H})}} \\delta \\right)} \\tag{2.5.2}$$ç”±(2.5.1)å¯å¾—å‡ºï¼Œæœ‰ $1-\\delta$ çš„æ¦‚ç‡å¥½äº‹æƒ…ä¼šå‘ç”Ÿï¼Œå¥½äº‹æƒ…å³$$E_{in}(g) - \\sqrt{\\frac 8 N \\ln \\left( \\frac {4(2N)^{VC(\\mathcal{H})}} \\delta \\right)} \\le E_{out}(g) \\le E_{in}(g) + \\sqrt{\\frac 8 N \\ln \\left( \\frac {4(2N)^{VC(\\mathcal{H})}} \\delta \\right)} \\tag{2.5.3}$$ä¸Šå¼å°±æ˜¯ $E_{in}(g)$ ä¸ $E_{out}(g)$ çš„å…³ç³»ã€‚å…¶ä¸­ï¼Œæ ¹å·éƒ¨åˆ†ä¹Ÿå¯ä»¥çœ‹åšæ¨¡å‹çš„å¤æ‚åº¦ $\\Omega$ï¼Œæ¨¡å‹è¶Šå¤æ‚ï¼Œ$E_{in}(g)$ ä¸ $E_{out}(g)$ ç¦»å¾—è¶Šè¿œã€‚å¦‚å›¾2.5æ‰€ç¤ºï¼Œå½“å›ºå®šæ ·æœ¬æ•° $N$ æ—¶ï¼Œéšç€VCç»´çš„ä¸Šå‡ï¼Œ$E_{in}(g)$ ä¼šä¸æ–­é™ä½ï¼Œè€Œå¤æ‚åº¦ $\\Omega$ ä¼šä¸æ–­ä¸Šå‡ï¼Œå…¶ä¸Šå‡ä¸ä¸‹é™çš„é€Ÿåº¦åœ¨æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ‰€ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬è¦å¯»æ‰¾ä¸€ä¸ªäºŒè€…å…¼é¡¾çš„æ¯”è¾ƒåˆé€‚çš„VCç»´ä½¿ $E_{out}(g)$ æœ€å°ã€‚ å›¾2.5 æ­¤å¤–ï¼Œç”±ä¸Šé¢çš„åˆ†ææ˜“çŸ¥ï¼Œæ ·æœ¬æ•° $N$ ä¹Ÿä¼šå½±å“ $E_{out}(g)$ã€‚ä¾‹å¦‚ï¼Œå½“å‰æœ‰ä¸€ä¸ª $VC(\\mathcal{H})=3$ çš„å‡è®¾ç©ºé—´ï¼Œè¦ä½¿ $\\epsilon=0.1$ ä¸” $\\delta=0.1$ï¼Œåˆ™è¦æƒ³æ»¡è¶³å¼$(2.5.2)$ï¼Œå¯è®¡ç®—å‡ºç†è®ºä¸Šæ ·æœ¬æ•° $N$ éœ€è¦è¾¾åˆ° $10000VC(\\mathcal{H})$ è¿™ä¸ªé‡çº§ï¼Œä½†å®é™…åº”ç”¨ä¸­æˆ‘ä»¬å‘ç° $N$ è¾¾åˆ° $10VC(\\mathcal{H})$ å°±å¤Ÿäº†ã€‚è¿™æ˜¯å› ä¸ºï¼ŒVCç•Œæ˜¯ä¸€ä¸ªåŠå…¶å®½æ¾çš„ä¸Šç•Œï¼Œå› ä¸ºå®ƒéœ€è¦å¯¹ä»»ä½•å­¦ä¹ ç®—æ³•ï¼Œå¯¹ä»»ä½•æ•°æ®åˆ†å¸ƒï¼Œå¯¹ä»»ä½•ç›®æ ‡å‡½æ•°éƒ½è¦æˆç«‹,æ‰€ä»¥å®é™…åº”ç”¨ä¸­çš„ä¸Šç•Œè¦æ¯”VCç•Œå°å¾ˆå¤šã€‚ 3. æ€»ç»“æ€»ç»“ä¸€ä¸‹æœ¬æ–‡çš„è¡Œæ–‡æ€è·¯ï¼Œ å…ˆç”¨Hoeffdingä¸ç­‰å¼è¯´æ˜äº†å¯å­¦ä¹ çš„ä¸¤ä¸ªæ¡ä»¶: (1) å­¦ä¹ ç®—æ³• $\\mathcal{A}$ èƒ½å¤Ÿä» $\\mathcal{H}$ é€‰å‡ºçš„å‡è®¾ $g$ æ»¡è¶³ $E_{in}(g) \\approx 0$ã€‚ (2) å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­å‡è®¾æ•° $M$ æ˜¯æœ‰é™çš„ä¸”è®­ç»ƒæ ·æœ¬æ•° $N$ è¶³å¤Ÿå¤§ã€‚ ä½†å‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­å‡è®¾æ•° $M$ å¾€å¾€æ˜¯æ— ç©·å¤§çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨æ¨å¯¼å‡ºæ¡ä»¶(2)æ—¶ï¼Œæˆ‘ä»¬è¦æ±‚å‡è®¾ç©ºé—´çš„æ‰€æœ‰å‡è®¾éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œå‡è®¾ç©ºé—´ $\\mathcal{H}$ ä¸­ç‹¬ç«‹å‡è®¾æ•° $\\text{effective}(M)$ å´æ˜¯æœ‰é™çš„ï¼Œå¢é•¿å‡½æ•°å‘Šè¯‰æˆ‘ä»¬ $\\text{effective}(M)$ çš„ä¸Šç•Œä¸º $2^N$ ã€‚ $2^N$ è¿™ä¸ªä¸Šç•Œè¿˜æ˜¯å¤ªå¤§äº†ï¼Œå­¦ä¹ è¿˜æ˜¯å¾ˆéš¾å¯è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬åˆå¼•å…¥äº†break pointçš„æ¦‚å¿µï¼Œä½¿ $2^N$ çš„é‡çº§é™ä¸º $N^{k-1}$, ç”±æ­¤å¾—åˆ°äº†VCç•Œã€‚ ç„¶åæˆ‘ä»¬ç»™å‡ºäº†VCç»´çš„å®šä¹‰ï¼Œå¯å­¦ä¹ çš„ä¸¤ä¸ªæ¡ä»¶è½¬å˜ä¸º: (1) å­¦ä¹ ç®—æ³• $\\mathcal{A}$ èƒ½å¤Ÿä» $\\mathcal{H}$ é€‰å‡ºçš„å‡è®¾ $g$ æ»¡è¶³ $E_{in}(g) \\approx 0$ã€‚ (2) å‡è®¾ç©ºé—´ $\\mathcal{H}$ çš„VCç»´ $VC(\\mathcal{H})$ æ˜¯æœ‰é™çš„ä¸”è®­ç»ƒæ ·æœ¬æ•° $N$ è¶³å¤Ÿå¤§ã€‚ æœ€åæˆ‘ä»¬è®¨è®ºäº† $E_{in}(g)$ ä¸ $E_{out}(g)$ çš„å…³ç³»ï¼Œå‘ç°ä¸ºäº†ä½¿å­¦ä¹ å™¨æ›´å¥½($E_{out}(g)$æ›´å°)ï¼Œè¦é€‰æ‹©åˆé€‚çš„VCç»´ï¼Œä¸èƒ½å¤ªå¤§ä¹Ÿä¸èƒ½å¤ªå°ã€‚ å› ç¬”è€…è‡ªèº«æ°´å¹³å®åœ¨æœ‰é™ï¼Œå¦‚æœæ–‡ç« æœ‰ä»»ä½•çš„ä¸å¦¥ï¼Œè¿˜è¯·è¯»è€…å‘Šä¹‹ã€‚æ­¤å¤–ï¼ŒVCç»´å¯ä»¥è¯´æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„ä¸€å¤§æ ¸å¿ƒï¼Œå¹¶éä¸€ç¯‡åšå®¢å°±å¯ä»¥è®²è§£é€å½»ï¼Œæ‰€ä»¥æœ¬æ–‡ä¹Ÿçœç•¥äº†ä¸€äº›å¤æ‚çš„è¯æ˜ï¼Œå¦‚æœæƒ³æ·±å…¥ç†è§£å¯ä»¥å»æŸ¥é˜…ç›¸å…³ä¹¦ç±æˆ–è®ºæ–‡ã€‚ å‚è€ƒ å‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹ç¬¬12ç« .è®¡ç®—å­¦ä¹ ç†è®º å°å¤§æœºå™¨å­¦ä¹ åŸºçŸ³è¯¾ç¨‹ ECE 901 Lecture 19: The Proof of the Vapnik-Chervonenkis (VC) Inequality Computational Learning Theory - VC Dimension [é™†å‹¤å­¦ä¹ ]è§£è¯»æœºå™¨å­¦ä¹ åŸºç¡€æ¦‚å¿µï¼šVCç»´çš„æ¥é¾™å»è„‰","categories":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"https://tangshusen.me/categories/Machine-Learning/"}],"tags":[{"name":"VCç»´","slug":"VCç»´","permalink":"https://tangshusen.me/tags/VCç»´/"}]},{"title":"å®é™…åº”ç”¨ä¸­å…³äºsize_tçš„ä¸€ä¸ªå®¹æ˜“å¿½ç•¥çš„å‘","slug":"size-t","date":"2018-12-08T13:42:13.000Z","updated":"2018-12-30T09:15:20.196Z","comments":true,"path":"2018/12/08/size-t/","link":"","permalink":"https://tangshusen.me/2018/12/08/size-t/","excerpt":"ä»Šå¤©åœ¨LeetCodeä¸Šåš3Sumçš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€ä¸ªä¸€å¼€å§‹ä»¤æˆ‘ç™¾æ€ä¸å¾—å…¶è§£çš„bugï¼Œæœ€åå‘ç°è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ğŸ˜­ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ä»¥åŠ æ·±å°è±¡ã€‚","text":"ä»Šå¤©åœ¨LeetCodeä¸Šåš3Sumçš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€ä¸ªä¸€å¼€å§‹ä»¤æˆ‘ç™¾æ€ä¸å¾—å…¶è§£çš„bugï¼Œæœ€åå‘ç°è¿˜æ˜¯è‡ªå·±å¤ªèœäº†ğŸ˜­ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ä»¥åŠ æ·±å°è±¡ã€‚ èµ·å› å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸‹é¢è¿™æ®µä»£ç æ˜¯è¿‡ä¸äº†è¾“å…¥ä¸ºç©ºçš„æµ‹è¯•æ ·ä¾‹çš„ã€‚ ä½†æ˜¯å¦‚æœæˆ‘åŠ ä¸Šä¸€ä¸ªâ€å¤šä½™çš„â€æå‰åˆ¤æ–­çš„è¯­å¥å°±èƒ½è¿‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ ä¸ºä»€ä¹ˆçœ‹ä¼¼ç­‰ä»·çš„ä»£ç ä¸€ä¸ªèƒ½è¿‡ä¸€ä¸ªä¸èƒ½è¿‡å‘¢ï¼Ÿ åˆ†æè€ƒè™‘è¿™æ ·ä¸€æ®µä»£ç :123456789101112131415#include &lt;iostream&gt;#include &lt;typeinfo&gt;#include&lt;vector&gt;using namespace std;int main()&#123; vector&lt;int&gt;ar; cout &lt;&lt; \"æ•°ç»„arçš„sizeæ˜¯\" &lt;&lt; ar.size()&lt;&lt; endl; for(int i = 0; i &lt; ar.size() - 1; i++)&#123; cout &lt;&lt; \"è¿›å…¥äº†forå¾ªç¯ï¼\" &lt;&lt; endl; break; &#125; cout &lt;&lt; \"ar.size() - 1: \" &lt;&lt; ar.size() - 1 &lt;&lt; endl; return 0;&#125; è¿è¡Œç»“æœæ˜¯:123æ•°ç»„arçš„sizeæ˜¯0è¿›å…¥äº†forå¾ªç¯ï¼ar.size() - 1: 18446744073709551615 å…¶ä¸­ $18446744073709551615 = 2^{64} - 1$ã€‚ä»¿ä½›çŸ¥é“é—®é¢˜å¤§æ¦‚å‡ºåœ¨å“ªå„¿äº†ã€‚ ç»“è®ºè¿™æ‰çªç„¶æƒ³èµ·C++ primerè®²è¿‡ï¼Œsize()è¿”å›çš„æ˜¯ä¸€ä¸ªç±»å‹ä¸ºsize_tçš„é‡ï¼Œé‚£ä»€ä¹ˆæ˜¯size_tå‹å‘¢ï¼Ÿæ¥çœ‹æ ‡å‡†åº“çš„å®šä¹‰: size_tUnsigned integral typeAlias of one of the fundamental unsigned integer types. åŸæ¥size_tæ˜¯æ— ç¬¦å·å‹çš„ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆ ar.size() - 1 æ²¡æœ‰è‡ªåŠ¨è½¬æ¢ä¸ºå¸¦ç¬¦å·å‹çš„å‘¢ï¼Ÿ C++ primerç¬¬äº”ç‰ˆä¸­æ–‡ç‰ˆP35è¿˜è®²è¿‡ï¼š æç¤ºï¼šåˆ‡å‹¿æ··ç”¨å¸¦ç¬¦å·ç±»å‹å’Œæ— ç¬¦å·ç±»å‹å¦‚æœè¡¨è¾¾å¼é‡Œæ—¢æœ‰å¸¦ç¬¦å·ç±»å‹åˆæœ‰æ— ç¬¦å·ç±»å‹ï¼Œå½“å¸¦ç¬¦å·ç±»å‹å–å€¼ä¸ºè´Ÿæ—¶ä¼šå‡ºç°å¼‚å¸¸ç»“æœï¼Œè¿™æ˜¯å› ä¸ºå¸¦ç¬¦å·æ•°ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæ— ç¬¦å·æ•°ã€‚ åŸæ¥åœ¨åŒæ—¶å­˜åœ¨æ— ç¬¦å·å‹æ•°å’Œæœ‰ç¬¦å·å‹æ•°çš„è¡¨è¾¾å¼ä¸­ï¼Œå¸¦ç¬¦å·å‹æ•°æ˜¯ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæ— ç¬¦å·å‹çš„! æ‰€ä»¥ï¼Œå½“æ— ç¬¦å·çš„ar.size()å‡å»1æ—¶ï¼Œç»“æœè‡ªç„¶ä¸æ˜¯-1è€Œæ˜¯ $2^{n} - 1$ï¼Œ$n$ è¡¨ç¤ºsize_tå‹çš„ä½æ•°ã€‚ å€¼å¾—æä¸€ç‚¹çš„æ˜¯ï¼Œsize_tçš„ä½æ•°å¹¶ä¸ä¸€å®šç­‰äºunsignedçš„ä½æ•°çš„: size_tå’Œunsigned intæœ‰æ‰€ä¸åŒ,size_tçš„å–å€¼rangeæ˜¯ç›®æ ‡å¹³å°ä¸‹æœ€å¤§å¯èƒ½çš„æ•°ç»„å°ºå¯¸ã€‚ä¸€äº›å¹³å°ä¸‹size_tçš„èŒƒå›´å°äºintçš„æ­£æ•°èŒƒå›´,åˆæˆ–è€…å¤§äºunsigned int.æœ€å…¸å‹çš„,åœ¨x64ä¸‹,intè¿˜æ˜¯4B,ä½†size_tæ˜¯8B.è¿™æ„å‘³ç€ä½ åœ¨x64ä¸‹æœ€å¤§å¯èƒ½å¼€è¾Ÿçš„æ•°ç»„å°ºå¯¸æ˜¯2^64.ä½œè€…ï¼šKE mengé“¾æ¥ï¼šhttps://www.zhihu.com/question/24773728/answer/28920149æ¥æºï¼šçŸ¥ä¹è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ æ€»ç»“ä»¥åä¸€å®šè¦æ³¨æ„ï¼Œsize()æ˜¯è¿”å›çš„æ— ç¬¦å·å‹çš„æ•°ï¼æ‰€ä»¥å¯¹äºç¬¬ä¸€ä¸ªå›¾ä¸­ä»£ç ï¼Œforå¾ªç¯å†…éƒ¨æ˜¯ä¼šæ‰§è¡Œçš„ï¼Œç»“æœè‡ªç„¶ä¸å¯¹äº†(è¶Šç•Œ)ã€‚ä»¥åè¦ç”¨åˆ°æ•°ç»„çš„sizeæ—¶ï¼Œè¿˜æ˜¯å…ˆå®šä¹‰int len = ar.size()ï¼Œè¿™æ ·ä¸ä»…ä¸ä¼šåçŠ¯è¿™æ¬¡è¿™ä¸ªé”™è¯¯ï¼Œè¿˜èƒ½æ–¹ä¾¿å¤šæ¬¡ä½¿ç”¨ã€‚","categories":[{"name":"C++","slug":"C","permalink":"https://tangshusen.me/categories/C/"}],"tags":[{"name":"è¯­æ³•","slug":"è¯­æ³•","permalink":"https://tangshusen.me/tags/è¯­æ³•/"},{"name":"å‘","slug":"å‘","permalink":"https://tangshusen.me/tags/å‘/"}]},{"title":"Quick, Draw! Doodle Recognition Challenge æ€»ç»“","slug":"kaggle-doodle-reco","date":"2018-12-05T13:58:29.000Z","updated":"2019-01-04T12:28:03.949Z","comments":true,"path":"2018/12/05/kaggle-doodle-reco/","link":"","permalink":"https://tangshusen.me/2018/12/05/kaggle-doodle-reco/","excerpt":"è¿™ä¸ªæ¯”èµ›äº12.05æ—©ä¸Šç»“æŸï¼Œæœ€ç»ˆç»“æœæ˜¯æ’åœ¨69/1316ã€é“œç‰Œï¼Œç¦»é“¶ç‰ŒåŒºå·®4åï¼Œè¿˜æ˜¯æ¯”è¾ƒé—æ†¾çš„ã€‚ä¸è¿‡è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡èŠ±å¤§é‡æ—¶é—´å’Œç²¾åŠ›åœ¨å›¾åƒåˆ†ç±»é—®é¢˜ä¸Šï¼Œä½œä¸ºä¸€ä¸ªå°èœé¸¡èƒ½æ‹¿åˆ°ç‰Œè¿˜ç®—æ»¡æ„ã€‚ç°åœ¨ä½œä¸ªæ€»ç»“ã€‚å¦å¤–æœ¬æ¬¡æ¯”èµ›æˆ‘çš„æ‰€æœ‰ä»£ç ï¼ˆå¸¦æ³¨é‡Šï¼‰å·²ç»å¼€æº(æˆ³æˆ‘)ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹ï¼Œé¡ºä¾¿ç»™ä¸ªstarã€‚","text":"è¿™ä¸ªæ¯”èµ›äº12.05æ—©ä¸Šç»“æŸï¼Œæœ€ç»ˆç»“æœæ˜¯æ’åœ¨69/1316ã€é“œç‰Œï¼Œç¦»é“¶ç‰ŒåŒºå·®4åï¼Œè¿˜æ˜¯æ¯”è¾ƒé—æ†¾çš„ã€‚ä¸è¿‡è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡èŠ±å¤§é‡æ—¶é—´å’Œç²¾åŠ›åœ¨å›¾åƒåˆ†ç±»é—®é¢˜ä¸Šï¼Œä½œä¸ºä¸€ä¸ªå°èœé¸¡èƒ½æ‹¿åˆ°ç‰Œè¿˜ç®—æ»¡æ„ã€‚ç°åœ¨ä½œä¸ªæ€»ç»“ã€‚å¦å¤–æœ¬æ¬¡æ¯”èµ›æˆ‘çš„æ‰€æœ‰ä»£ç ï¼ˆå¸¦æ³¨é‡Šï¼‰å·²ç»å¼€æº(æˆ³æˆ‘)ï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹ï¼Œé¡ºä¾¿ç»™ä¸ªstarã€‚ è¿™ç¯‡åšå®¢ä¸»è¦è®°å½•æˆ‘åœ¨è¿™æ¬¡æ¯”èµ›è¿‡ç¨‹ä¸­å­¦åˆ°çš„ä¸€äº›ä¸œè¥¿ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡èŠ±ç²¾åŠ›è®¤çœŸåšå›¾åƒç±»çš„æ¯”èµ›æ‰€ä»¥å­¦åˆ°çš„ä¸œè¥¿è¿˜æ˜¯å¾ˆå¤šçš„ã€‚æ­¤å¤–è¿˜ä¼šæ€»ç»“ä¸€ä¸‹æ’åœ¨å‰åˆ—çš„å¤§ä½¬ä»¬åœ¨è®¨è®ºåŒºåˆ†äº«çš„ä»–ä»¬çš„æ–¹æ¡ˆï¼Œç•™ä½œæ—¥åå‚è€ƒã€‚ 1. èµ›é¢˜ç®€è¿°1.1 æ•°æ®é›†è¿˜è®°å¾—å‰æ®µæ—¶é—´å¾ˆç«çš„å¾®ä¿¡å°ç¨‹åºâ€œçŒœç”»å°æ­Œâ€å—ï¼Œè¿™ä¸ªæ¯”èµ›çš„æ•°æ®å°±æ¥è‡ªè¿™ä¸ªå°ç¨‹åºçš„ç½‘é¡µç‰ˆQuick, Draw!ï¼Œæ¸¸æˆæç¤ºç”¨æˆ·ç»˜åˆ¶æç»˜ç‰¹å®šç±»åˆ«çš„æ¶‚é¸¦ï¼Œä¾‹å¦‚â€œé¦™è•‰â€ï¼Œâ€œæ¡Œå­â€ç­‰ï¼Œæ‰€ä»¥Googleé€šè¿‡è¿™ä¸ªå°æ¸¸æˆæ”¶é›†äº†æ¥è‡ªä¸–ç•Œå„åœ°çš„æ¶‚é¸¦æ•°æ®, æ•°æ®é›†æ‰€æœ‰ä¿¡æ¯éƒ½å¯è§æ­¤æ•°æ®é›†çš„å®˜æ–¹ä»“åº“ã€‚æœ¬æ¬¡æ¯”èµ›ä½¿ç”¨äº†340ç±»ä¸€å…±çº¦äº”åƒä¸‡ä¸ªæ ·æœ¬ã€‚ ä¸»åŠæ–¹ç»™äº†ä¸¤ä¸ªç‰ˆæœ¬çš„è®­ç»ƒé›†ï¼Œraw å’Œ simplifiedï¼Œéƒ½æ˜¯ä»¥csvæ–‡ä»¶çš„å½¢å¼ç»™å‡ºçš„ã€‚rawç‰ˆæœ¬å°±æ˜¯åŸå§‹æ”¶é›†åˆ°çš„æ•°æ®å„å­—æ®µå¦‚ä¸‹æ‰€ç¤º: Key Type Description key_id 64-bit unsigned integer ç‹¬ä¸€æ— äºŒçš„æ ·æœ¬ID word string æ ·æœ¬æ‰€å±ç±»åˆ« recognized bool æ ·æœ¬æ˜¯å¦è¢«æ¸¸æˆè¯†åˆ« timestamp datetime æ ·æœ¬åˆ›å»ºæ—¶é—´ countrycode string playeræ‰€åœ¨å›½å®¶ä»£ç (ISO 3166-1 alpha-2) drawing string æ¶‚é¸¦æ•°æ®ä¿¡æ¯ å…¶ä¸­drawingå­—æ®µå°±æ˜¯æ¶‚é¸¦æ•°æ®ï¼ŒåŒ…å«åæ ‡å’Œæ—¶é—´ä¿¡æ¯ï¼Œç¤ºä¾‹å¦‚ä¸‹:12345678910111213[ [ // First stroke [x0, x1, x2, x3, ...], [y0, y1, y2, y3, ...], [t0, t1, t2, t3, ...] ], [ // Second stroke [x0, x1, x2, x3, ...], [y0, y1, y2, y3, ...], [t0, t1, t2, t3, ...] ], ... // Additional strokes] rawç‰ˆæœ¬çš„æ•°æ®é›†å¾ˆå¤§è€Œä¸”å¾ˆå¤šå†—ä½™ä¿¡æ¯ï¼Œæ‰€ä»¥å¤§å¤šæ•°é€‰æ‰‹(åŒ…æ‹¬æˆ‘)éƒ½æ˜¯ç”¨çš„simplifiedç‰ˆæœ¬ä½œä¸ºä¸»è¦è®­ç»ƒé›†ï¼Œsimplifiedæ•°æ®é›†å»æ‰äº†æ—¶é—´ä¿¡æ¯å’Œå†—ä½™çš„åæ ‡ä¿¡æ¯(æ¯”å¦‚ä¸¤ç‚¹ç¡®å®šä¸€æ¡çº¿æ®µï¼Œé‚£ä¹ˆçº¿æ®µä¸­é—´çš„ç‚¹å°±æ˜¯å†—ä½™çš„)å¹¶å°†åæ ‡è¿›è¡Œäº†scaleï¼Œå…·ä½“å¤„ç†æ–¹å¼å¦‚ä¸‹: scaled çš„åæ ‡æ•°æ®è¿›è¡Œäº†å·¦ä¸Šå¯¹é½ï¼Œæœ€å°å€¼ä¸º0æœ€å¤§å€¼ä¸º255. è¿›è¡Œäº†é‡é‡‡æ ·ä½¿åæ ‡éƒ½æ˜¯0-255çš„æ•´æ•°. å»é™¤å†—ä½™åæ ‡ä½¿ç”¨çš„æ˜¯Ramerâ€“Douglasâ€“Peuckerç®—æ³•ï¼Œepsilonè®¾ä¸º2.0ï¼› simplifiedæ•°æ®é›†ç¤ºä¾‹å¦‚ä¸‹å›¾æ‰€ç¤º: å›¾1.1 æ›´å¤šä¿¡æ¯å¯è§æ­¤æ•°æ®é›†çš„å®˜æ–¹ä»“åº“ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚ 1.2 èµ›é¢˜ä»»åŠ¡æœ¬é¢˜çš„ä»»åŠ¡å°±æ˜¯é¢„æµ‹æµ‹è¯•é›†æ¶‚é¸¦å±äºå“ªä¸ªç±»åˆ«ï¼Œæ˜¯ä¸€ä¸ªå•åˆ†ç±»é—®é¢˜ã€‚æ­¤é¢˜çš„éš¾åº¦åœ¨äºï¼Œç”±äºè®­ç»ƒæ•°æ®æ¥è‡ªæ¸¸æˆæœ¬èº«ï¼Œæ¶‚é¸¦æ ·æœ¬å¯èƒ½ä¸å®Œæ•´è€Œä¸”å¯èƒ½ä¸æ ‡ç­¾ä¸ç¬¦ï¼Œå™ªå£°æ¯”è¾ƒå¤šï¼Œå¦‚å›¾1.2æ‰€ç¤º(å›¾ç‰‡æ¥æº)ã€‚é€‰æ‰‹éœ€è¦æ„å»ºä¸€ä¸ªè¯†åˆ«å™¨ï¼Œå¯ä»¥æœ‰æ•ˆåœ°ä»è¿™äº›å™ªå£°æ•°æ®ä¸­å­¦ä¹ å¾—åˆ°æ¨¡å‹ã€‚ å›¾1.2 ä¸Šå›¾å°±æ˜¯è®­ç»ƒé›†ä¸­å±äºâ€œèšŠå­â€ç±»åˆ«çš„æ•°æ®ç¤ºä¾‹ï¼Œç»¿è‰²æ˜¯è¢«æ ‡è®°ä¸ºâ€å¯è¯†åˆ«â€çš„æ ·æœ¬ï¼Œçº¢è‰²æ˜¯è¢«æ ‡è®°ä¸ºâ€ä¸å¯è¯†åˆ«â€çš„æ ·æœ¬ï¼Œå¯ä»¥çœ‹åˆ°ä¸ç®¡æ˜¯å¯è¯†åˆ«è¿˜æ˜¯ä¸å¯è¯†åˆ«çš„æ ·æœ¬ï¼Œéƒ½å­˜åœ¨å™ªå£°çš„æƒ…å†µã€‚ 1.3 è¯„ä»·æŒ‡æ ‡è™½ç„¶æ˜¯ä¸€ä¸ªå•åˆ†ç±»é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬ï¼Œæˆ‘ä»¬éœ€è¦æäº¤æœ€æœ‰å¯èƒ½çš„3ä¸ªé¢„æµ‹ç»“æœ(æŒ‰å¯èƒ½æ€§ä»å¤§åˆ°å°æ’)ï¼Œè¯„ä»·æŒ‡æ ‡æ˜¯Mean Average Precision @ 3 (MAP@3):$$\\text{MAP@3} = \\frac { 1 } { U } \\sum _ { u = 1 } ^ { U } \\sum _ { k = 1 } ^ { m i n ( n , 3 ) } P ( k )$$å…¶ä¸­ $U$ æ˜¯æµ‹è¯•é›†æ ·æœ¬æ€»æ•°ï¼Œ$n$ æ˜¯æ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼æ€»æ•°ï¼Œ$P(k)$ æ˜¯å‰ $k$ ä¸ªç»“æœä¸­å‡†ç¡®ç‡, å…·ä½“å¯å‚è§è¿™ä¸ªkernelï¼Œå¦å¤–è®¡ç®—ä»£ç å¯å‚è€ƒè¿™é‡Œã€‚ç®€å•ç‚¹è®²ï¼Œåœ¨æäº¤çš„ä¸‰ä¸ªé¢„æµ‹ç»“æœä¸­ï¼ŒçœŸå®ç»“æœè¶Šé å‰åˆ†æ•°å°±è¶Šé«˜ã€‚ 2. æˆ‘çš„æ–¹æ¡ˆå¯è§æ­¤é¢˜çš„æ•°æ®æ˜¯åºåˆ—æ•°æ®ï¼Œæ‰€ä»¥æœ€å…ˆæƒ³åˆ°å¯ä»¥ç”¨RNNï¼Œå½“ç„¶æŠŠæ•°æ®æ¸²æŸ“æˆå›¾ç‰‡ä¹Ÿå¯ä»¥ç”¨CNNã€‚æ ¹æ®æˆ‘çš„å®é™…å®éªŒï¼ŒRNNçš„æ•ˆæœå¹¶ä¸å¥½ï¼ˆåº”è¯¥æ˜¯æˆ‘ç½‘ç»œç»“æ„æ²¡è®¾è®¡å¥½ï¼Œè®¨è®ºåŒºæœ‰äººæåˆ°ç”¨RNNä¹Ÿå¯ä»¥è¾¾åˆ°ä¸é”™çš„æ•ˆæœï¼‰ï¼Œæ‰€ä»¥å°±é‡‡ç”¨äº†CNNç›¸å…³æ¨¡å‹ï¼Œåæ¥åˆmergeäº†é˜Ÿå‹ï¼Œæœ€ç»ˆçš„69å(PB 0.94223)æ˜¯é˜Ÿå‹çš„æäº¤ç»“æœï¼Œæˆ‘çš„æäº¤ç»“æœ(PB 0.94185)åº”è¯¥æ˜¯73åã€‚ 2.1 æ•°æ®ç›¸å…³2.1.1 æ‰“ä¹±åŸå§‹æ–‡ä»¶é¢˜ç›®ç»™çš„æ•°æ®æ˜¯æ¯ä¸€ç±»ä¸€ä¸ªcsvæ–‡ä»¶ï¼Œä¸€å…±æœ‰340ç±»ï¼Œæ¯ä¸€ç±»æœ‰åå¤šä¸‡ä¸ªæ ·æœ¬ï¼Œå³ä½¿æ˜¯ä½¿ç”¨simplifiedæ•°æ®é›†ï¼Œæ€»çš„csvæ–‡ä»¶å¤§å°ä¹Ÿè¾¾åˆ°äº†20G+çš„çº§åˆ«ï¼Œæ‰€ä»¥ä¸€æ¬¡æ€§è¯»è¿›å†…å­˜è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚æˆ‘é¦–å…ˆé‡‡ç”¨äº†è¿™ä¸ªkernelå°†340ä¸ªcsvæ–‡ä»¶æ··åˆåœ¨ä¸€èµ·ç„¶åå†éšæœºåˆ†æˆ100ä»½åˆ†åˆ«å­˜å‚¨ï¼Œè¿™æ ·æ¯ä¸€ä»½é‡Œé¢çš„æ¯ä¸€ä¸ªæ ·æœ¬çš„ç±»åˆ«éƒ½æ˜¯éšæœºçš„ã€‚æ€è·¯å°±æ˜¯æ ¹æ®key_idçš„å€¼äº§ç”Ÿä¸€ä¸ª0-99çš„ä¼ªéšæœºæ•°cvï¼Œç„¶åcvå°±è§‰å®šå½“å‰æ ·æœ¬åº”è¯¥æ”¾åœ¨å“ªä¸ªæ–‡ä»¶ï¼Œæœ€åå†å°†æ¯ä¸ªæ–‡ä»¶é‡Œçš„æ ·æœ¬é¡ºåºæ‰“ä¹±ã€‚å…¶æ ¸å¿ƒä»£ç å¦‚ä¸‹: (1) å†³å®šæŸä¸ªæ ·æœ¬åº”è¯¥å­˜æ”¾åœ¨å“ªä¸ªæ–‡ä»¶:1234567891011121314151617181920212223for y, cat in tqdm(enumerate(categories)): # å…±340ä¸ªç±»åˆ« df = s.read_training_csv(cat) # dfå°±ä¸ºå½“å‰ç±»åˆ«çš„csv df['y'] = y # yä¸º 0~339 çš„æ•°å­—ï¼Œç›¸å½“äºå¯¹ç±»åˆ«è¿›è¡Œäº†LabelEncode df['cv'] = (df.key_id // 10 ** 7) % NCSVS # NCSVS = 100, cvå†³å®šäº†åº”è¯¥æ”¾åœ¨å“ªä¸€ä¸ªæ–‡ä»¶ä¸­ for k in range(NCSVS): filename = INPUT_PATH + '/shuffled_csv/train_%d_%d.csv'%(k+1, NCSVS) chunk = df[df.cv == k] # å¾—åˆ°dfä¸­cv=kçš„æ ·æœ¬ï¼Œåº”è¯¥å­˜æ”¾åœ¨å½“å‰æ–‡ä»¶ä¸­ chunk = chunk.drop(['key_id'], axis=1) if y == 0: # æ–°å»ºæ–‡ä»¶ chunk.to_csv(filename, index=False) else: # mode='a': é™„åŠ å†™ æ–¹å¼æ‰“å¼€æ–‡ä»¶ chunk.to_csv(filename, mode='a', header=False, index=False) ``` (2) å°†æ¯ä¸ªæ–‡ä»¶ä¸­çš„æ ·æœ¬é¡ºåºæ‰“ä¹±:``` pythonfor k in tqdm(range(NCSVS)): filename = INPUT_PATH + '/shuffled_csv/train_%d_%d.csv'%(k+1, NCSVS) if os.path.exists(filename): df = pd.read_csv(filename) df['rnd'] = np.random.rand(len(df)) # ç»™æ¯ä¸ªæ ·æœ¬ä¸€ä¸ªéšæœºæ•° df = df.sort_values(by='rnd').drop('rnd', axis=1) df.to_csv(filename + '.gz', compression='gzip', index=False) # ä»¥å‹ç¼©çš„æ–¹å¼å­˜å‚¨csv os.remove(filename) è¿™æ ·å¤„ç†åï¼ŒåŸå§‹simplifiedæ•°æ®é›†ä¸­340ä¸ªå…±20G+çš„csvæ–‡ä»¶è¢«å¤„ç†æˆ100ä¸ªcsvå…±7G+ï¼Œè€Œä¸”æ¯ä¸ªæ–‡ä»¶é‡Œçš„æ ·æœ¬ä¸æ˜¯å±äºåŒä¸€ç±»è€Œæ˜¯éšæœºçš„ï¼Œè¿™å°±æ–¹ä¾¿åç»­çš„æ•°æ®è¯»å–äº†ã€‚ä¸Šé¢å®Œæ•´çš„ä»£ç è§æˆ‘çš„ä»“åº“ã€‚ 2.1.2 å¤šè¿›ç¨‹è¯»å–ç»è¿‡2.1.1å¤„ç†åçš„æ•°æ®å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç›´æ¥ç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å¹¶è¡Œè¯»å–ä½¿è¯»å–æ›´å¿«:1234567891011121314151617181920212223242526def read_one_df_file(df_file): \"\"\"å®šä¹‰ä¸€ä¸ªè¯»å–ä¸€ä¸ªcsvçš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå½“åšå‚æ•°ä¼ å…¥ä¸‹é¢çš„å¹¶è¡Œå¤„ç†çš„å‡½æ•°\"\"\" unused_cols = [\"countrycode\", \"recognized\", \"timestamp\", \"cv\"] name = df_file.split('_')[-2] print('%s ' % (name), end = ' ', flush=True) df = pd.read_csv(df_file) drop_cols = [col for col in unused_cols if col in df.columns] if len(drop_cols) &gt; 0: df = df.drop(drop_cols, axis=1) return dfdef multi_thread_read_df_files(df_files, processes=32): \"\"\"å¹¶è¡Œè¯»å–å¤šä¸ªcsvå¹¶ç»„æˆä¸€ä¸ªå¤§çš„bigdf\"\"\" start = dt.datetime.now() pool = Pool(processes=processes) # from multiprocessing import Pool dfs = pool.map(read_one_df_file, df_files) pool.close() pool.join() end = dt.datetime.now() print(\"\\nTotal time:\", (end - start).seconds, \"seconds\") big_df = pd.concat(dfs, ignore_index=False, sort=False) big_df.reset_index(drop=True, inplace=True) return big_df ä¸Šé¢çš„å®Œæ•´ä»£ç è§æˆ‘çš„ä»“åº“é‡Œçš„data_loader.pyï¼Œå¦å¤–å¤šè¿›ç¨‹çš„å­¦ä¹ å¯å‚è€ƒæ­¤å¤„ã€‚ 2.1.3 outliersç”±å›¾1.2çŸ¥è®­ç»ƒæ•°æ®ä¸­æœ‰å¾ˆå¤šå™ªå£°ï¼Œå¦‚ä½•è¡¡é‡å™ªå£°å¹¶å»é™¤è¿™äº›å™ªå£°æ•°æ®ï¼ˆoutliersï¼‰å‘¢ï¼Ÿkernel sketch entropyæå‡ºç”¨ç†µï¼ˆentropyï¼‰æ¥æ‰¾å‡ºè¿™äº›outliers, å³æŠŠentropyä½äºå’Œé«˜äºæŸé˜ˆå€¼çš„æ ·æœ¬è§†ä¸ºoutliersã€‚ å…ˆæ¥çœ‹çœ‹å¦‚ä½•è®¡ç®—entropyï¼š12345def entropy_it(x): counts = np.bincount(x) # è®¡ç®—xä¸­ 0-255è¿™äº›æ•°å­—çš„å‡ºç°æ¬¡æ•° p = counts[counts &gt; 0] / float(len(x)) # å½’ä¸€åŒ–æˆæ¦‚ç‡ # compute Shannon entropy in bits return -np.sum(p * np.log2(p)) ç›´è§‚ç†è§£ï¼Œå¦‚æœä¸€å¼ å›¾ç‰‡ä¸Šçš„ä¿¡æ¯å¾ˆå°‘ä¾‹å¦‚åƒç´ å€¼å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆå½’ä¸€åŒ–åçš„æ¦‚ç‡på°±å‡ ä¹æ˜¯ä¸€ä¸ªone hotçš„å‘é‡ï¼Œè¿™æ · -np.sum(p * np.log2(p)) å°±å‡ ä¹å¾—0ï¼›ç›¸ååœ°ï¼Œå¦‚æœå›¾ç‰‡ä¸Šçš„ä¿¡æ¯å¾ˆä¸°å¯Œï¼Œåƒç´ åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€ï¼Œé‚£ä¹ˆpå°±æ˜¯ä¸€ä¸ªæ¯ä¸ªå…ƒç´ å‡ ä¹éƒ½ç›¸ç­‰çš„å‘é‡ï¼Œè¿™æ ·ç®—å‡ºæ¥çš„entropyå°±æ¯”è¾ƒå¤§ã€‚ ä¾‹å¦‚è®­ç»ƒé›†æ ·æœ¬entropyä½äºå’Œé«˜äº99%æ ·æœ¬çš„ç¤ºä¾‹åˆ†åˆ«å¦‚ä¸‹ï¼š å›¾2.1 ä½†æ˜¯æˆ‘æœ€ç»ˆå¹¶æ²¡æœ‰æŒ‰ç…§æ­¤æ–¹æ³•å»æ‰è¿™äº›â€œoutliersâ€ï¼Œä¸»è¦æ˜¯å‡ºäºä»¥ä¸‹è€ƒè™‘ï¼š è®­ç»ƒé›†å¾ˆå¤§ï¼Œæ¥è¿‘äº”åƒä¸‡ï¼Œæ‰€ä»¥æ•°æ®å™ªå£°å¯¹æ¨¡å‹çš„å½±å“åº”è¯¥æœ‰é™ï¼› æŒ‰ç…§æ­¤æ–¹æ³•å¯å¾—å‡ºæµ‹è¯•é›†ä¸­ä¹Ÿæœ‰ä¸€äº›å™ªå£°ï¼› æŒ‰ç…§æ­¤æ–¹æ³•å¾—å‡ºçš„ä¸ä¸€å®šå°±æ˜¯å™ªå£°ï¼Œä¾‹å¦‚å›¾2.1ç¬¬ä¸€æ’ç¬¬ä¸€ä¸ªåº”è¯¥æ˜¯â€˜é›¨æ»´â€™ï¼Œæœ€åä¸€æ’ç¬¬ä¸‰ä¸ªåº”è¯¥æ˜¯â€˜é¾™å·é£â€™ã€‚ æ—¶é—´ä¸å¤Ÿäº†ï¼Œå¦‚æœæ—¶é—´å¤Ÿçš„è¯æˆ‘è‚¯å®šä¼šè¯•ä¸€ä¸‹ã€‚ è¿™ä¸ªkernelçš„ä½œè€…ä¹Ÿåœ¨è®¨è®ºä¸­æåˆ°ï¼š Be careful, do not remove unusual samples from training. In my recipe I use a curriculum learning, i.e. increase the amount of outliers at each new epoch. è™½ç„¶æˆ‘æœ€åå¹¶æ²¡æœ‰ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å´æä¾›äº†ä¸€ä¸ªå»å™ªçš„å¥½æ€è·¯ã€‚æœ¬èŠ‚çš„å®Œæ•´ä»£ç è§æˆ‘çš„ä»“åº“ä¸­çš„sketch_entropy notebookã€‚ 2.2 æ¨¡å‹2.2.1 æ¨¡å‹ç»“æ„æœ¬æ¬¡æ¯”èµ›æˆ‘æœ€åé‡‡ç”¨çš„ç»“æ„æ˜¯xceptionï¼ˆå®Œæ•´ä»£ç è§æ­¤å¤„ï¼‰ï¼Œç”¨çš„æ˜¯pretrainedmodelsåº“,è¿™ä¸ªåº“æœ‰ä¸»æµæ¨¡å‹çš„pytorchçš„å®ç°ï¼Œç›´æ¥ç”¨å°±æ˜¯ï¼Œç‰¹åˆ«æ–¹ä¾¿ã€‚ä»£ç å¦‚ä¸‹1234567891011121314from pretrainedmodels.models.xception import Xceptionxception_path = \"/YOUR_PATH/pytorch/xception-43020ad28.pth\"def create_model(num_classes=340, model_func=Xception, pretrained_path=xception_path): model = model_func(num_classes=1000) # imageNeté¢„è®­ç»ƒå‚æ•°ï¼ŒçœŸçš„æœ‰ç”¨å—ï¼Ÿ model.load_state_dict(torch.load(pretrained_path)) # ä¿®æ”¹æœ€åçš„fcå±‚ fc_in_feas = model.fc.in_features model.fc = nn.Linear(fc_in_feas, num_classes) model.last_linear = model.fc # pretrainedmodelsè¿™ä¸ªåŒ…é‡Œçš„æ¨¡å‹ä½œforwardæ—¶ä½¿ç”¨çš„æ˜¯last_linear return model 2.2.2 æ¢¯åº¦ç´¯ç§¯trickæˆ‘ä»¬çŸ¥é“ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¢å¤§batch sizeä¼šä½¿æœ€ç»ˆçš„é¢„æµ‹æ•ˆæœå˜å¾—æ›´å¥½ï¼Œä½†æ˜¯GPUæ˜¾å­˜æ˜¯æœ‰é™çš„ä¸å¯èƒ½æ— é™å¢å¤§batch sizeï¼Œè¿™æ—¶å€™æ¢¯åº¦ç´¯ç§¯å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ç®€å•æ¥è¯´ï¼Œæ¢¯åº¦ç´¯ç§¯å°±æ˜¯ç´¯ç§¯å¤šä¸ªbatchçš„æ¢¯åº¦ç„¶åä¸€æ¬¡æ›´æ–°å‚æ•°ï¼Œè€Œä¸æ˜¯å¸¸ç”¨çš„ä¸€ä¸ªbatchæ›´æ–°ä¸€æ¬¡ï¼Œäº²æµ‹åœ¨å°æ•°æ®é›†ä¸Šæ˜¯æœ‰æ•ˆæœæå‡çš„ï¼ˆæœ¬æ¬¡æ¯”èµ›æ•°æ®é›†sizeå¾ˆå¤§ï¼Œä½†æˆ‘ä¹Ÿç”¨äº†è¿™ä¸ªtrickï¼Œæ²¡æœ‰å’Œä¸ç”¨è¿™ä¸ªtrickåšæ¯”è¾ƒï¼‰ã€‚å‚è€ƒè¿™é‡ŒGopal_Sharmaçš„ç³»åˆ—å›ç­”ï¼Œæˆ‘å†™äº†å¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122# loss, preds, step_acc = train_step(model, inputs, labels, criterion, optimizer)################# å°†batch_accumulate_sizeä¸ªbatchçš„æ¢¯åº¦ç§¯ç´¯èµ·æ¥,åªåœ¨æœ€åä¸€æ¬¡æ›´æ–°ç½‘ç»œå‚æ•° ###################inputs = inputs.to(DEVICE, dtype=torch.float)labels = labels.to(DEVICE, dtype=torch.float)if step % batch_accumulate_size == 0: optimizer.zero_grad()with torch.set_grad_enabled(True): # forward outputs = model(inputs) loss = criterion(outputs, labels.long()) / batch_accumulate_size # ä¸€å®šè¦é™¤ä»¥è¿™ä¸ªsize,åŸå› è§ä¸Šé¢é“¾æ¥çš„è®¨è®º loss.backward() _, preds = torch.max(outputs, 1)correct_num = torch.sum(preds == labels.long())step_acc = correct_num.double() / inputs.size(0) if (step + 1) % batch_accumulate_size == 0: optimizer.step() # åªåœ¨æœ€åä¸€æ¬¡æ›´æ–°ç½‘ç»œå‚æ•°loss = batch_accumulate_size * loss.item() # è½¬æ¢ä¸ºæ•°å­—æ–¹ä¾¿åé¢ç”¨visdomç”»å›¾step_acc = step_acc.item()######################################################################################## 2.2.3 å¤šGPUpytorchå®ç°å¤šGPUè¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œåªéœ€è¦åŠ ä¸Šä¸€è¡Œä»£ç å³å¯ï¼š12model = create_model()multi_gpu_model = nn.DataParallel(model) éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨äº†DataParallel(model)çš„æ¨¡å‹åœ¨ä¿å­˜çš„æ—¶å€™ä¼šåœ¨å‚æ•°çš„keyå‰é¢åŠ ä¸Šâ€œmodule.â€ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨å•GPUæ—¶åŠ è½½å¤šGPUä¿å­˜çš„æ¨¡å‹å‚æ•°æ—¶ä¼šæŠ¥é”™KeyError: &#39;unexpected key &quot;module.xx.weight&quot; in state_dict&#39;ï¼Œæ­£ç¡®çš„å¤„ç†æ–¹å¼å¦‚ä¸‹ï¼š12345678910111213from collections import OrderedDictpretrained_net_dict = torch.load(best_model_path)if hps.gpus == 1 and list(pretrained_net_dict.keys())[0][:6] == \"module\":# å¦‚æœå½“å‰æ˜¯å•GPUä½†æ˜¯ä¿å­˜çš„æ¨¡å‹æ˜¯å¤šGPUï¼Œé‚£å°±è¦å»æ‰æ¯ä¸ªkeyçš„å‰ç¼€\"module.\" new_state_dict = OrderedDict() for k, v in pretrained_net_dict.items(): name = k[7:] # remove \"module.\" new_state_dict[name] = v # load params model.load_state_dict(new_state_dict)else: model.load_state_dict(pretrained_net_dict) 2.2.4 å›¾åƒæ•°æ®çš„ä¸€ä¸ªå‘æœ¬èŠ‚çš„notebookè§æ­¤å¤„ã€‚ äº‹æƒ…çš„èµ·å› æ˜¯è¿™æ ·çš„ï¼Œæˆ‘åœ¨è®­ç»ƒçš„æ—¶å€™æ²¡æœ‰è¿›è¡Œæ•°æ®å¢å¼º(åªç”¨äº†toTensorå’ŒNormalizeä¸¤ä¸ªtransform)ï¼Œè€Œæˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™æƒ³ç”¨ä¸€ä¸‹ç”¨torchvisionè‡ªå¸¦çš„ä¸€äº›å›¾ç‰‡å¢å¼ºçš„transform(ä¾‹å¦‚CenterCropã€RandomHorizontalFlipã€RandomRotationç­‰ç­‰)ï¼Œä½†æ˜¯è¿™äº›transformè¦æ±‚è¾“å…¥çš„æ˜¯PILå›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™å°±ç”¨äº†å¦‚ä¸‹ä»£ç å°†image arrayè½¬æˆäº†PILå›¾ç‰‡ï¼š1PIL_image = Image.fromarray(image_array.astype('uint8'), 'RGB') ä½†æœ€åæµ‹è¯•å‡ºæ¥çš„ç»“æœä¸éªŒè¯æ—¶å®Œå…¨ä¸ä¸€æ ·ï¼Œæ¨¡å‹åŸºæœ¬ä¸Šæ˜¯é çŒœã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä»”ç»†çœ‹çœ‹ä¸‹é¢è¿™ä¸ªå›¾å°±çŸ¥é“äº†ã€‚ å›¾2.2 ç”±å›¾2.2å¯çŸ¥ï¼Œè®­ç»ƒå’Œæµ‹è¯•çš„æ—¶å€™æ•°æ®å–å€¼èŒƒå›´éƒ½å˜äº†ï¼Œç½‘ç»œé¢„æµ‹ç»“æœå½“ç„¶å°±å¾ˆå·®äº†ã€‚å…ˆæ¥çœ‹çœ‹ToTensorçš„å®˜æ–¹æ–‡æ¡£: 123torchvision.transforms.ToTensorConvert a PIL Image or numpy.ndarray to tensor.Converts a PIL Image or numpy.ndarray (H x W x C) in the range [0, 255] to a torch.FloatTensor of shape (C x H x W) in the range [0.0, 1.0]. å¯è§ToTensorå°†è¾“å…¥çš„0-255çš„æ•°æ®scaleåˆ°0-1å¹¶ä¸”è¿˜è°ƒæ•´äº†ä¸€ä¸‹ç»´åº¦é¡ºåºï¼Œé‚£ä¸ºä»€ä¹ˆå›¾2.2çš„è®­ç»ƒè¾“å…¥è¿˜æ˜¯0-255å‘¢? é—®é¢˜å°±å‡ºåœ¨æ•°æ®çš„ç±»å‹ä¸Šé¢ï¼Œè®­ç»ƒæ—¶ï¼ŒåŸå§‹å›¾ç‰‡æ•°æ®iamge_arrayçš„ç±»å‹æ˜¯float64(è€Œä¸æ˜¯ToTensoræœŸå¾…çš„uint8)ï¼Œç»è¿‡ToTensorè½¬æ¢åæ•°å€¼å¤§å°ä¸ä¼šå˜ä¾ç„¶æ˜¯0-255åªæ˜¯è°ƒäº†ä¸€ä¸‹ç»´åº¦é¡ºåºã€‚è€Œæµ‹è¯•çš„æ—¶å€™ï¼Œç”±äºToPILImageå¼ºåˆ¶è¦æ±‚è¾“å…¥ç±»å‹æ˜¯uint8ï¼Œæ‰€ä»¥å…ˆå°†è¾“å…¥è½¬æ¢æˆäº†uint8æ ¼å¼ï¼Œæ‰€ä»¥å°±æ­£ç¡®çš„è¢«scaleåˆ°äº†0-1ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œç”±äºåƒç´ å€¼ä¸º0åˆ°255çš„æ•´æ•°ï¼Œæ‰€ä»¥åˆšå¥½æ˜¯uint8æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´ï¼Œè€Œå¾ˆå¤šå…³äºå›¾ç‰‡çš„å‡½æ•°å°±é»˜è®¤è¾“å…¥çš„æ˜¯uint8å‹ï¼Œè‹¥ä¸æ˜¯ï¼Œå¯èƒ½ä¸ä¼šæŠ¥é”™ä½†çš„å¯èƒ½å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœã€‚æ‰€ä»¥ï¼Œå¦‚æœç”¨åƒç´ å€¼(0-255æ•´æ•°)è¡¨ç¤ºå›¾ç‰‡æ•°æ®ï¼Œé‚£ä¹ˆä¸€å¾‹å°†å…¶ç±»å‹è®¾ç½®æˆuint8ï¼Œé¿å…ä¸å¿…è¦çš„bug ã€‚ 3. topæ–¹æ¡ˆ3.1 1st place solutionç¬¬ä¸€åçš„æ–¹æ¡ˆç”±ç°åœ¨æ’åœ¨æ‰€æœ‰kaggleç”¨æˆ·ç¬¬äº”çš„è¶…çº§å¤§ä½¬Pavel Pleskovè´¡çŒ®ï¼ŒåŸæ–‡è§æ­¤å¤„ã€‚ 3.1.1 æ¨¡å‹ç»“æ„åˆšå¼€å§‹ï¼ŒPavelè®­ç»ƒäº†å¾ˆå¤šåˆ†ç±»æ¨¡å‹ï¼šresnet18, resnet34, resnet50, resnet101, resnet152, resnext50, resnext101, densenet121, densenet201, vgg11, pnasnet, incresnet, polynet, nasnetmobile, senet154, seresnet50, seresnext50, seresnext101ã€‚æ­¤å¤–ï¼Œæ•°æ®é¢„å¤„ç†å°è¯•äº†1ä¸ªå’Œ3ä¸ªé€šé“çš„è¾“å…¥ã€image sizeä»112é€æ¸å¢å¤§åˆ°256ã€‚å¤§çº¦40ä¸ªæ¨¡å‹ä¸­ï¼Œæœ€ä¼˜çš„æ¨¡å‹å¾—åˆ°äº†0.946çš„åˆ†æ•°ï¼Œè¿™ä¸ªå•ä¸€æ¨¡å‹å°±å¯ä»¥æ‹¿åˆ°é‡‘ç‰Œäº†ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§ç±»å‹çš„æ¯”èµ›å¦‚æœå‰æœŸèƒ½èŠ±å¤§é‡æ—¶é—´å°è¯•ä¸åŒçš„æ¨¡å‹ï¼Œé‚£åŸºæœ¬å°±èƒ½ä¿è¯å¥–ç‰Œäº†ï¼Œç”šè‡³é‡‘ç‰Œã€‚ 3.1.2 ensembleä¸ºäº†å°†å¤šä¸ªæ¨¡å‹çš„è¾“å‡ºé›†æˆèµ·æ¥ï¼Œç²—æš´ä¸€ç‚¹å°±æ˜¯ç›´æ¥å°†è¾“å‡ºçš„æ¦‚ç‡å€¼æ±‚å¹³å‡å†å–top3å³å¾—åˆ°æœ€ç»ˆçš„è¾“å‡º(ä¹Ÿå°±æ˜¯blend)ã€‚æ€æ ·å°†å¤šä¸ªæ¨¡å‹çš„ç»“æœensembleåœ¨ä¸€èµ·å‘¢ï¼Ÿå› ä¸ºä¸€å…±340ç±»ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªæ¨¡å‹å¯¹æ¯ä¸ªæ ·æœ¬éƒ½ä¼šè¾“å‡º340ä¸ªæ¦‚ç‡å€¼ï¼Œå¦‚æœå°†æ¯ä¸ªæ¦‚ç‡å€¼ä½œä¸ºensembleçš„featureï¼Œå‡è®¾ä¸€å…±æœ‰8ä¸ªæ¨¡å‹ï¼Œé‚£ä¹ˆä¸€ä¸ªæ ·æœ¬å°±æœ‰340x8ä¸ªfeatureï¼Œè¿™ä¸ªç‰¹å¾ç»´åº¦æœ‰ç‚¹å¤§äº†è€Œä¸”å…¶ä¸­å¾ˆå¤šéƒ½æ˜¯æ¥è¿‘0çš„å€¼ã€‚ Pavelçš„æ€è·¯æ˜¯: for each sample and for each model you collect top 10 probabilities with the labels, then convert them into 10 samples with the binary outcome - whether this is a correct label or not (9 negative examples + 1 positive). Itâ€™s easy to feed such a dataset to any booster because the number of features will be small (equal to the number of models). å¤§æ¦‚æ„æ€æ˜¯å°†ensembleè½¬æ¢æˆä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜: æ ¹æ®8(æ¨¡å‹æ•°)ä¸ªæ¦‚ç‡å€¼åˆ¤æ–­æ˜¯ä¸æ˜¯label(ä¾‹å¦‚è¿™8ä¸ªæ¦‚ç‡å€¼éƒ½å¤§äº0.8ï¼Œé‚£ä¹ˆå‡ ä¹å¯ä»¥è‚¯å®šè¿™å°±æ˜¯label)ã€‚è¯¦ç»†æ¥è®²ï¼ŒLGBMçš„ç‰¹å¾ç»´åº¦ç­‰äºæ¨¡å‹æ•°(æ¯ä¸ªç‰¹å¾å°±ä»£è¡¨ä¸€ä¸ªæ¨¡å‹çš„è¾“å‡ºæ¦‚ç‡)ï¼Œè€Œæ ·æœ¬æ•°å°†ä¼šæ˜¯åŸå§‹æ ·æœ¬æ•°çš„10å€ã€‚21st place solutionä¹Ÿç”¨åˆ°äº†è¿™ä¸ªæ–¹æ³•ï¼Œæ¯”ç›´æ¥å¹³å‡å¾—åˆ°çš„åˆ†æ•°è¦é«˜ã€‚ ä½†æ˜¯æˆ‘æœ‰ä¸€ç‚¹ä¸æ˜ç™½çš„æ˜¯å¦‚ä½•æ‰¾è¿™ä¸ªtop10ï¼Œå› ä¸ºå¯¹äºmode1å®ƒçš„è¾“å‡ºæ¦‚ç‡å€¼top10å¯èƒ½æ˜¯class0-9ï¼Œå¯¹äºmodel2å®ƒçš„è¾“å‡ºæ¦‚ç‡å€¼top10å¯èƒ½æ˜¯class1-10ï¼Œè¿™æ ·å°±å¯¹åº”ä¸ä¸Šäº†ã€‚ä½†æ˜¯æˆ‘å€’æ˜¯æœ‰ä¸€ä¸ªæ€è·¯é‚£å°±æ˜¯å…ˆå¯¹8ä¸ªæ¨¡å‹çš„è¾“å‡ºæ¦‚ç‡æ±‚ä¸ªå¹³å‡å†å–top10(21st place solutionè²Œä¼¼ä½¿ç”¨çš„æœ€å¥½çš„modelæ¥é¢„æµ‹å‡ºtop10)ã€‚ä¾‹å¦‚8ä¸ªæ¨¡å‹å¯¹äºæŸå¼ æ¶‚é¸¦å›¾ç‰‡çš„å¹³å‡è¾“å‡ºæ¦‚ç‡top10æ˜¯O1ã€O2â€¦O10ï¼Œé‚£ä¹ˆè¿™å°±èƒ½äº§ç”Ÿ10ä¸ªLGBMçš„è¾“å…¥æ ·æœ¬ï¼Œä¼šå¾—åˆ°10ä¸ªè¾“å‡º(æ˜¯0-1çš„æ¦‚ç‡å€¼)ï¼Œå–æœ€å¤§çš„ä¸‰ä¸ªå³æœ€ç»ˆè¿™ä¸ªæ¶‚é¸¦æ ·æœ¬çš„ç»“æœã€‚ 3.1.3 Predictions balancing trickHeng CherKengå‘ç°ï¼Œæµ‹è¯•é›†ä¸­çš„groundtruthåˆ†å¸ƒåº”è¯¥æ˜¯å‡åŒ€çš„ï¼Œè€Œä¸”å‘ç° (112199+1)/340=330 (è®­ç»ƒé›†æ ·æœ¬æ•°åŠ 1é™¤ä»¥ç±»åˆ«æ•°å¾—330)ã€‚è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œé€šè¿‡å¯¹æ¨¡å‹è¾“å‡ºçš„æ¦‚ç‡æŒ‰ç…§æ­¤è§„å¾‹è¿›è¡Œåå¤„ç†ï¼Œå¹³å‡ç»™æ¯ä¸ªæ¨¡å‹å¸¦æ¥äº†0.7%çš„æå‡ã€‚é‚£ä¹ˆå¦‚ä½•è¿›è¡Œåå¤„ç†å‘¢? Pavelç»™å‡ºçš„ç®—æ³•æ˜¯ï¼šå¯¹äºå½“å‰æœ€å¤šçš„é¢„æµ‹ç±»åˆ«,å°†æ‰€æœ‰è¿™ä¸ªç±»åˆ«å¯¹åº”çš„æ¦‚ç‡ä¸æ–­å‡å»ä¸€ä¸ªå¾ˆå°çš„æ•°ç›´åˆ°è¿™ä¸ªç±»åˆ«ä¸æ˜¯æœ€å¤šçš„ï¼Œé‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´åˆ°é¢„æµ‹ç±»åˆ«å·®ä¸å¤šå‡åŒ€ã€‚Pavelåœ¨ä¹‹å‰çš„æ¯”èµ›ä¹Ÿç”¨åˆ°äº†è¿™ä¸ªç®—æ³•(ä»£ç è§æ­¤å¤„)ï¼Œä»£ç åŸç†å’Œåˆšåˆšè¯´çš„ç•¥æœ‰ä¸åŒï¼Œç®—æ³•æ­¥éª¤å¦‚ä¸‹: å…ˆå¯¹æ¯ä¸€ç§ç±»åˆ«èµ‹ä¸€ä¸ªåˆå§‹ä¸º1çš„ç³»æ•°coefficientsï¼Œå½“å‰é¢„æµ‹æ¦‚ç‡ç­‰äºå®é™…æ¦‚ç‡ä¹˜ä»¥å¯¹åº”çš„ç³»æ•°ï¼› è®¡ç®—æ¯ç§ç±»åˆ«çš„æ•°ç›®ï¼ŒæŒ‰ç…§è¿™ä¸ªæ•°ç›®å†è®¡ç®—ä¸€ä¸ªscoreï¼Œé€»è¾‘æ˜¯é¢„æµ‹è¶Šå‡åŒ€scoreå°±è¶Šå¤§; å¯¹æœ€å¤šçš„ç±»åˆ«labelï¼Œæ‰§è¡Œcoefficients[label] -= alphaï¼› è‹¥è¿˜æ²¡è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œå°±ç»§ç»­æ‰§è¡Œ2ã€3ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­è®°å½•æœ€å¤§çš„scoreå¯¹åº”çš„coefficientsï¼Œè¿­ä»£å®Œæˆåè¿”å›è¿™ä¸ªcoefficientsã€‚ ä¸Šè¿°çš„scoreè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹:12345678def _compute_score_with_coefficients(predicts, coefficients): _, counter = _get_labels_distribution(predicts, coefficients) # è®¡ç®—æ¯ç§ç±»åˆ«çš„æ•°ç›® # æŒ‰ç…§ä¸‹é¢çš„è®¡ç®—è¿‡ç¨‹ï¼Œå½“é¢„æµ‹æ˜¯å‡åŒ€çš„æ—¶ï¼Œscoreè¾¾åˆ°æœ€å¤§340 score = 0. for label in range(NCATS): # NCATS=340 score += min(NCATS * float(counter[label]) / len(predicts), 1.0) return score Pavel Ostyakovå†™çš„æ­¤ç®—æ³•çš„pytorchç‰ˆè§æ­¤å¤„ã€‚ 3.2 5th place solution3.2.1 æ€»ä½“æµç¨‹ç¬¬äº”åçš„æ–¹æ¡ˆç”±Artur Ispiriantså’ŒMykhailo Matviivè´¡çŒ®ï¼ŒåŸæ–‡è§æ­¤å¤„ã€‚ Artur Ispiriantså…ˆå°†æ¯ä¸ªæ ·æœ¬ä»CSVæ–‡ä»¶æå–å‡ºæ¥ï¼Œæ¯ä¸ªæ ·æœ¬ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å­˜æ”¾ï¼Œè¿™å ç”¨äº†å¤§çº¦400Gçš„SSDï¼Œæ¯”è¾ƒè€—ç©ºé—´ï¼Œä½†æ˜¯æ–¹ä¾¿åç»­å„ç§æ¨¡å‹çš„ä½¿ç”¨ã€‚ Arturä¸€å…±è®­ç»ƒäº†ä¸‰ä¸ªæ¨¡å‹: Se-Resnext50 DPN-92 Se-Resnext101 æ¯ä¸ªæ¨¡å‹éƒ½ä½¿ç”¨äº†åœ¨ImageNetä¸Šé¢„è®­ç»ƒçš„æƒé‡ã€‚å›¾ç‰‡å°ºå¯¸ä½¿ç”¨äº†128ã€192ã€224ã€256ï¼Œå®éªŒæ˜¾ç¤ºå›¾ç‰‡å°ºå¯¸è¶Šå¤§åˆ†æ•°å°±è¶Šé«˜ï¼Œä½†æ˜¯ç”±äºæ˜¾å­˜é™åˆ¶ï¼Œå°ºå¯¸è¶Šå¤§å°±è¶Šéš¾è®­ç»ƒäº†ã€‚ä½¿ç”¨128çš„å°ºå¯¸å°±èƒ½è¾¾åˆ°0.944çš„LBã€‚ åæ¥Artur Ispiriants mergeäº†é˜Ÿå‹Mykhailo Matviivï¼ŒLBè¾¾åˆ°äº†çº¦0.948ï¼Œåæ¥åˆä½¿ç”¨äº†å®Œæ•´æ•°æ®é›†é‡Œçš„æ—¶é—´ä¿¡æ¯: å»¶è¿Ÿæ—¶é—´ æ¯ä¸€ç¬”çš„æ—¶é—´ ç¬”ç”»æ•°é‡ ä¸Šè¿°ä¸‰ä¸ªæ•°æ®éƒ½è¢«scaleåˆ°0-255ã€‚ä½¿ç”¨äº†è¿™ä¸‰ä¸ªä¿¡æ¯åï¼ŒLBæå‡åˆ°äº†0.951ã€‚ 3.2.2 è®­ç»ƒæµç¨‹ç”±äºæ•°æ®é›†å·¨å¤§ï¼Œæ‰€ä»¥è®­ç»ƒä¸€ä¸ªepochå°±éœ€è¦å¾ˆé•¿çš„æ—¶é—´ï¼Œæ‰€ä»¥è¦ç»å¸¸ä¿å­˜æ¨¡å‹ï¼Œå¤§çº¦4-6ä¸ªå°æ—¶ä¿å­˜ä¸€ä¸‹checkpointã€‚ä¸‹é¢æ˜¯Mykhailo Matviivè®­ç»ƒSE-ResNext101çš„æµç¨‹ï¼š å›¾ç‰‡å°ºå¯¸å–128x128è®­ç»ƒç½‘ç»œç›´åˆ°æ”¶æ•›ï¼Œè¿™å¤§æ¦‚éœ€è¦20ä¸ªcheckpointï¼Œèƒ½è¾¾åˆ°0.945. ä¸Šä¸€æ­¥å¾—ä¸åˆ°æå‡æ—¶ï¼Œä½¿ç”¨2.2.2èŠ‚çš„æ¢¯åº¦ç´¯ç§¯æŠ€æœ¯ä½¿batch sizeè¾¾åˆ°çº¦3-4kï¼Œç»§ç»­è®­ç»ƒï¼Œæ¨¡å‹è¿›ä¸€æ­¥æå‡ï¼› æ›´è¿›ä¸€æ­¥çš„æå‡å°±æ˜¯åœ¨æ›´å¤§çš„å›¾ç‰‡å°ºå¯¸(192ç„¶å256)è¿›è¡Œfine tuneã€‚ 3.2.3 trickæ¯”èµ›ä½¿ç”¨çš„ä¸€äº›trickå¦‚ä¸‹ï¼š ç»å¸¸ä¿å­˜checkpointå¸¦æ¥çš„ä¸€ä¸ªæå‡å°±æ˜¯snapshot ensemblingï¼Œå³ä¸€ä¸ªæ¨¡å‹æœ€ç»ˆçš„é¢„æµ‹è¾“å‡ºæ˜¯è¿™ä¸ªæ¨¡å‹çš„å‡ ä¸ªcheckpointçš„ç»¼åˆã€‚æœ€åçš„è¾“å‡ºæ˜¯å¤šä¸ªæ¨¡å‹çš„å¹³å‡blendã€‚ ä¼ªæ ‡ç­¾ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯æ¯”èµ›æœ€åé˜¶æ®µçš„ä¸»è¦æåˆ†ç‚¹ã€‚æ­¤æ—¶blendæ¨¡å‹çš„åˆ†æ•°ä¸º0.951ï¼Œä½¿ç”¨è¿™ä¸ªè¾“å‡ºç»™æµ‹è¯•é›†åŠ ä¸Šäº†labelï¼ˆé¢„æµ‹çš„top1ï¼‰ï¼Œç„¶å(åª)ç”¨è¿™äº›å¸¦labelçš„æµ‹è¯•é›†fine tuneæ‰€æœ‰æ¨¡å‹10ä¸ªepochï¼ŒæŒ‘é€‰3ä¸ªæœ€ä½³çš„epoch blendå¾—åˆ°äº†0.952çš„LBã€‚ç„¶åå†ç”¨æ–°çš„è¾“å‡ºç»™æµ‹è¯•é›†åŠ ä¸Šlabelï¼Œå†fine tuneï¼Œåˆ†æ•°å°±è¾¾åˆ°äº†0.953ï¼Œç„¶åç”±äºç§ç§åŸå› æ²¡å†è¿›è¡Œäº†(ä½œè€…è¯´å†è¿›è¡Œå¯èƒ½ä¼šè¿›ä¸€æ­¥æå‡)ã€‚æˆ‘è®¤ä¸ºè¿™ä¸ªæ–¹æ³•è¦é¿å…è¿‡æ‹Ÿåˆï¼Œä½œè€…ä¹Ÿè¯´äº†è¦è°¨æ…ä½¿ç”¨ï¼Œå¯ä»¥è€ƒè™‘å°†å¸¦ä¼ªæ ‡ç­¾çš„æµ‹è¯•é›†æ··åˆåœ¨è®­ç»ƒé›†è¿›è¡Œè®­ç»ƒä»¥å‡å°‘è¿‡æ‹Ÿåˆçš„é£é™©ã€‚ 3.3 å…¶ä»–3.3.1 RNNæ¨¡å‹å•æ¨¡å‹0.941çš„RNNæ¨¡å‹: 1d CNN+LSTM 3.3.2 11th place solutionèµ„æºæœ‰é™çš„æƒ…å†µä¸‹è¾¾åˆ°ç¬¬11åçš„æ–¹æ¡ˆã€‚ 3.3.3 21st place solutionä¹Ÿä½¿ç”¨äº†3.1.2æ‰€ç¤ºçš„ensembleæ–¹æ³•ï¼Œè¯„è®ºå¤„æœ‰å…·ä½“çš„ensembleæ–¹æ³•ã€‚ 3.3.4 24th place solution24th solution, ç”¨çš„kerasï¼Œå¹¶ç”¨äº†keraså°è£…å¥½çš„æ¢¯åº¦ç´¯ç§¯trick 3.3.5 10 lessons46thçš„å›¢é˜Ÿåœ¨è¿™é‡Œç»™å‡ºäº†å‚åŠ è¿™ä¸ªæ¯”èµ›å¾—å‡ºçš„10æ¡æ•™è®­ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ã€‚ 4. æ€»ç»“ æ¯”èµ›å‰æœŸåº”è¯¥å¤šå¤šå°è¯•ä¸åŒçš„ç½‘ç»œç»“æ„ï¼› è¿™ç§è¶…å¤§æ•°æ®é›†çš„å›¾åƒç±»æ¯”èµ›ï¼Œä¸€èˆ¬æ¥è®²å°±æ˜¯ç½‘ç»œè¶Šæ·±ã€å›¾ç‰‡å°ºå¯¸è¶Šå¤§ã€batchsizeè¶Šå¤§ï¼Œæ•ˆæœå°±è¶Šå¥½ï¼› æ³¨æ„ç§¯ç´¯ä¸€äº›trickï¼Œä¾‹å¦‚æ¢¯åº¦ç´¯ç§¯ã€ä¼ªæ ‡ç­¾ã€Predictions balancingç­‰ç­‰ï¼› ç”±äºè®­ç»ƒä¸€ä¸ªepochæ—¶é—´æ¼«é•¿ï¼Œæ‰€ä»¥æ¯éš”å‡ ä¸ªå°æ—¶å°±ä¿å­˜ä¸€ä¸‹æ¨¡å‹æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œä¸€ä¸ªæ¨¡å‹çš„é¢„æµ‹è¾“å‡ºåº”è¯¥æ˜¯è¯¥æ¨¡å‹å‡ ä¸ªcheckpointçš„è¾“å‡ºçš„èåˆï¼› å¤šé€›é€›è®¨è®ºåŒºã€‚","categories":[{"name":"Competitions","slug":"Competitions","permalink":"https://tangshusen.me/categories/Competitions/"}],"tags":[{"name":"kaggle,classification","slug":"kaggle-classification","permalink":"https://tangshusen.me/tags/kaggle-classification/"}]},{"title":"Longest Palindromic Substring(æœ€é•¿å›æ–‡å­ä¸²)","slug":"Longest-Palindromic-Substring","date":"2018-12-01T14:23:15.000Z","updated":"2018-12-30T09:14:45.273Z","comments":true,"path":"2018/12/01/Longest-Palindromic-Substring/","link":"","permalink":"https://tangshusen.me/2018/12/01/Longest-Palindromic-Substring/","excerpt":"1. é—®é¢˜æè¿°Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œæ‰¾å‡ºsä¸­çš„æœ€é•¿å›æ–‡å­ä¸²ã€‚sçš„é•¿åº¦ä¸è¶…è¿‡1000.","text":"1. é—®é¢˜æè¿°Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œæ‰¾å‡ºsä¸­çš„æœ€é•¿å›æ–‡å­ä¸²ã€‚sçš„é•¿åº¦ä¸è¶…è¿‡1000. Example 1: Input: â€œbabadâ€Output: â€œbabâ€Note: â€œabaâ€ is also a valid answer. Example 2: Input: â€œcbbdâ€Output: â€œbbâ€ 2. é¢˜è§£2.1 æš´åŠ›æ³•2.1.1 æ€è·¯æš´åŠ›ç©·ä¸¾æ‰€æœ‰å­å­—ç¬¦ä¸²çš„å¯èƒ½ï¼Œç„¶åä¾æ¬¡æŒ‰ä½åˆ¤æ–­å…¶æ˜¯å¦æ˜¯å›æ–‡ã€‚è™½ç„¶å…¶æ—¶é—´å¤æ‚åº¦å¾ˆé«˜ï¼Œä½†å®ƒå¯¹ç©ºé—´çš„è¦æ±‚å¾ˆä½ã€‚ 2.1.2 å¤æ‚åº¦ç©ºé—´å¤æ‚åº¦æ˜¾ç„¶ä¸º $O(1)$ ï¼›ç©·ä¸¾æ‰€æœ‰å­—ç¬¦ä¸²å¤æ‚åº¦ä¸º $O(n^2)$ ï¼Œå†åŠ ä¸Šåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡çš„ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚ 2.1.3 ä»£ç ä»£ç å°±ä¸ç»™äº†ï¼Œç»™äº†ä½ ä¹Ÿä¸ä¼šçœ‹ğŸ˜€ 2.2 åŠ¨æ€è§„åˆ’2.2.1 æ€è·¯æˆ‘ä»¬çŸ¥é“ï¼Œå½“æŸä¸ªå­—ç¬¦ä¸²æ˜¯å›æ–‡çš„æ—¶å€™ï¼Œåœ¨å®ƒä¸¤è¾¹åŒæ—¶å¢åŠ ä¸€ä¸ªç›¸åŒå­—ç¬¦åè‚¯å®šä¾ç„¶æ˜¯å›æ–‡çš„ï¼Œä¾‹å¦‚ bccb -&gt; abccbaã€‚åŸºäºè¿™ä¸ªç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†æš´åŠ›æ³•ä¸­çš„åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡è¿™ä¸€æ­¥ç”¨åŠ¨æ€è§„åˆ’è§£å†³ã€‚ å…·ä½“çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ‰€æœ‰é•¿åº¦ä¸º1çš„å­å­—ç¬¦ä¸²è®¡ç®—å‡ºæ¥ï¼Œè¿™äº›å¿…å®šæ˜¯å›æ–‡çš„ï¼›ç„¶åè®¡ç®—å‡ºæ‰€æœ‰é•¿åº¦ä¸º2çš„å­å­—ç¬¦ä¸²å¹¶åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡ã€‚åˆ°é•¿åº¦ä¸º3çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸Šæ¬¡çš„è®¡ç®—ç»“æœï¼šå¦‚æœä¸­å¿ƒå¯¹ç§°çš„çŸ­å­—ç¬¦ä¸²ä¸æ˜¯å›æ–‡ï¼Œé‚£é•¿å­—ç¬¦ä¸²ä¹Ÿä¸æ˜¯ï¼Œå¦‚æœçŸ­å­—ç¬¦ä¸²æ˜¯å›æ–‡ï¼Œé‚£å°±è¦çœ‹é•¿å­—ç¬¦ä¸²ä¸¤å¤´æ˜¯å¦ä¸€æ ·ã€‚è¿™æ ·ï¼Œä¸€ç›´åˆ°é•¿åº¦æœ€å¤§çš„å­å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°±æŠŠæ•´ä¸ªå­—ç¬¦ä¸²é›†ç©·ä¸¾å®Œäº†ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç”¨ä¸€ä¸ª n x n çš„äºŒç»´boolå‹æ•°ç»„isOKè®°å½•æ˜¯å¦ä¼šå›æ–‡ï¼Œå…¶ä¸­næ˜¯å­—ç¬¦ä¸²sçš„é•¿åº¦ï¼ŒisOK[i][j] == trueå°±è¡¨ç¤ºå­ä¸²s[i...j]æ˜¯å›æ–‡çš„ã€‚ 2.2.2 å¤æ‚åº¦ç”±äºè¦ç”³è¯·ä¸€ä¸ªäºŒç»´æ•°ç»„isOK, æ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸º $O(n^2)$ ;ç”±äºä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œæ—¶é—´å¤æ‚åº¦ä»æš´åŠ›æ³•çš„ $O(n^3)$ å‡å°‘åˆ° $O(n^2)$ã€‚å®æµ‹: Runtime: 244 ms, faster than 14.67% of C++ online submissions for Longest Palindromic Substring. 2.2.3 ä»£ç 123456789101112131415161718192021class Solution &#123;public: string longestPalindrome(string s) &#123; if(!s.size()) return \"\"; vector&lt;vector&lt;bool&gt;&gt;isOK(s.size(), vector&lt;bool&gt;(s.size(), false)); string res = \"\"; for(int len = 1; len &lt;= s.size(); len++)&#123; // lenä»£è¡¨å­ä¸²é•¿åº¦ for(int start = 0; start + len &lt;= s.size(); start++)&#123; // startä»£è¡¨å­ä¸²èµ·å§‹ä½ç½® if(len == 1) isOK[start][start] = true; else if(len == 2) isOK[start][start + 1] = (s[start] == s[start + 1]); else isOK[start][start + len - 1] = isOK[start + 1][start + len - 2] \\ &amp;&amp; s[start] == s[start + len - 1]; // æ›´æ–°ç»“æœ if(isOK[start][start + len - 1] &amp;&amp; len &gt; res.size()) res = s.substr(start, len); &#125; &#125; return res; &#125;&#125;; 2.3 ä¸­å¿ƒæ‰©æ•£æ³•2.3.1 æ€è·¯ä¸Šé¢è®²çš„åŠ¨æ€è§„åˆ’è™½ç„¶ä¼˜åŒ–äº†æ—¶é—´ï¼Œä½†ä¹Ÿæµªè´¹äº†å¾ˆå¤šç©ºé—´ã€‚å®é™…ä¸Šæˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸€ç›´å­˜å‚¨æ‰€æœ‰å­å­—ç¬¦ä¸²çš„å›æ–‡æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„åªæ˜¯ä¸­å¿ƒå¯¹ç§°çš„è¾ƒå°ä¸€å±‚æ˜¯å¦æ˜¯å›æ–‡ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬ä»å°åˆ°å¤§è¿ç»­ä»¥æŸç‚¹ä¸ºä¸ªä¸­å¿ƒçš„æ‰€æœ‰å­å­—ç¬¦ä¸²è¿›è¡Œè®¡ç®—ï¼Œå°±èƒ½çœç•¥è¿™ä¸ªç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºä¸­å¿ƒå¯¹ç§°æœ‰ä¸¤ç§æƒ…å†µ: é•¿åº¦ä¸ºå¥‡æ•°ï¼Œåˆ™ä»¥ä¸­å¿ƒå­—æ¯å¯¹ç§°ï¼› é•¿åº¦ä¸ºå¶æ•°ï¼Œåˆ™ä»¥ä¸¤ä¸ªå­—æ¯ä¸­é—´ä¸ºå¯¹ç§°ã€‚ æ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è®¡ç®—è¿™ä¸¤ç§å¯¹ç§°æƒ…å†µã€‚ 2.3.2 å¤æ‚åº¦ç›¸è¾ƒäº2.2çš„åŠ¨æ€è§„åˆ’ï¼Œç©ºé—´å¤æ‚åº¦ç¼©å°ä¸º $O(1)$ï¼›æ—¶é—´å¤æ‚åº¦ä¸€æ ·ï¼Œéƒ½æ˜¯ $O(n^2)$ã€‚å®æµ‹: Runtime: 20 ms, faster than 57.88% of C++ online submissions for Longest Palindromic Substring. 2.3.3 ä»£ç 1234567891011121314151617181920212223class Solution &#123;public: string longestPalindrome(string s) &#123; if(!s.size()) return \"\"; string res = s.substr(0, 1); for(int mid = 0; mid &lt; s.size(); mid++)&#123; // midä¸ºä¸­å¿ƒå­—æ¯æˆ–è€…å¯¹ç§°è½´çš„å‰ä¸€ä¸ªå­—æ¯çš„ä¸‹æ ‡ // midä¸ºä¸­å¿ƒå­—æ¯ä¸‹æ ‡ï¼Œå³å­ä¸²é•¿åº¦ä¸ºå¥‡æ•° for(int half_len = 1; mid + half_len &lt; s.size() &amp;&amp; mid - half_len &gt;= 0; half_len++)&#123; if(s[mid + half_len] != s[mid - half_len]) break; if(2 * half_len + 1 &gt; res.size()) res = s.substr(mid - half_len, 2*half_len + 1); &#125; // midä¸ºå¯¹ç§°è½´çš„å‰ä¸€ä¸ªå­—æ¯ï¼Œå³å­ä¸²é•¿åº¦ä¸ºå¶æ•° for(int half_len = 1; mid + half_len &lt; s.size() &amp;&amp; mid - half_len &gt;= -1; half_len++)&#123; if(s[mid + half_len] != s[mid - half_len + 1]) break; if(2 * half_len &gt; res.size()) res = s.substr(mid - half_len + 1, 2 * half_len); &#125; &#125; return res; &#125;&#125;; 2.4 é©¬æ‹‰è½¦(Manacher)ç®—æ³•ä¸‹é¢è¦å‡ºåœºçš„å°±æ˜¯å¤§åé¼é¼çš„é©¬æ‹‰è½¦ç®—æ³•äº†ï¼Œå‰é¢ä»‹ç»çš„ç®—æ³•æœ€å¿«ä¹Ÿä¸è¿‡ $O(n^2)$ çš„æ—¶é—´å¤æ‚åº¦ï¼Œè€Œé©¬æ‹‰è½¦çš„æ—¶é—´å¤æ‚åº¦ä¸ºé€†å¤©çš„ $O(n)$ ğŸ˜¨ï¼Œæ˜¯æ­¤é¢˜æœ€ç†æƒ³çš„å¤æ‚åº¦äº†ã€‚ æœ¬èŠ‚ä¸»è¦å‚è€ƒLeetCodeå¯¹æ­¤ç®—æ³•çš„è¯¦ç»†è§£é‡Šã€‚ 2.4.1 æ€è·¯é¦–å…ˆï¼Œä¸ºäº†é¿å…2.3é‚£æ ·å°†å­ä¸²åˆ†ä¸ºé•¿åº¦ä¸ºå¥‡æ•°å’Œå¶æ•°ä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬å…ˆå°†å­—ç¬¦ä¸²ç®€å•å¤„ç†ä¸€ä¸‹, åœ¨sä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸¤è¾¹æ’å…¥ä¸€ä¸ªå­—ç¬¦â€œ#â€å¾—åˆ°å­—ç¬¦ä¸²(åœ¨å…·ä½“å®ç°ä¸­ï¼Œä¸ºäº†é¿å…è¶Šç•Œæ£€æŸ¥ï¼Œé€šå¸¸è¿˜ä¼šåœ¨é¦–å°¾é¢å¤–æ’å…¥ä¸¤ä¸ªä¸æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦éƒ½ä¸åŒçš„å­—ç¬¦å¦‚^ã€$),ä¾‹å¦‚ï¼š s = abaaba â€”æ’å…¥å­—ç¬¦â€“&gt; T = #a#b#a#a#b#a# ä¸ºäº†æ‰¾åˆ°æœ€é•¿çš„å›æ–‡å­ä¸²ï¼Œæˆ‘ä»¬å…ˆè®¡ç®—å‡ºä»¥æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²ï¼Œç„¶åæ¯”è¾ƒä¹‹åæ‰¾å‡ºæœ€é•¿çš„ã€‚æˆ‘ä»¬ä½¿ç”¨æ•°ç»„Pæ¥ä¿å­˜ä»¥Tä¸­æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²çš„åŠå¾„(æ—¢é•¿åº¦çš„ä¸€åŠ)ã€‚ç´§æ¥ç€ä¸Šé¢çš„ä¾‹å­: T : # a # b # a # a # b # a #P : 0 1 0 3 0 1 6 1 0 3 0 1 0 é€šè¿‡æ•°ç»„Pï¼Œæ‰¾åˆ°å…¶ä¸­æœ€å¤§çš„æ•°å­—6ï¼Œæˆ‘ä»¬å¯ä»¥é©¬ä¸Šå¾—å‡ºæœ€é•¿çš„å›æ–‡å­—ç¬¦ä¸²å°±æ˜¯sæœ¬èº«abaabaï¼Œå³é—®é¢˜è½¬æ¢ä¸ºå¦‚ä½•é«˜æ•ˆåœ°æ±‚è§£æ•°ç»„Pã€‚ æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ä¸Šé¢è¿™ä¸ªç‰¹æ®Šçš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸ä»…Tæ˜¯å¯¹ç§°çš„ï¼Œå°±è¿Péƒ½æ˜¯å¯¹ç§°çš„ï¼Œç”±äºæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®¡ç®—å‡ºPçš„æ‰€æœ‰å…ƒç´ å€¼ï¼Œé‚£ä¹ˆå¦‚æœPæ˜¯å¯¹ç§°çš„ï¼Œå²‚ä¸æ˜¯å¯ä»¥å¤§å¤§å‡å°‘è®¡ç®—é‡ï¼é©¬æ‹‰è½¦ç®—æ³•å°±æ˜¯åŸºäºè¿™æ ·ä¸€ä¸ªæƒ³æ³•å±•å¼€çš„ã€‚ ä¸ºäº†è¯¦ç»†ä»‹ç»é©¬æ‹‰è½¦ç®—æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­s = babcbabcbaccba: å¦‚ä¸Šå›¾æ‰€ç¤º,å‡è®¾å·²ç»å®Œæˆäº†Pæ•°ç»„çš„éƒ¨åˆ†æ•°å€¼çš„è®¡ç®—ï¼Œå½“å‰éœ€è¦è®¡ç®—çš„æ˜¯P[i]ã€‚æˆ‘ä»¬å¼•å…¥å˜é‡ Rï¼Œè¡¨ç¤ºå½“å‰è®¿é—®åˆ°çš„æ‰€æœ‰å›æ–‡å­ä¸²ä¸­æ‰€èƒ½è§¦åŠçš„æœ€å³ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®ã€‚å¦å¤–è¿˜è¦è®°å½•ä¸‹Rå¯¹åº”çš„å›æ–‡ä¸²çš„å¯¹ç§°è½´æ‰€åœ¨çš„ä½ç½®ï¼Œè®°ä¸ºCã€‚å¦å¤–ä¹Ÿå¯æ¨æ–­å‡ºè¯¥å›æ–‡ä¸²çš„å·¦è¾¹ä½ç½®Lã€‚å›¾ä¸­çš„å®çº¿å³è¡¨ç¤ºCï¼Œä¸¤æ¡è™šçº¿(Lå’ŒR)åˆ†åˆ«è¡¨ç¤ºä»¥Cä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„è¾¹ç•Œã€‚ç°åœ¨éœ€è¦è®¡ç®—çš„æ˜¯ P[i] çš„å€¼ï¼Œå›¾ä¸­ iâ€™ è¡¨ç¤ºçš„æ˜¯ i å…³äº C å¯¹ç§°çš„ç‚¹ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆé«˜æ•ˆåœ°ç®—å‡ºP[i]ã€‚ å½“å‰ i çš„å€¼æ˜¯ 13ï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°P[13]çš„å€¼ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹ä¸‹ i å…³äº Cå¯¹ç§°çš„ i&#39; = 9çš„å€¼ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸¤æ¡ç»¿è‰²å®çº¿è¦†ç›–çš„åŒºåŸŸåˆ†è¡¨è¡¨ç¤ºçš„æ˜¯ ä»¥ iâ€™ å’Œ i ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“äº† P[i&#39;] = 1, é‚£ä¹ˆç”±äºå›æ–‡å­ä¸²çš„å¯¹ç§°æ€§(å³ä¸Šå›¾L~Cå’ŒC~Rå¯¹åº”çš„å­ä¸²æ˜¯å…³äºCå¯¹ç§°çš„)ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡º P[i] = p[i&#39;] = 1ã€‚å®é™…ä¸Šï¼ŒCä¹‹åçš„ä¸‰ä¸ªå…ƒç´ éƒ½éµå¾ªäº†è¿™ç§å¯¹ç§°æ€§ï¼ˆæ—¢ P[12] = P[10] = 0, P[13] = P[9] =1, P[14] = P[8] = 0)ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç°åœ¨æˆ‘ä»¬åˆ°äº† i = 15 è¿™ä¸ªç‚¹ï¼Œi å…³äº Cå¯¹ç§°çš„ç‚¹æ˜¯ i&#39; = 7, é‚£ä¹ˆè¿™é‡Œ P[15] = P[7] = 7 è¿˜ä¼šä¸ä¼šæˆç«‹å‘¢ï¼Ÿ å¾ˆæ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ï¼Œæˆ‘ä»¬å‡­è‚‰çœ¼è§‚å¯Ÿå¯çŸ¥ p[15] = 5 è€Œ P[7] = 7ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ä¸Šå›¾ä¸­ï¼Œç»¿è‰²å®çº¿è¡¨ç¤ºçš„æ˜¯ä»¥Cä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²æ‰€è¦†ç›–çš„åŒºåŸŸï¼Œçº¢è‰²å®çº¿è¡¨ç¤ºçš„æ˜¯ä¸ç»¿è‰²åŒºåŸŸä¸åŒ¹é…çš„éƒ¨åˆ†ï¼Œå·¦è¾¹çš„çº¢è‰²å®çº¿æ˜¯ä»¥T[i&#39;]ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²æ‰€è¦†ç›–åŒºåŸŸè¶…å‡ºç»¿è‰²å®çº¿çš„éƒ¨åˆ†ã€‚å³è¾¹çš„çº¢è‰²å®çº¿æ˜¯ä»¥T[i]ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²æ‰€è¦†ç›–åŒºåŸŸè¶…å‡ºç»¿è‰²å®çº¿çš„éƒ¨åˆ†ã€‚è€Œç»¿è‰²çš„è™šçº¿éƒ¨åˆ†åˆ™æ˜¯åˆ†åˆ«ä»¥T[i]å’ŒT[i&#39;]ä¸ºä¸­å¿ƒæœ€é•¿å›æ–‡å­ä¸²ä¸ç»¿è‰²å®çº¿éƒ¨åˆ†çš„é‡å éƒ¨åˆ†ã€‚ ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥æ˜æ˜¾çš„çœ‹å‡ºè¢«ä¸¤æ¡ç»¿è‰²å®çº¿æ‰€è¦†ç›–çš„åŒºåŸŸä¸­ï¼ŒCä¸¤è¾¹çš„å­ä¸²æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚åŒæ—¶ç»¿è‰²è™šçº¿çš„é‚£éƒ¨åˆ†ä¹Ÿæ˜¯å…³äºä¸­å¿ƒå¯¹ç§°çš„ã€‚å½“ i = 12,13,14 å³ i&#39; = 10,9,8 æ—¶ï¼Œä»¥T[i&#39;]ä¸ºä¸­å¿ƒçš„æœ€å¤§å›æ–‡å­ä¸²å…¨è½åœ¨äº†Lå’ŒRä¹‹é—´ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨LRçš„å¯¹ç§°æ€§ç›´æ¥å¾—å‡ºå…³äºT[i]å¯¹ç§°çš„æœ€å¤§å›æ–‡å­ä¸²ï¼›ä½†å½“ i&#39; = 7 å³ P[i&#39;] = 7ï¼Œæ­¤æ—¶ä»¥T[i&#39;]ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²è¶…å‡ºäº†ä»¥Cä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²çš„å·¦è¾¹ç•Œ(å›¾ä¸­Lå·¦è¾¹çº¢è‰²å®çº¿)ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ­¤æ—¶æ— æ³•å†æŒ‰ç…§å¯¹ç§°æ€§ç›´æ¥å¾—å‡º P[i] çš„å€¼äº†ï¼Œä½†æ˜¯å¯ä»¥æ¨å‡º P[i] &gt;= 5ã€‚ ç°åœ¨æˆ‘ä»¬çŸ¥é“çš„æ˜¯P[i] &gt;= 5, ä¸ºäº†æ‰¾å‡ºP[i]æœ€ç»ˆçš„å€¼ï¼Œæˆ‘ä»¬åªæœ‰ç»§ç»­ä»¥P[i]ä¸ºä¸­å¿ƒå‘ä¸¤è¾¹æ‰©å±•è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­P[21] != P[1],é‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆæ¨æ–­æ˜¯P[i] = 5ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­ï¼Œéƒ½å­˜åœ¨ä¸¤ç§å¯èƒ½: R &gt; iï¼Œä¹Ÿå°±æ˜¯åˆšåˆšæˆ‘ä»¬è®¨è®ºçš„æƒ…å†µï¼Œæ­¤æ—¶åˆç»†åˆ†ä¸ºä¸¤ç§æƒ…å†µ:(1) è‹¥ P[i&#39;] &lt; R â€“ i, åˆ™ä»¤ P[i] = P[i&#39;];(2) å¦åˆ™ï¼Œ å…ˆä»¤P[i] = P[i&#39;]ï¼Œå†ä»¥iä¸ºä¸­å¿ƒæ‰©å±•å›æ–‡ä¸²å¹¶P[i]++ï¼Œç›´åˆ°å·¦å³ä¸¤è¾¹å­—ç¬¦ä¸åŒæˆ–è€…åˆ°è¾¾è¾¹ç•Œã€‚å¹¶æ›´æ–°å˜é‡Rã€Cã€‚ R &lt;= iï¼Œå³iç§»åŠ¨åˆ°Rå³è¾¹äº†ï¼Œæ­¤æ—¶ä¹Ÿåº”è¯¥ä»¥iä¸ºä¸­å¿ƒæ‰©å±•å›æ–‡ä¸²ã€‚ç±»ä¼¼æƒ…å†µ1(2),åªæ˜¯P[i]åˆå§‹ä¸º0ã€‚ 2.4.2 å¤æ‚åº¦ç©ºé—´å¤æ‚åº¦æ˜¾ç„¶æ˜¯O(n).ä¸‹é¢è®¨è®ºä¸€ä¸‹æ—¶é—´å¤æ‚åº¦ï¼Œè™½ç„¶ä»£ç ä¸­å­˜åœ¨ä¸¤ä¸ªå¾ªç¯forå’Œwhileï¼Œä½†æ˜¯éœ€è¦æ³¨æ„æ˜¯ï¼š å½“Rä¸éœ€è¦è¿›è¡Œæ‰©å±•æ—¶ï¼Œä¸ä¼šè¿›å…¥whileå¾ªç¯ï¼› Réœ€è¦è¿›è¡Œæ‰©å±•æ—¶ï¼Œä¼šè¿›å…¥whileå¾ªç¯ï¼Œä½†æ•´ä¸ªç®—æ³•è¿‡ç¨‹whileä¸€å…±å¾ªç¯æœ€å¤šnæ¬¡ï¼Œå³Rä»0ä¸æ–­æ‰©å±•åˆ°nã€‚ ç”±æ­¤å¯è§ï¼Œé©¬æ‹‰è½¦ç®—æ³•æ˜¯çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦ï¼Œå³O(n)ã€‚ äº²æµ‹: Runtime: 8 ms, faster than 88.39% of C++ online submissions for Longest Palindromic Substring. 2.5.1 ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849class Solution &#123;private: // å°†å­—ç¬¦ä¸²Sè½¬æ¢æˆTï¼Œä¾‹å¦‚S = \"abba\", T = \"^#a#b#b#a#$\". // ^ å’Œ $ æ˜¯ä¸ºäº†é¿å…è¶Šç•Œæ£€æŸ¥ string preProcess(string s) &#123; int n = s.size(); if (n == 0) return \"^$\"; string t = \"^\"; for (int i = 0; i &lt; n; i++) t += \"#\" + s.substr(i, 1); t += \"#$\"; return t; &#125; public: string longestPalindrome(string s) &#123; string T = preProcess(s); int n = T.size(); vector&lt;int&gt;P(n); int C = 0, R = 0; for (int i = 1; i &lt; n-1; i++) &#123; int i_mirror = 2 * C - i; // i' = C - (i-C) P[i] = (R &gt; i) ? min(R - i, P[i_mirror]) : 0; // å°è¯•æ‰©å±•ä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸² while (T[i + 1 + P[i]] == T[i - 1 - P[i]]) P[i]++; // å¦‚æœä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„å³è¾¹ç•Œè¶…è¿‡äº†Rï¼Œåˆ™åº”è¯¥æ›´æ–°Rå’ŒC if (i + P[i] &gt; R) &#123; C = i; R = i + P[i]; &#125; &#125; // æ‰¾å‡ºPä¸­æœ€å¤§çš„å…ƒç´  int maxLen = 0; int centerIndex = 0; for (int i = 1; i &lt; n-1; i++) &#123; //æ³¨æ„è·³è¿‡é¦–å°¾ if (P[i] &gt; maxLen) &#123; maxLen = P[i]; centerIndex = i; &#125; &#125; return s.substr((centerIndex - 1 - maxLen)/2, maxLen); // å‡ä¸€æ˜¯å› ä¸ºå»æ‰ç¬¬ä¸€ä¸ªå­—ç¬¦^ &#125;&#125;;","categories":[{"name":"LeetCode","slug":"LeetCode","permalink":"https://tangshusen.me/categories/LeetCode/"}],"tags":[{"name":"åŠ¨æ€è§„åˆ’","slug":"åŠ¨æ€è§„åˆ’","permalink":"https://tangshusen.me/tags/åŠ¨æ€è§„åˆ’/"},{"name":"é©¬æ‹‰è½¦ç®—æ³•","slug":"é©¬æ‹‰è½¦ç®—æ³•","permalink":"https://tangshusen.me/tags/é©¬æ‹‰è½¦ç®—æ³•/"},{"name":"å­—ç¬¦ä¸²","slug":"å­—ç¬¦ä¸²","permalink":"https://tangshusen.me/tags/å­—ç¬¦ä¸²/"}]},{"title":"AdaBoostç®—æ³•è¯¦è§£ä¸pythonå®ç°","slug":"adaboost","date":"2018-11-18T14:05:04.000Z","updated":"2018-12-30T09:14:14.935Z","comments":true,"path":"2018/11/18/adaboost/","link":"","permalink":"https://tangshusen.me/2018/11/18/adaboost/","excerpt":"ç›®å‰ç½‘ä¸Šå¤§å¤šæ•°åšå®¢åªä»‹ç»äº†AdaBoostç®—æ³•æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯é²œæœ‰äººä»‹ç»ä¸ºä»€ä¹ˆAdaboosté•¿è¿™æ ·ï¼Œæœ¬æ–‡å¯¹æ­¤ç»™å‡ºäº†è¯¦ç»†çš„è§£é‡Šã€‚","text":"ç›®å‰ç½‘ä¸Šå¤§å¤šæ•°åšå®¢åªä»‹ç»äº†AdaBoostç®—æ³•æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯é²œæœ‰äººä»‹ç»ä¸ºä»€ä¹ˆAdaboosté•¿è¿™æ ·ï¼Œæœ¬æ–‡å¯¹æ­¤ç»™å‡ºäº†è¯¦ç»†çš„è§£é‡Šã€‚ 1. æ¦‚è¿°1.1 é›†æˆå­¦ä¹ ç›®å‰å­˜åœ¨å„ç§å„æ ·çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œä¾‹å¦‚SVMã€å†³ç­–æ ‘ã€æ„ŸçŸ¥æœºç­‰ç­‰ã€‚ä½†æ˜¯å®é™…åº”ç”¨ä¸­ï¼Œæˆ–è€…è¯´åœ¨æ‰“æ¯”èµ›æ—¶ï¼Œæˆç»©è¾ƒå¥½çš„é˜Ÿä¼å‡ ä¹éƒ½ç”¨äº†é›†æˆå­¦ä¹ (ensemble learning)çš„æ–¹æ³•ã€‚é›†æˆå­¦ä¹ çš„æ€æƒ³ï¼Œç®€å•æ¥è®²ï¼Œå°±æ˜¯â€œä¸‰ä¸ªè‡­çš®åŒ é¡¶ä¸ªè¯¸è‘›äº®â€ã€‚é›†æˆå­¦ä¹ é€šè¿‡ç»“åˆå¤šä¸ªå­¦ä¹ å™¨(ä¾‹å¦‚åŒç§ç®—æ³•ä½†æ˜¯å‚æ•°ä¸åŒï¼Œæˆ–è€…ä¸åŒç®—æ³•)ï¼Œä¸€èˆ¬ä¼šè·å¾—æ¯”ä»»æ„å•ä¸ªå­¦ä¹ å™¨éƒ½è¦å¥½çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨è¿™äº›å­¦ä¹ å™¨éƒ½æ˜¯â€å¼±å­¦ä¹ å™¨â€çš„æ—¶å€™æå‡æ•ˆæœä¼šå¾ˆæ˜æ˜¾ã€‚ å¼±å­¦ä¹ å™¨æŒ‡çš„æ˜¯æ€§èƒ½ä¸å¤ªå¥½çš„å­¦ä¹ å™¨ï¼Œæ¯”å¦‚ä¸€ä¸ªå‡†ç¡®ç‡ç•¥å¾®è¶…è¿‡50%çš„äºŒåˆ†ç±»å™¨ã€‚ ä¸‹é¢çœ‹çœ‹è¥¿ç“œä¹¦å¯¹æ­¤åšçš„ä¸€ä¸ªç®€å•ç†è®ºåˆ†æã€‚è€ƒè™‘ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ $y \\in {-1, +1}$ ã€çœŸå®å‡½æ•° $f$ ä»¥åŠå¥‡æ•° $M$ ä¸ªçŠ¯é”™æ¦‚ç‡ç›¸äº’ç‹¬ç«‹ä¸”å‡ä¸º $\\epsilon $ çš„ä¸ªä½“å­¦ä¹ å™¨(æˆ–è€…ç§°åŸºå­¦ä¹ å™¨) $h_i$ ã€‚æˆ‘ä»¬ç”¨ç®€å•çš„æŠ•ç¥¨è¿›è¡Œé›†æˆå­¦ä¹ ï¼Œå³åˆ†ç±»ç»“æœå–åŠæ•°ä»¥ä¸Šçš„åŸºå­¦ä¹ å™¨çš„ç»“æœ:$$H(x) = sign(\\sum_{i=1}^M h_i(x)) \\tag{1.1.1}$$ç”±Hoeffdingä¸ç­‰å¼çŸ¥ï¼Œé›†æˆå­¦ä¹ åçš„çŠ¯é”™(å³è¿‡åŠæ•°åŸºå­¦ä¹ å™¨çŠ¯é”™)æ¦‚ç‡æ»¡è¶³$$P(H(x) \\neq f(x)) \\leq exp(- \\frac 1 2 M (1-2\\epsilon)^2) \\tag{1.1.2}$$ å¼ $ï¼ˆ1.1.2ï¼‰$ çš„è¯æ˜æ˜¯å‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹çš„ä¹ é¢˜8.1ï¼Œé¢˜è§£å¯å‚è€ƒæ­¤å¤„ å¼ $ï¼ˆ1.1.2ï¼‰$ æŒ‡å‡ºï¼Œå½“çŠ¯é”™æ¦‚ç‡ç‹¬ç«‹çš„åŸºå­¦ä¹ å™¨ä¸ªæ•° $M$ å¾ˆå¤§æ—¶ï¼Œé›†æˆåçš„çŠ¯é”™æ¦‚ç‡æ¥è¿‘0ï¼Œè¿™ä¹Ÿå¾ˆç¬¦åˆç›´è§‚æƒ³æ³•: å¤§å¤šæ•°äººåŒæ—¶çŠ¯é”™çš„æ¦‚ç‡æ˜¯æ¯”è¾ƒä½çš„ã€‚ å°±å¦‚ä¸Šé¢åŠ ç²—å­—ä½“å¼ºè°ƒçš„ï¼Œä»¥ä¸Šæ¨è®ºå…¨éƒ¨å»ºç«‹åœ¨åŸºå­¦ä¹ å™¨çŠ¯é”™ç›¸äº’ç‹¬ç«‹çš„æƒ…å†µä¸‹ï¼Œä½†å®é™…ä¸­è¿™äº›å­¦ä¹ å™¨ä¸å¯èƒ½ç›¸äº’ç‹¬ç«‹ï¼Œè€Œå¦‚ä½•è®©åŸºå­¦ä¹ å™¨å˜å¾—â€œç›¸å¯¹ç‹¬ç«‹ä¸€äº›â€ï¼Œä¹Ÿå³å¢åŠ è¿™äº›åŸºå­¦ä¹ å™¨çš„å¤šæ ·æ€§ï¼Œæ­£æ˜¯é›†æˆå­¦ä¹ éœ€è¦è€ƒè™‘çš„ä¸»è¦é—®é¢˜ã€‚ æŒ‰ç…§æ¯ä¸ªåŸºå­¦ä¹ å™¨ä¹‹é—´æ˜¯å¦å­˜åœ¨ä¾èµ–å…³ç³»å¯ä»¥å°†é›†æˆå­¦ä¹ åˆ†ä¸ºä¸¤ç±»ï¼š åŸºå­¦ä¹ å™¨ä¹‹é—´å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œä¸€ç³»åˆ—åŸºå­¦ä¹ å™¨éœ€è¦ä¸²è¡Œç”Ÿæˆï¼Œä»£è¡¨ç®—æ³•æ˜¯Boostingï¼› åŸºå­¦ä¹ å™¨ä¹‹é—´ä¸å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œä¸€ç³»åˆ—åŸºå­¦ä¹ å™¨å¯å¹¶è¡Œç”Ÿæˆï¼Œä»£è¡¨ç®—æ³•æ˜¯Baggingå’Œéšæœºæ£®æ—ã€‚ Boostingç³»åˆ—ç®—æ³•é‡Œæœ€è‘—åç®—æ³•ä¸»è¦æœ‰AdaBoostå’Œæå‡æ ‘(Boosting tree)ç³»åˆ—ç®—æ³•ï¼Œæœ¬æ–‡åªä»‹ç»æœ€å…·ä»£è¡¨æ€§çš„AdaBoostã€‚æå‡æ ‘ã€Baggingä»¥åŠéšæœºæ£®æ—ä¸åœ¨æœ¬æ–‡ä»‹ç»èŒƒå›´å†…ï¼Œæœ‰æ—¶é—´äº†å†å¦å¤–ä»‹ç»ã€‚ 1.2 BoostingBoostingæŒ‡çš„æ˜¯ä¸€ç±»é›†æˆæ–¹æ³•ï¼Œå…¶ä¸»è¦æ€æƒ³å°±æ˜¯å°†å¼±çš„åŸºå­¦ä¹ å™¨æå‡(boost)ä¸ºå¼ºå­¦ä¹ å™¨ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹: å…ˆç”¨æ¯ä¸ªæ ·æœ¬æƒé‡ç›¸ç­‰çš„è®­ç»ƒé›†è®­ç»ƒä¸€ä¸ªåˆå§‹çš„åŸºå­¦ä¹ å™¨ï¼› æ ¹æ®ä¸Šè½®å¾—åˆ°çš„å­¦ä¹ å™¨å¯¹è®­ç»ƒé›†çš„é¢„æµ‹è¡¨ç°æƒ…å†µè°ƒæ•´è®­ç»ƒé›†ä¸­çš„æ ·æœ¬æƒé‡(ä¾‹å¦‚æé«˜è¢«é”™åˆ†ç±»çš„æ ·æœ¬çš„æƒé‡ä½¿ä¹‹åœ¨ä¸‹è½®è®­ç»ƒä¸­å¾—åˆ°æ›´å¤šçš„å…³æ³¨), ç„¶åæ®æ­¤è®­ç»ƒä¸€ä¸ªæ–°çš„åŸºå­¦ä¹ å™¨ï¼› é‡å¤2ç›´åˆ°å¾—åˆ° $M$ ä¸ªåŸºå­¦ä¹ å™¨ï¼Œæœ€ç»ˆçš„é›†æˆç»“æœæ˜¯ $M$ ä¸ªåŸºå­¦ä¹ å™¨çš„ç»„åˆã€‚ ç”±æ­¤çœ‹å‡ºï¼ŒBoostingç®—æ³•æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ã€‚ Boostingç®—æ³•ç°‡ä¸­æœ€è‘—åçš„å°±æ˜¯AdaBoostï¼Œä¸‹æ–‡å°†ä¼šè¯¦ç»†ä»‹ç»ã€‚ 2. AdaBooståŸç†2.1 åŸºæœ¬æ€æƒ³å¯¹äº1.2èŠ‚æ‰€è¿°çš„Boostingç®—æ³•æ­¥éª¤ï¼Œéœ€è¦å›ç­”ä¸¤ä¸ªé—®é¢˜: å¦‚ä½•è°ƒæ•´æ¯ä¸€è½®çš„è®­ç»ƒé›†ä¸­çš„æ ·æœ¬æƒé‡ï¼Ÿ å¦‚ä½•å°†å¾—åˆ°çš„ $M$ ä¸ªç»„åˆæˆæœ€ç»ˆçš„å­¦ä¹ å™¨ï¼Ÿ AdaBoost(Adaptive Boosting, è‡ªé€‚åº”å¢å¼º)ç®—æ³•é‡‡å–çš„æ–¹æ³•æ˜¯: æé«˜ä¸Šä¸€è½®è¢«é”™è¯¯åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ï¼Œé™ä½è¢«æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼ï¼› çº¿æ€§åŠ æƒæ±‚å’Œã€‚è¯¯å·®ç‡å°çš„åŸºå­¦ä¹ å™¨æ‹¥æœ‰è¾ƒå¤§çš„æƒå€¼ï¼Œè¯¯å·®ç‡å¤§çš„åŸºå­¦ä¹ å™¨æ‹¥æœ‰è¾ƒå°çš„æƒå€¼ã€‚ Adaboostç®—æ³•ç»“æ„å¦‚ä¸‹å›¾(å›¾ç‰‡æ¥æº)æ‰€ç¤ºã€‚ å›¾2.1 ä¸‹é¢å…ˆç»™å‡ºAdaBoostç®—æ³•å…·ä½“å®ç°æ­¥éª¤ï¼Œè‡³äºç®—æ³•è§£é‡Šï¼ˆä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼‰å°†åœ¨ä¸‹ä¸€å¤§èŠ‚é˜è¿°ã€‚ 2.2 ç®—æ³•æ­¥éª¤è€ƒè™‘å¦‚ä¸‹å½¢å¼çš„äºŒåˆ†ç±»ï¼ˆæ ‡å‡†AdaBoostç®—æ³•åªé€‚ç”¨äºäºŒåˆ†ç±»ä»»åŠ¡ï¼‰è®­ç»ƒæ•°æ®é›†:$${(x_1,y_1),(x_2,y_2),â€¦,(x_N,y_N)}$$å…¶ä¸­ $x_i$æ˜¯ä¸€ä¸ªå«æœ‰$d$ä¸ªå…ƒç´ çš„åˆ—å‘é‡, å³ $x_i\\in \\mathcal{X} \\subseteq \\mathbf{R}^d$ ; $y_i$æ˜¯æ ‡é‡, $y\\in{+1,-1}$ã€‚ Adaboostç®—æ³•å…·ä½“æ­¥éª¤å¦‚ä¸‹: åˆå§‹åŒ–æ ·æœ¬çš„æƒé‡$$D_1=(w_{11}, w_{12},â€¦w_{1N}), w_{1i}=\\frac 1 N, i = 1,2â€¦N \\tag{2.2.1}$$ å¯¹$m = 1,2,â€¦M$,é‡å¤ä»¥ä¸‹æ“ä½œå¾—åˆ° $M$ ä¸ªåŸºå­¦ä¹ å™¨:(1) æŒ‰ç…§æ ·æœ¬æƒé‡åˆ†å¸ƒ $D_m$ è®­ç»ƒæ•°æ®å¾—åˆ°ç¬¬ $m$ ä¸ªåŸºå­¦ä¹ å™¨ $G_m(x)$:$$G_m(x): \\mathcal{X} \\to {-1, +1}$$(2) è®¡ç®— $G_m(x)$ åœ¨åŠ æƒè®­ç»ƒæ•°æ®é›†ä¸Šçš„åˆ†ç±»è¯¯å·®ç‡:$$e_m = \\sum_{i=1}^NP(G_m(x_i) \\neq y_i)=\\sum_{i=1}^N w_{mi} I(G_m(x_i) \\neq y_i) \\tag{2.2.2}$$ä¸Šå¼ä¸­ $I(\\cdot)$ æ˜¯æŒ‡ç¤ºå‡½æ•°ï¼Œè€ƒè™‘æ›´åŠ å‘¨å…¨çš„AdaBoostç®—æ³•åœ¨è¿™ä¸€æ­¥è¿˜åº”è¯¥åˆ¤æ–­æ˜¯å¦æ»¡è¶³åŸºæœ¬æ¡ä»¶(ä¾‹å¦‚ç”Ÿæˆçš„åŸºå­¦ä¹ å™¨æ˜¯å¦æ¯”éšæœºçŒœæµ‹å¥½), å¦‚æœä¸æ»¡è¶³ï¼Œåˆ™å½“å‰åŸºå­¦ä¹ å™¨è¢«æŠ›å¼ƒï¼Œå­¦ä¹ è¿‡ç¨‹æå‰ç»ˆæ­¢ã€‚(3) è®¡ç®— $G_m(x)$ çš„ç³»æ•°(å³æœ€ç»ˆé›†æˆä½¿ç”¨çš„çš„åŸºå­¦ä¹ å™¨çš„æƒé‡):$$\\alpha_m = \\frac 1 2 log \\frac {1-e_m} {e_m} \\tag{2.2.3}$$(4) æ›´æ–°è®­ç»ƒæ ·æœ¬çš„æƒé‡$$D_{m+1}=(w_{m+1,1}, w_{m+1,2},â€¦w_{m+1,N}) \\tag{2.2.4}$$$$w_{m+1, i} = \\frac{w_{mi}} {Z_m} exp(-\\alpha_my_iG_m(x_i)) ,i=1,2,â€¦N \\tag{2.2.5}$$å…¶ä¸­ $Z_m$ æ˜¯è§„èŒƒåŒ–å› å­ï¼Œç›®çš„æ˜¯ä¸ºäº†ä½¿ $D_{m+1}$ çš„æ‰€æœ‰å…ƒç´ å’Œä¸º1ã€‚å³$$Z_m=\\sum_{i=1}^N w_{mi} exp(-\\alpha_my_iG_m(x_i)) \\tag{2.2.6}$$ æ„å»ºæœ€ç»ˆçš„åˆ†ç±»å™¨çº¿æ€§ç»„åˆ$$f(x) = \\sum_{i=1}^M \\alpha_m G_m(x) \\tag{2.2.7}$$å¾—åˆ°æœ€ç»ˆçš„åˆ†ç±»å™¨ä¸º$$G(x) = sign(f(x))=sign(\\sum_{i=1}^M \\alpha_m G_m(x)) \\tag{2.2.8}$$ ç”±å¼ $(2.2.3)$ çŸ¥ï¼Œå½“åŸºå­¦ä¹ å™¨ $G_m(x)$ çš„è¯¯å·®ç‡ $e_m \\le 0.5$ æ—¶ï¼Œ$\\alpha_m \\ge 0$ï¼Œå¹¶ä¸” $\\alpha_m$ éšç€ $e_m$ çš„å‡å°è€Œå¢å¤§ï¼Œå³åˆ†ç±»è¯¯å·®ç‡è¶Šå°çš„åŸºå­¦ä¹ å™¨åœ¨æœ€ç»ˆé›†æˆæ—¶å æ¯”ä¹Ÿè¶Šå¤§ã€‚å³AdaBoostèƒ½å¤Ÿé€‚åº”å„ä¸ªå¼±åˆ†ç±»å™¨çš„è®­ç»ƒè¯¯å·®ç‡ï¼Œè¿™ä¹Ÿæ˜¯å®ƒçš„åç§°ä¸­â€é€‚åº”æ€§(Adaptive)â€çš„ç”±æ¥ã€‚ ç”±å¼ $(2.2.5)$ çŸ¥ï¼Œ è¢«åŸºå­¦ä¹ å™¨ $G_m(x)$ è¯¯åˆ†ç±»çš„æ ·æœ¬æƒå€¼å¾—ä»¥æ‰©å¤§ï¼Œè€Œè¢«æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬çš„æƒå€¼è¢«å¾—ä»¥ç¼©å°ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯å¼ $(2.2.7)$ ä¸­æ‰€æœ‰çš„ $\\alpha_m$ çš„å’Œå¹¶ä¸ä¸º1(å› ä¸ºæ²¡æœ‰åšä¸€ä¸ªsoftmaxæ“ä½œ)ï¼Œ$f(x)$ çš„ç¬¦å·å†³å®šäº†æ‰€é¢„æµ‹çš„ç±»ï¼Œå…¶ç»å¯¹å€¼ä»£è¡¨äº†åˆ†ç±»çš„ç¡®ä¿¡åº¦ã€‚ 3. AdaBoostç®—æ³•è§£é‡Šæœ‰æ²¡æœ‰æƒ³è¿‡ä¸ºä»€ä¹ˆAdaBoostç®—æ³•é•¿ä¸Šé¢è¿™ä¸ªæ ·å­ï¼Œä¾‹å¦‚ä¸ºä»€ä¹ˆ $\\alpha_m$ è¦ç”¨å¼ $(2.2.3)$ é‚£æ ·è®¡ç®—ï¼Ÿæœ¬èŠ‚å°†æ¢è®¨è¿™ä¸ªé—®é¢˜ã€‚ 3.1 å‰å‘åˆ†æ­¥ç®—æ³•åœ¨è§£é‡ŠAdaBoostç®—æ³•ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹å‰å‘åˆ†æ­¥ç®—æ³•ã€‚ å°±ä»¥AdaBoostç®—æ³•çš„æœ€ç»ˆæ¨¡å‹è¡¨è¾¾å¼ä¸ºä¾‹:$$f(x) = \\sum_{i=1}^M \\alpha_m G_m(x) \\tag{3.1.1}$$å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªâ€œåŠ æ€§æ¨¡å‹(additive model)â€ã€‚æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„ç»éªŒè¯¯å·®æœ€å°ï¼Œå³$$min \\sum_{i=1}^N L(y_i, f(x)) \\iff min \\sum_{i=1}^N L(y_i, \\sum_{i=1}^M \\alpha_m G_m(x)) \\tag{3.1.2}$$é€šå¸¸è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„ä¼˜åŒ–é—®é¢˜ã€‚å‰å‘åˆ†æ­¥ç®—æ³•æ±‚è§£è¿™ä¸€ä¼˜åŒ–é—®é¢˜çš„æ€æƒ³å°±æ˜¯: å› ä¸ºæœ€ç»ˆæ¨¡å‹æ˜¯ä¸€ä¸ªåŠ æ€§æ¨¡å‹ï¼Œå¦‚æœèƒ½ä»å‰å¾€åï¼Œæ¯ä¸€æ­¥åªå­¦ä¹ ä¸€ä¸ªåŸºå­¦ä¹ å™¨ $G_m(x)$ åŠå…¶æƒé‡ $\\alpha_m$ , ä¸æ–­è¿­ä»£å¾—åˆ°æœ€ç»ˆçš„æ¨¡å‹ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç®€åŒ–é—®é¢˜å¤æ‚åº¦ã€‚å…·ä½“çš„ï¼Œå½“æˆ‘ä»¬ç»è¿‡ $m-1$ è½®è¿­ä»£å¾—åˆ°äº†æœ€ä¼˜æ¨¡å‹ $f_{m-1}(x)$ æ—¶ï¼Œå› ä¸º $$f_m(x)= f_{m-1}(x) + \\alpha_mG_m(x) \\tag{3.1.3}$$æ‰€ä»¥æ­¤è½®ä¼˜åŒ–ç›®æ ‡å°±ä¸º$$min \\sum_{i=1}^N L(y_i, f_{m-1}(x) + \\alpha_mG_m(x)) \\tag{3.1.4}$$æ±‚è§£ä¸Šå¼å³å¯å¾—åˆ°ç¬¬ $m$ ä¸ªåŸºåˆ†ç±»å™¨ $G_m(x)$ åŠå…¶æƒé‡ $\\alpha_m$ ã€‚è¿™æ ·ï¼Œå‰å‘åˆ†æ­¥ç®—æ³•å°±é€šè¿‡ä¸æ–­è¿­ä»£æ±‚å¾—äº†ä» $m=1$ åˆ° $m=M$ çš„æ‰€æœ‰åŸºåˆ†ç±»å™¨åŠå…¶æƒé‡ï¼Œé—®é¢˜å¾—åˆ°äº†è§£å†³ã€‚ 3.2 AdaBoostç®—æ³•è¯æ˜ä¸Šä¸€å°ç»“ä»‹ç»çš„å‰å‘åˆ†æ­¥ç®—æ³•é€ä¸€å­¦ä¹ åŸºå­¦ä¹ å™¨ï¼Œè¿™ä¸€è¿‡ç¨‹ä¹Ÿå³AdaBoostç®—æ³•é€ä¸€å­¦ä¹ åŸºå­¦ä¹ å™¨çš„è¿‡ç¨‹ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆ2.2èŠ‚ä¸­çš„å…¬å¼ä¸ºä»€ä¹ˆé•¿é‚£æ ·è¿˜æ˜¯æ²¡æœ‰è§£é‡Šã€‚æœ¬èŠ‚å°±è¯æ˜å‰å‘åˆ†æ­¥ç®—æ³•çš„æŸå¤±å‡½æ•°æ˜¯æŒ‡æ•°æŸå¤±å‡½æ•°(exponential loss function)æ—¶ï¼ŒAdaBoostå­¦ä¹ çš„å…·ä½“æ­¥éª¤å°±å¦‚2.2èŠ‚æ‰€ç¤ºã€‚ æŒ‡æ•°æŸå¤±å‡½æ•°å³$$L(y, f(x)) = exp(-yf(x))$$å‘¨å¿—åã€Šæœºå™¨å­¦ä¹ ã€‹p174æœ‰è¯æ˜ï¼ŒæŒ‡æ•°æŸå¤±å‡½æ•°æ˜¯åˆ†ç±»ä»»åŠ¡åŸæœ¬0/1æŸå¤±å‡½æ•°çš„ä¸€è‡´(consistent)æ›¿ä»£æŸå¤±å‡½æ•°ï¼Œç”±äºæŒ‡æ•°æŸå¤±å‡½æ•°æœ‰æ›´å¥½çš„æ•°å­¦æ€§è´¨ï¼Œä¾‹å¦‚å¤„å¤„å¯å¾®ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å®ƒæ›¿ä»£0/1æŸå¤±ä½œä¸ºä¼˜åŒ–ç›®æ ‡ã€‚ å°†æŒ‡æ•°æŸå¤±å‡½æ•°ä»£å…¥å¼ $(3.1.4)$ ï¼Œä¼˜åŒ–ç›®æ ‡å°±ä¸º$$\\underset{\\alpha_m,G_m}{argmin} \\sum_{i=1}^N exp[-y_i(f_{m-1}(x) + \\alpha_mG_m(x))] \\tag{3.2.1}$$å› ä¸º $y_if_{m-1}(x)$ ä¸ä¼˜åŒ–å˜é‡ $\\alpha$ å’Œ $G$ æ— å…³ï¼Œå¦‚æœä»¤$$w_{m,i} = exp[-y_i f_{m-1}(x)] \\tag{3.2.2}$$ è¿™ä¸ª $w_{m,i}$ å…¶å®å°±æ˜¯2.2èŠ‚ä¸­å½’ä¸€åŒ–ä¹‹å‰çš„æƒé‡ $w_{m,i}$ é‚£ä¹ˆå¼ $(3.2.1)$ ç­‰ä»·äº$$\\underset{\\alpha_m,G_m}{argmin} \\sum_{i=1}^N w_{m,i}exp(-y_i\\alpha_mG_m(x)) \\tag{3.2.3}$$ æˆ‘ä»¬åˆ†ä¸¤æ­¥æ¥æ±‚è§£å¼ $(3.2.3)$ æ‰€ç¤ºçš„ä¼˜åŒ–é—®é¢˜çš„æœ€ä¼˜è§£ $\\hat{\\alpha}_m$ å’Œ $\\hat{G}_m(x)$ : å¯¹ä»»æ„çš„ $\\alpha_m &gt; 0$, æ±‚ $\\hat{G}_m(x)$ï¼š$$\\hat{G}_m (x) = \\underset{G_m}{argmin} \\sum_{i=1}^N w_{m,i} I(y_i \\neq G_m(x_i)) \\tag{3.2.4}$$ ä¸Šå¼å°†æŒ‡æ•°å‡½æ•°æ¢æˆæŒ‡ç¤ºå‡½æ•°æ˜¯å› ä¸ºå‰é¢è¯´çš„æŒ‡æ•°æŸå¤±å‡½æ•°å’Œ0/1æŸå¤±å‡½æ•°æ˜¯ä¸€è‡´ç­‰ä»·çš„ã€‚ å¼å­ $(3.2.4)$ æ‰€ç¤ºçš„ä¼˜åŒ–é—®é¢˜å…¶å®å°±æ˜¯AdaBoostç®—æ³•çš„åŸºå­¦ä¹ å™¨çš„å­¦ä¹ è¿‡ç¨‹ï¼Œå³2.2èŠ‚çš„æ­¥éª¤2(1)ï¼Œå¾—åˆ°çš„ $\\hat{G}_m(x)$ æ˜¯ä½¿ç¬¬ $m$ è½®åŠ æƒè®­ç»ƒæ•°æ®åˆ†ç±»è¯¯å·®æœ€å°çš„åŸºåˆ†ç±»å™¨ã€‚ æ±‚è§£ $\\hat{\\alpha}_m$ ï¼š å°†å¼å­ $(3.2.3)$ ä¸­çš„ç›®æ ‡å‡½æ•°å±•å¼€$$\\begin{aligned}\\sum_{i=1}^N w_{m,i}exp(-y_i\\alpha_mG_m(x)) &amp;= \\sum_{y_i=G_m(x_i)} w_{m,i}e^{- \\alpha} + \\sum_{y_i \\neq G_m(x_i)}w_{m,i}e^{\\alpha} \\\\\\\\&amp; = (e^{\\alpha} - e^{-\\alpha}) \\sum_{i=1}^N w_{m,i} I(y_i \\neq G_m(x_i)) + e^{-\\alpha} \\sum_{i=1}^N w_{m,i}\\end{aligned} \\tag{3.2.5}$$ æ³¨ï¼šä¸ºäº†ç®€æ´ï¼Œä¸Šå¼å­ä¸­çš„$\\hat{G}_m(x)$ è¢«ç•¥å»äº† $\\hat{\\cdot}$ ï¼Œ $\\alpha_m$ è¢«ç•¥å»äº†ä¸‹æ ‡ $m$ ï¼Œä¸‹åŒ å°†ä¸Šå¼å¯¹ $\\alpha$ æ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸º0ï¼Œå³ $$(e^{\\alpha} + e^{-\\alpha}) \\sum_{i=1}^N w_{m,i} I(y_i \\neq G_m(x_i)) - e^{-\\alpha} \\sum_{i=1}^N w_{m,i} = 0 \\tag{3.2.6} $$ è§£å¾— $$ \\hat{\\alpha}_m = \\frac 1 2 log \\frac {1-e_m} {e_m} \\tag{3.2.7} $$ å…¶ä¸­, $e_m$ æ˜¯åˆ†ç±»è¯¯å·®ç‡ï¼š $$ e_m = \\frac {\\sum_{i=1}^N w_{m,i} I(y_i \\neq G_m(x_i)} {\\sum_{i=1}^N w_{mi}} \\tag{3.2.8} $$ å¦‚æœå¼å­ $(3.2.8)$ ä¸­çš„ $w_{mi}$ å½’ä¸€åŒ–æˆå’Œä¸º1çš„è¯é‚£ä¹ˆå¼ $(3.2.8)$ ä¹Ÿå°±å’Œ2.2èŠ‚å¼ $(2.2.2)$ ä¸€æ¨¡ä¸€æ ·äº†ï¼Œè¿›ä¸€æ­¥åœ°ä¹Ÿæœ‰ä¸Šé¢çš„ $\\hat{\\alpha}_m$ ä¹Ÿå°±æ˜¯2.2èŠ‚çš„ $\\alpha_m$ ã€‚ æœ€åæ¥çœ‹çœ‹æ¯ä¸€è½®æ ·æœ¬æƒå€¼çš„æ›´æ–°ï¼Œç”± $(3.1.3)$ å’Œ $(3.2.2)$ å¯å¾— $$ w_{m+1,i} = w_{m,i} exp[-y_i \\alpha_m G_{m}(x)] \\tag{3.2.9} $$ å¦‚æœå°†ä¸Šå¼è¿›è¡Œå½’ä¸€åŒ–æˆå’Œä¸º1çš„è¯å°±å’Œä¸2.2èŠ‚ä¸­ $(2.2.5)$ å®Œå…¨ç›¸åŒäº†ã€‚ ç”±æ­¤å¯è§ï¼Œ2.2èŠ‚æ‰€è¿°çš„AdaBoostç®—æ³•æ­¥éª¤æ˜¯å¯ä»¥ç»è¿‡ä¸¥å¯†æ¨å¯¼å¾—æ¥çš„ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œæœ¬èŠ‚æ¨å¯¼æœ‰å¦‚ä¸‹å…³é”®ç‚¹: AdaBoostç®—æ³•æ˜¯ä¸€ä¸ªåŠ æ€§æ¨¡å‹ï¼Œå°†å…¶ç®€åŒ–æˆå‰å‘åˆ†æ­¥ç®—æ³•æ±‚è§£ï¼› å°†0/1æŸå¤±å‡½æ•°ç”¨æ•°å­¦æ€§è´¨æ›´å¥½çš„æŒ‡æ•°æŸå¤±å‡½æ•°æ›¿ä»£ã€‚ 4. pythonå®ç°4.1 åŸºå­¦ä¹ å™¨é¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªåŸºå­¦ä¹ å™¨ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªå¼±åˆ†ç±»å™¨ã€‚å¼±åˆ†ç±»å™¨ä½¿ç”¨åº“ sklearn ä¸­çš„å†³ç­–æ ‘åˆ†ç±»å™¨DecisionTreeClassifier, å¯è®¾ç½®è¯¥å†³ç­–æ ‘çš„æœ€å¤§æ·±åº¦ä¸º1ã€‚12# Fit a simple decision tree(weak classifier) firstclf_tree = DecisionTreeClassifier(max_depth = 1, random_state = 1) 4.2 AdaBoostå®ç°ç„¶åå°±æ˜¯å®Œæ•´AdaBoostç®—æ³•çš„å®ç°äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚12345678910111213141516171819202122232425262728293031323334353637def my_adaboost_clf(Y_train, X_train, Y_test, X_test, M=20, weak_clf=DecisionTreeClassifier(max_depth = 1)): n_train, n_test = len(X_train), len(X_test) # Initialize weights w = np.ones(n_train) / n_train pred_train, pred_test = [np.zeros(n_train), np.zeros(n_test)] for i in range(M): # Fit a classifier with the specific weights weak_clf.fit(X_train, Y_train, sample_weight = w) pred_train_i = weak_clf.predict(X_train) pred_test_i = weak_clf.predict(X_test) # Indicator function miss = [int(x) for x in (pred_train_i != Y_train)] print(\"weak_clf_%02d train acc: %.4f\" % (i + 1, 1 - sum(miss) / n_train)) # Error err_m = np.dot(w, miss) # Alpha alpha_m = 0.5 * np.log((1 - err_m) / float(err_m)) # New weights miss2 = [x if x==1 else -1 for x in miss] # -1 * y_i * G(x_i): 1 / -1 w = np.multiply(w, np.exp([float(x) * alpha_m for x in miss2])) w = w / sum(w) # Add to prediction pred_train_i = [1 if x == 1 else -1 for x in pred_train_i] pred_test_i = [1 if x == 1 else -1 for x in pred_test_i] pred_train = pred_train + np.multiply(alpha_m, pred_train_i) pred_test = pred_test + np.multiply(alpha_m, pred_test_i) pred_train = (pred_train &gt; 0) * 1 pred_test = (pred_test &gt; 0) * 1 print(\"My AdaBoost clf train accuracy: %.4f\" % (sum(pred_train == Y_train) / n_train)) print(\"My AdaBoost clf test accuracy: %.4f\" % (sum(pred_test == Y_test) / n_test))","categories":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"https://tangshusen.me/categories/Machine-Learning/"}],"tags":[{"name":"AdaBoost","slug":"AdaBoost","permalink":"https://tangshusen.me/tags/AdaBoost/"},{"name":"é›†æˆå­¦ä¹ (ensemble)","slug":"é›†æˆå­¦ä¹ -ensemble","permalink":"https://tangshusen.me/tags/é›†æˆå­¦ä¹ -ensemble/"}]},{"title":"TensorFlowå®ç°å¤šå±‚RNNçš„ä¸€ä¸ªå¤§å‘","slug":"tf-multi-rnn-bug","date":"2018-11-13T14:30:02.000Z","updated":"2018-12-30T09:15:56.162Z","comments":true,"path":"2018/11/13/tf-multi-rnn-bug/","link":"","permalink":"https://tangshusen.me/2018/11/13/tf-multi-rnn-bug/","excerpt":"","text":"èµ·å› äº‹æƒ…çš„èµ·å› æ˜¯è¿™æ ·çš„ï¼Œæˆ‘å·²ç»ç”¨tensorflowå®ç°äº†ä¸€ä¸ªå¸¦attentionçš„encoder-decoder(éƒ½æ˜¯å•å±‚çš„RNN)çš„ç»“æ„ï¼Œä»£ç ç»„ç»‡ç»“æ„å¦‚ä¸‹æ‰€ç¤º1234567891011121314151617encoder_cell = tf.nn.rnn_cell.LSTMCell(num_units=rnn_size)decoder_cell = tf.nn.rnn_cell.LSTMCell(num_units=rnn_size)def Encoder(cell, inputs): '''æ ¹æ®è¾“å…¥å¾—åˆ°è¾“å‡º''' ...... return outputs# shape: (batch_size, max_seq_len, rnn_size)encoder_outputs = Encoder(encoder_cell, inputs)# ä¸‹é¢æ˜¯attentionattn_mech = tf.contrib.seq2seq.LuongAttention(...) decoder_cell = tf.contrib.seq2seq.AttentionWrapper(decoder_cell, attn_mech, attention_layer_size=attn_size,...)# ä¸‹é¢çš„å°±ä¸é‡è¦äº†...... ä¸Šé¢è¿™æ®µä»£ç åœ¨attn_sizeä¸ºä»»ä½•å€¼çš„æ—¶å€™éƒ½æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ã€‚è¿™ä¹Ÿå¾ˆç¬¦åˆé¢„æœŸï¼Œå› ä¸ºä¸Šé¢è¿™æ®µä»£ç æ‰€å¹²çš„äº‹æƒ…å¦‚ä¸‹: ç”¨encoderå°†inputç¼–ç æˆencoder_output(å³attentionçš„keysæˆ–è€…memory)ï¼› å¯¹äºdecodeçš„æ¯ä¸€ä¸ªæ—¶åˆ»tï¼Œå°†t-1æ—¶åˆ»å¾—åˆ°çš„attention context(shape[-1]ä¸ºattn_size)å’Œdecoderçš„è¾“å…¥åˆå¹¶åœ¨ä¸€èµ·è¾“å…¥åˆ°decoderï¼›â€¦â€¦ å¯ä»¥çœ‹åˆ°attn_sizeç¡®å®æ˜¯ä»»ä½•å€¼éƒ½å¯ä»¥, ä¹Ÿå³decoderçš„è¾“å…¥ç»´åº¦(attn_size + input_x_size)ä¸ºä»»ä½•éƒ½å¯ä»¥ã€‚ æ³¨æ„TensorFlowä¸­çš„RNN cellä¸éœ€è¦æ˜¾å¼æŒ‡å®šè¾“å…¥çš„ç»´åº¦(è€Œæ˜¯è‡ªå·±æ¨æ–­å‡ºæ¥)ï¼Œè¿™å’Œpytorchä¸ä¸€æ ·:pytorch_rnn = torch.nn.LSTM(input_size = attn_size + input_x_size, hidden_size=rnn_size) ç»è¿‡åæ¥æˆ‘åˆæƒ³å°†decoderæ”¹æˆå¤šå±‚çš„RNNï¼Œdecoderç»“æ„å°±åƒä¸‹é¢å³è¾¹è¿™æ ·ï¼š äºæ˜¯æˆ‘å°†decoder_cellçš„å®šä¹‰åšäº†å¦‚ä¸‹ä¿®æ”¹:12345......one_cell = tf.nn.rnn_cell.LSTMCell(num_units=rnn_size)decoder_cell = tf.nn.rnn_cell.MultiRNNCell([one_cell for _ in range(dec_num_layers)])...... é™¤éæŠŠattn_sizeè®¾ç½®æˆrnn_size - input_x_sizeï¼Œå¦åˆ™ä¼šæŠ¥ç±»ä¼¼ä¸‹é¢çš„ç»´åº¦ä¸å¯¹çš„é”™è¯¯(å‡è®¾rnn_size=256, attn_size + input_x_size = 356)1ValueError: Dimensions must be equal, but are 256 and 356 for &apos;rnn/while/rnn/multi_rnn_cell/cell_0/cell_0/lstm_cell/MatMul_1&apos; (op: &apos;MatMul&apos;) with input shapes: [30,256], [356,1200]. è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ˜æ˜æŒ‰ç…§å‰é¢çš„åˆ†æï¼Œæ˜æ˜attn_sizeè®¾ç½®æˆä»»ä½•å€¼éƒ½å¯ä»¥çš„å•Šã€‚ è§£å†³ä¸€å¼€å§‹æˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯æˆ‘çš„attentionå†™å¾—ä¸å¯¹ï¼Œäºæ˜¯googleäº†å¥½ä¹…éƒ½æ²¡å‘ç°attentioné—®é¢˜åœ¨å“ªï¼Ÿç›´åˆ°æˆ‘çœ‹åˆ°äº†è¿™ä¸ªissueæ‰å‘ç°æ˜¯æˆ‘çš„å¤šå±‚RNNæ²¡å†™å¯¹ï¼Œè¿˜æ˜¯è‡ªå·±å¤ªèœäº†ğŸ˜­ æ­£ç¡®çš„å¤šå±‚decoder_cellåº”è¯¥æ˜¯å¦‚ä¸‹å®šä¹‰:1234......cell_list = [tf.nn.rnn_cell.LSTMCell(num_units=rnn_size) for _ in range(dec_num_layers)]decoder_cell = tf.nn.rnn_cell.MultiRNNCell(cell_list)...... å’‹ä¸€çœ‹ä¸Šé¢è¿™æ®µä»£ç è²Œä¼¼å’Œä¹‹å‰çš„é”™è¯¯ä»£ç æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†æ˜¯å¦‚ä¸‹ä»£ç ä½ å°±åº”è¯¥æ„è¯†åˆ°å“ªå„¿ä¸å¯¹äº†12345678&gt;&gt;&gt; str = \"bug\"&gt;&gt;&gt; strs = [str for _ in range(2)]&gt;&gt;&gt; print(strs)['bug', 'bug']&gt;&gt;&gt; for str in strs: print(id(str)) # id()å‡½æ•°ç”¨äºè·å–å¯¹è±¡çš„å†…å­˜åœ°å€43670492004367049200 æ³¨æ„åˆ°ä¸Šé¢è¾“å‡ºçš„ä¸¤ä¸ªåœ°å€éƒ½æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±çŸ¥é“é—®é¢˜å‡ºåœ¨å“ªå„¿äº†:å¯¹äºå‰é¢é”™è¯¯çš„å¤šå±‚rnnå®ç°, æ¯ä¸€å±‚çš„LSTMCellå…¶å®éƒ½æ˜¯åŒä¸€ä¸ª(æŒ‡å‘å®ƒä»¬çš„æŒ‡é’ˆæ˜¯ç›¸åŒçš„)ï¼Œé‚£ä¹ˆæ¯ä¸€å±‚çš„LSTMCellçš„weightsç»´åº¦å°±ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä½†å…¶å®ç¬¬ä¸€å±‚çš„è¾“å…¥ç»´åº¦(attn_size + input_x_size)å’Œå…¶å®ƒå±‚çš„ï¼ˆrnn_size)ä¸€èˆ¬éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ ·å°±ä¼šæŠ¥ç»´åº¦é”™è¯¯äº†ã€‚ è€Œæ­£ç¡®ä»£ç ä¸­ï¼Œæ¯ä¸€ä¸ªLSTMCelléƒ½æ˜¯é€šè¿‡tf.nn.rnn_cell.LSTMCell(num_units=rnn_size)å®šä¹‰çš„ï¼Œå› æ­¤å¯ä»¥æœ‰ä¸åŒçš„ç»“æ„ï¼Œè‡ªç„¶ä¸ä¼šæŠ¥é”™ã€‚ æ€»ç»“ TensorFlowä¸­é”™è¯¯çš„å¤šå±‚RNNå®ç°æ–¹å¼: 123one_cell = tf.nn.rnn_cell.LSTMCell(num_units=rnn_size)decoder_cell = tf.nn.rnn_cell.MultiRNNCell([one_cell for _ in range(dec_num_layers)])# decoder_cell = tf.nn.rnn_cell.MultiRNNCell([one_cell]*dec_num_layers])ä¹Ÿæ˜¯é”™è¯¯çš„ TensorFlowä¸­æ­£ç¡®çš„å¤šå±‚RNNå®ç°æ–¹å¼: 12cell_list = [tf.nn.rnn_cell.LSTMCell(num_units=rnn_size) for _ in range(dec_num_layers)]decoder_cell = tf.nn.rnn_cell.MultiRNNCell(cell_list) å‚è€ƒ Cannot stack LSTM with MultiRNNCell and dynamic_rnn using dynamic_rnn with multiRNN gives error","categories":[{"name":"Deep Learning","slug":"Deep-Learning","permalink":"https://tangshusen.me/categories/Deep-Learning/"}],"tags":[{"name":"tensorflow","slug":"tensorflow","permalink":"https://tangshusen.me/tags/tensorflow/"},{"name":"RNN","slug":"RNN","permalink":"https://tangshusen.me/tags/RNN/"},{"name":"attention","slug":"attention","permalink":"https://tangshusen.me/tags/attention/"},{"name":"seq2seq","slug":"seq2seq","permalink":"https://tangshusen.me/tags/seq2seq/"}]},{"title":"çœ‹äº†è¿™ç¯‡æ–‡ç« ä½ è¿˜ä¸æ‡‚SVMä½ å°±æ¥æ‰“æˆ‘","slug":"SVM","date":"2018-10-27T15:19:45.000Z","updated":"2018-12-30T09:15:43.822Z","comments":true,"path":"2018/10/27/SVM/","link":"","permalink":"https://tangshusen.me/2018/10/27/SVM/","excerpt":"","text":"æ”¯æŒå‘é‡æœº(Support Vector Machine, SVM)1. æ¦‚è¦1.1 ç®€ä»‹è‡ªä»å¤§åŠå¹´å‰æ¥è§¦åˆ°SVMä»¥æ¥ï¼Œæ„Ÿè§‰ä¸€ç›´æ²¡æ€ä¹ˆæŠŠSVMæ•´æ˜ç™½ã€‚ç›´åˆ°æœ€è¿‘ä¸Šçš„ã€Šæ¨¡å¼è¯†åˆ«ã€‹è¯¾ç¨‹æ‰ä»¿ä½›æ‰“é€šäº†æˆ‘çš„ä»»ç£äºŒè„‰ï¼Œä½¿æˆ‘ç»ˆäºææ¸…æ¥šäº†SVMçš„æ¥é¾™å»è„‰ï¼Œæ‰€ä»¥å†™ä¸ªåšå®¢ä½œä¸ªæ€»ç»“ã€‚ SVMæ˜¯ä»€ä¹ˆ? å…ˆæ¥çœ‹çœ‹ç»´åŸºç™¾ç§‘ä¸Šå¯¹SVMçš„å®šä¹‰: æ”¯æŒå‘é‡æœºï¼ˆè‹±è¯­ï¼šsupport vector machineï¼Œå¸¸ç®€ç§°ä¸ºSVMï¼Œåˆåæ”¯æŒå‘é‡ç½‘ç»œï¼‰æ˜¯åœ¨åˆ†ç±»ä¸å›å½’åˆ†æä¸­åˆ†ææ•°æ®çš„ç›‘ç£å¼å­¦ä¹ æ¨¡å‹ä¸ç›¸å…³çš„å­¦ä¹ ç®—æ³•ã€‚ç»™å®šä¸€ç»„è®­ç»ƒå®ä¾‹ï¼Œæ¯ä¸ªè®­ç»ƒå®ä¾‹è¢«æ ‡è®°ä¸ºå±äºä¸¤ä¸ªç±»åˆ«ä¸­çš„ä¸€ä¸ªæˆ–å¦ä¸€ä¸ªï¼ŒSVMè®­ç»ƒç®—æ³•åˆ›å»ºä¸€ä¸ªå°†æ–°çš„å®ä¾‹åˆ†é…ç»™ä¸¤ä¸ªç±»åˆ«ä¹‹ä¸€çš„æ¨¡å‹ï¼Œä½¿å…¶æˆä¸ºéæ¦‚ç‡äºŒå…ƒçº¿æ€§åˆ†ç±»å™¨ã€‚SVMæ¨¡å‹æ˜¯å°†å®ä¾‹è¡¨ç¤ºä¸ºç©ºé—´ä¸­çš„ç‚¹ï¼Œè¿™æ ·æ˜ å°„å°±ä½¿å¾—å•ç‹¬ç±»åˆ«çš„å®ä¾‹è¢«å°½å¯èƒ½å®½çš„æ˜æ˜¾çš„é—´éš”åˆ†å¼€ã€‚ç„¶åï¼Œå°†æ–°çš„å®ä¾‹æ˜ å°„åˆ°åŒä¸€ç©ºé—´ï¼Œå¹¶åŸºäºå®ƒä»¬è½åœ¨é—´éš”çš„å“ªä¸€ä¾§æ¥é¢„æµ‹æ‰€å±ç±»åˆ«ã€‚ å¦‚æœä»æœªæ¥è§¦SVMçš„è¯ï¼Œç»´åŸºçš„è¿™ä¸€å¤§æ®µè§£é‡Šè‚¯å®šä¼šè®©ä½ ä¸€å¤´é›¾æ°´ã€‚ç®€å•ç‚¹è®²ï¼ŒSVMå°±æ˜¯ä¸€ç§äºŒç±»åˆ†ç±»æ¨¡å‹ï¼Œä»–çš„åŸºæœ¬æ¨¡å‹æ˜¯çš„å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸Šçš„é—´éš”æœ€å¤§çš„çº¿æ€§åˆ†ç±»å™¨ï¼ŒSVMçš„å­¦ä¹ ç­–ç•¥å°±æ˜¯é—´éš”æœ€å¤§åŒ–ã€‚ 1.2 ç›´è§‚ç†è§£æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªå›¾: å›¾1.1 å›¾ä¸­æœ‰åˆ†åˆ«å±äºä¸¤ç±»çš„ä¸€äº›äºŒç»´æ•°æ®ç‚¹å’Œä¸‰æ¡ç›´çº¿ã€‚å¦‚æœä¸‰æ¡ç›´çº¿åˆ†åˆ«ä»£è¡¨ä¸‰ä¸ªåˆ†ç±»å™¨çš„è¯ï¼Œè¯·é—®å“ªä¸€ä¸ªåˆ†ç±»å™¨æ¯”è¾ƒå¥½ï¼Ÿ æˆ‘ä»¬å‡­ç›´è§‚æ„Ÿå—åº”è¯¥è§‰å¾—ç­”æ¡ˆæ˜¯H3ã€‚é¦–å…ˆH1ä¸èƒ½æŠŠç±»åˆ«åˆ†å¼€ï¼Œè¿™ä¸ªåˆ†ç±»å™¨è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼›H2å¯ä»¥ï¼Œä½†åˆ†å‰²çº¿ä¸æœ€è¿‘çš„æ•°æ®ç‚¹åªæœ‰å¾ˆå°çš„é—´éš”ï¼Œå¦‚æœæµ‹è¯•æ•°æ®æœ‰ä¸€äº›å™ªå£°çš„è¯å¯èƒ½å°±ä¼šè¢«H2é”™è¯¯åˆ†ç±»(å³å¯¹å™ªå£°æ•æ„Ÿã€æ³›åŒ–èƒ½åŠ›å¼±)ã€‚H3ä»¥è¾ƒå¤§é—´éš”å°†å®ƒä»¬åˆ†å¼€ï¼Œè¿™æ ·å°±èƒ½å®¹å¿æµ‹è¯•æ•°æ®çš„ä¸€äº›å™ªå£°è€Œæ­£ç¡®åˆ†ç±»ï¼Œæ˜¯ä¸€ä¸ªæ³›åŒ–èƒ½åŠ›ä¸é”™çš„åˆ†ç±»å™¨ã€‚ å¯¹äºæ”¯æŒå‘é‡æœºæ¥è¯´ï¼Œæ•°æ®ç‚¹è‹¥æ˜¯$p$ç»´å‘é‡ï¼Œæˆ‘ä»¬ç”¨$p-1$ç»´çš„è¶…å¹³é¢æ¥åˆ†å¼€è¿™äº›ç‚¹ã€‚ä½†æ˜¯å¯èƒ½æœ‰è®¸å¤šè¶…å¹³é¢å¯ä»¥æŠŠæ•°æ®åˆ†ç±»ã€‚æœ€ä½³è¶…å¹³é¢çš„ä¸€ä¸ªåˆç†é€‰æ‹©å°±æ˜¯ä»¥æœ€å¤§é—´éš”æŠŠä¸¤ä¸ªç±»åˆ†å¼€çš„è¶…å¹³é¢ã€‚å› æ­¤ï¼ŒSVMé€‰æ‹©èƒ½å¤Ÿä½¿ç¦»è¶…å¹³é¢æœ€è¿‘çš„æ•°æ®ç‚¹çš„åˆ°è¶…å¹³é¢è·ç¦»æœ€å¤§çš„è¶…å¹³é¢ã€‚ ä»¥ä¸Šä»‹ç»çš„SVMåªèƒ½è§£å†³çº¿æ€§å¯åˆ†çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³æ›´åŠ å¤æ‚çš„é—®é¢˜ï¼Œæ”¯æŒå‘é‡æœºå­¦ä¹ æ–¹æ³•æœ‰ä¸€äº›ç”±ç®€è‡³ç¹çš„æ¨¡å‹: çº¿æ€§å¯åˆ†SVM å½“è®­ç»ƒæ•°æ®çº¿æ€§å¯åˆ†æ—¶ï¼Œé€šè¿‡ç¡¬é—´éš”(hard marginï¼Œä»€ä¹ˆæ˜¯ç¡¬ã€è½¯é—´éš”ä¸‹é¢ä¼šè®²)æœ€å¤§åŒ–å¯ä»¥å­¦ä¹ å¾—åˆ°ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ï¼Œå³ç¡¬é—´éš”SVMï¼Œå¦‚ä¸Šå›¾çš„çš„H3ã€‚ çº¿æ€§SVM å½“è®­ç»ƒæ•°æ®ä¸èƒ½çº¿æ€§å¯åˆ†ä½†æ˜¯å¯ä»¥è¿‘ä¼¼çº¿æ€§å¯åˆ†æ—¶ï¼Œé€šè¿‡è½¯é—´éš”(soft margin)æœ€å¤§åŒ–ä¹Ÿå¯ä»¥å­¦ä¹ åˆ°ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ï¼Œå³è½¯é—´éš”SVMã€‚ éçº¿æ€§SVM å½“è®­ç»ƒæ•°æ®çº¿æ€§ä¸å¯åˆ†æ—¶ï¼Œé€šè¿‡ä½¿ç”¨æ ¸æŠ€å·§(kernel trick)å’Œè½¯é—´éš”æœ€å¤§åŒ–ï¼Œå¯ä»¥å­¦ä¹ åˆ°ä¸€ä¸ªéçº¿æ€§SVMã€‚ 2. çº¿æ€§å¯åˆ†SVMâ€”â€”ç¡¬é—´éš”è€ƒè™‘å¦‚ä¸‹å½¢å¼çš„çº¿æ€§å¯åˆ†çš„è®­ç»ƒæ•°æ®é›†:$${(X_1,y_1),(X_2,y_2),â€¦,(X_n,y_n)}$$å…¶ä¸­ $X_i$æ˜¯ä¸€ä¸ªå«æœ‰$d$ä¸ªå…ƒç´ çš„åˆ—å‘é‡, å³$X_i\\in \\mathbf{R}^d$; $y_i$æ˜¯æ ‡é‡, $y\\in{+1,-1}$, $y_i = +1$æ—¶è¡¨ç¤º$X_i$å±äºæ­£ç±»åˆ«, $y_i = -1$æ—¶è¡¨ç¤º$X_i$å±äºè´Ÿç±»åˆ«ã€‚ æ³¨: æœ¬æ–‡ä¸­, $X$ã€$X_i$ã€$W$ç­‰éƒ½æ˜¯(åˆ—)å‘é‡ï¼Œæœ‰çš„æ–‡ç« ä¸€èˆ¬ç”¨ $x_i$ è¡¨ç¤ºä¸€ä¸ªå‘é‡è€Œç”¨ $X$ è¡¨ç¤ºæ‰€æœ‰ $x_i$ ç»„æˆçš„ä¸€ä¸ªçŸ©é˜µï¼Œæ³¨æ„åŒºåˆ†ã€‚ å›å¿†ä¸€ä¸‹æ„ŸçŸ¥æœºçš„ç›®æ ‡: æ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢ä½¿å…¶èƒ½æ­£ç¡®åœ°å°†æ¯ä¸ªæ ·æœ¬æ­£ç¡®åˆ†ç±»ã€‚æ„ŸçŸ¥æœºä½¿ç”¨è¯¯åˆ†ç±»æœ€å°çš„æ–¹æ³•æ±‚å¾—è¶…å¹³é¢ï¼Œä¸è¿‡æ­¤æ—¶è§£æœ‰æ— ç©·å¤šä¸ª(ä¾‹å¦‚å›¾1.1çš„H2å’ŒH3ä»¥åŠå®ƒä¿©çš„ä»»æ„çº¿æ€§ç»„åˆ)ã€‚è€Œçº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºåˆ©ç”¨é—´éš”æœ€å¤§åŒ–æ±‚æœ€ä¼˜åˆ†ç¦»è¶…å¹³é¢,è¿™æ—¶è§£æ˜¯å”¯ä¸€çš„ã€‚ 2.1 è¶…å¹³é¢ä¸é—´éš”ä¸€ä¸ªè¶…å¹³é¢ç”±æ³•å‘é‡$W$å’Œæˆªè·$b$å†³å®š,å…¶æ–¹ç¨‹ä¸º$X^TW+b=0$, å¯ä»¥è§„å®šæ³•å‘é‡æŒ‡å‘çš„ä¸€ä¾§ä¸ºæ­£ç±»,å¦ä¸€ä¾§ä¸ºè´Ÿç±»ã€‚ä¸‹å›¾ç”»å‡ºäº†ä¸‰ä¸ªå¹³è¡Œçš„è¶…å¹³é¢ï¼Œæ³•æ–¹å‘å–å·¦ä¸Šæ–¹å‘ã€‚ æ³¨æ„: å¦‚æœ$X$å’Œ$W$éƒ½æ˜¯åˆ—å‘é‡,å³$X^TW$ä¼šå¾—åˆ°$X$å’Œ$W$çš„ç‚¹ç§¯(dot product, æ˜¯ä¸€ä¸ªæ ‡é‡),ç­‰ä»·äº$X \\cdot W$å’Œ$W \\cdot X$ã€‚ å›¾2.1 ä¸ºäº†æ‰¾åˆ°æœ€å¤§é—´éš”è¶…å¹³é¢ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆé€‰æ‹©åˆ†ç¦»ä¸¤ç±»æ•°æ®çš„ä¸¤ä¸ªå¹³è¡Œè¶…å¹³é¢ï¼Œä½¿å¾—å®ƒä»¬ä¹‹é—´çš„è·ç¦»å°½å¯èƒ½å¤§ã€‚åœ¨è¿™ä¸¤ä¸ªè¶…å¹³é¢èŒƒå›´å†…çš„åŒºåŸŸç§°ä¸ºâ€œé—´éš”(margin)â€ï¼Œæœ€å¤§é—´éš”è¶…å¹³é¢æ˜¯ä½äºå®ƒä»¬æ­£ä¸­é—´çš„è¶…å¹³é¢ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ 2.2 é—´éš”æœ€å¤§åŒ–å°†é«˜æ•°é‡Œé¢æ±‚ä¸¤æ¡å¹³è¡Œç›´çº¿çš„è·ç¦»å…¬å¼æ¨å¹¿åˆ°é«˜ç»´å¯æ±‚å¾—å›¾2.1ä¸­marginçš„$\\rho$:$$margin = \\rho = \\frac 2 {||W||} \\tag{2.2.1}$$æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿$\\rho$æœ€å¤§, ç­‰ä»·äºä½¿$\\rho^2$æœ€å¤§:$$\\underset{W,b}{max} \\rho \\iff \\underset{W,b}{max} \\rho^2 \\iff \\underset{W,b}{min}\\frac 1 2 ||W||^2 \\tag{2.2.2}$$ä¸Šå¼çš„$\\frac 1 2$æ˜¯ä¸ºäº†åç»­æ±‚å¯¼ååˆšå¥½èƒ½æ¶ˆå»ï¼Œæ²¡æœ‰å…¶ä»–ç‰¹æ®Šæ„ä¹‰ã€‚ åŒæ—¶ä¹Ÿä¸è¦å¿˜äº†æœ‰ä¸€äº›çº¦æŸæ¡ä»¶:$$X_i^TW+b \\ge +1, y_i=+1 \\\\\\\\X_i^TW+b \\le -1, y_i=-1 \\tag{2.2.3}$$æ€»ç»“ä¸€ä¸‹ï¼Œé—´éš”æœ€å¤§åŒ–é—®é¢˜çš„æ•°å­¦è¡¨è¾¾å°±æ˜¯$$\\underset{W,b}{min}J(W) = \\underset{W,b}{min}\\frac 1 2 ||W||^2 \\\\\\\\s.t.\\quad y_i(X_i^TW+b) \\ge 1, i=1,2,â€¦n. \\tag{2.2.4}$$ é€šè¿‡æ±‚è§£ä¸Šå¼å³å¯å¾—åˆ°æœ€ä¼˜è¶…å¹³é¢ $ \\hat{W} $ å’Œ $ \\hat{b} $ ã€‚å…·ä½“å¦‚ä½•æ±‚è§£è§2.4å’Œ2.5èŠ‚ã€‚ 2.3 æ”¯æŒå‘é‡åœ¨çº¿æ€§å¯åˆ†çš„æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ•°æ®é›†çš„æ ·æœ¬ç‚¹ä¸­ä¸åˆ†ç¦»è¶…å¹³é¢è·ç¦»æœ€è¿‘çš„æ•°æ®ç‚¹ç§°ä¸ºæ”¯æŒå‘é‡(support vector)ï¼Œæ”¯æŒå‘é‡æ˜¯ä½¿$(2.2.4)$ä¸­çš„çº¦æŸæ¡ä»¶å–ç­‰çš„ç‚¹ï¼Œå³æ»¡è¶³$$ y_i(X_i^TW+b) = 1 \\tag{2.3.1}$$çš„ç‚¹ã€‚ä¹Ÿå³æ‰€æœ‰åœ¨ç›´çº¿$ X^TW+b = 1$æˆ–ç›´çº¿$ X^TW+b = -1$çš„ç‚¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º: å›¾2.2 åœ¨å†³å®šæœ€ä½³è¶…å¹³é¢æ—¶åªæœ‰æ”¯æŒå‘é‡èµ·ä½œç”¨ï¼Œè€Œå…¶ä»–æ•°æ®ç‚¹å¹¶ä¸èµ·ä½œç”¨(å…·ä½“æ¨å¯¼è§2.4èŠ‚æœ€å)ã€‚å¦‚æœç§»åŠ¨éæ”¯æŒå‘é‡ï¼Œç”šè‡³åˆ é™¤éæ”¯æŒå‘é‡éƒ½ä¸ä¼šå¯¹æœ€ä¼˜è¶…å¹³é¢äº§ç”Ÿä»»ä½•å½±å“ã€‚\u001cä¹Ÿå³æ”¯æŒå‘é‡å¯¹æ¨¡å‹èµ·ç€å†³å®šæ€§çš„ä½œç”¨ï¼Œè¿™ä¹Ÿæ˜¯â€œæ”¯æŒå‘é‡æœºâ€åç§°çš„ç”±æ¥ã€‚ 2.4 å¯¹å¶é—®é¢˜å¦‚ä½•æ±‚è§£å¼ $(2.2.4)$ å‘¢ï¼Ÿ æˆ‘ä»¬ç§°å¼ $(2.2.4)$ æ‰€è¿°é—®é¢˜ä¸ºåŸå§‹é—®é¢˜(primal problem), å¯ä»¥åº”ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ„é€ æ‹‰æ ¼æœ—æ—¥å‡½æ•°(Lagrange function)å†é€šè¿‡æ±‚è§£å…¶å¯¹å¶é—®é¢˜(dual problem)å¾—åˆ°åŸå§‹é—®é¢˜çš„æœ€ä¼˜è§£ã€‚è½¬æ¢ä¸ºå¯¹å¶é—®é¢˜æ¥æ±‚è§£çš„åŸå› æ˜¯: å¯¹å¶é—®é¢˜æ›´æ˜“æ±‚è§£ï¼Œç”±ä¸‹æ–‡çŸ¥å¯¹å¶é—®é¢˜åªéœ€ä¼˜åŒ–ä¸€ä¸ªå˜é‡$\\alpha$ä¸”çº¦æŸæ¡ä»¶æ›´ç®€å•ï¼› èƒ½æ›´åŠ è‡ªç„¶åœ°å¼•å…¥æ ¸å‡½æ•°ï¼Œè¿›è€Œæ¨å¹¿åˆ°éçº¿æ€§é—®é¢˜ã€‚ é¦–å…ˆæ„å»ºæ‹‰æ ¼æœ—æ—¥å‡½æ•°ã€‚ä¸ºæ­¤éœ€è¦å¼•è¿›æ‹‰æ ¼æœ—æ—¥ä¹˜å­(Lagrange multiplier) $\\alpha_i \\ge 0, i=1,2,â€¦n$ã€‚åˆ™æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º:$$L(W,b,\\alpha)=\\frac 1 2 ||W||^2 - \\sum_{i=1}^n \\alpha_i [y_i(X_i^TW+b)-1]\\tag{2.4.1}$$å› æ­¤ï¼Œç»™å®šä¸€ä¸ª$W$å’Œ$b$, è‹¥ä¸æ»¡è¶³å¼$(2.2.4)$çš„çº¦æŸæ¡ä»¶ï¼Œé‚£ä¹ˆæœ‰$$\\underset{\\alpha}{max} L(W,b,\\alpha) = +\\infty \\tag{2.4.2}$$å¦åˆ™ï¼Œè‹¥æ»¡è¶³å¼$(2.2.4)$çš„çº¦æŸæ¡ä»¶ï¼Œæœ‰$$\\underset{\\alpha}{max} L(W,b,\\alpha) = J(W) = \\frac 1 2 ||W||^2 \\tag{2.4.3}$$ç»“åˆå¼$(2.4.2)$å’Œ$(2.4.3)$çŸ¥ï¼Œä¼˜åŒ–é—®é¢˜$$\\underset{W, b}{min} \\underset{\\alpha}{max} L(W,b,\\alpha)\\tag{2.4.4}$$ä¸å¼$(2.2.4)$æ‰€è¿°é—®é¢˜æ˜¯å®Œå…¨ç­‰ä»·çš„ã€‚ æ ¹æ®æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§ï¼Œå¼$(2.4.4)$æ‰€è¿°é—®é¢˜å³åŸå§‹é—®é¢˜çš„å¯¹å¶é—®é¢˜æ˜¯:$$\\underset{\\alpha}{max} \\underset{W, b}{min} L(W,b,\\alpha) \\tag{2.4.5}$$ ä»¥ä¸Šå…·ä½“æ¨å¯¼ç»†èŠ‚å¯å‚è§ä¹¦ç±ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æˆ–è€…çŸ¥ä¹æ–‡ç« æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§ ä¸ºäº†æ±‚å¾—å¯¹å¶é—®é¢˜çš„è§£ï¼Œéœ€è¦å…ˆæ±‚å¾—$L(W,b,\\alpha)$å¯¹$W$å’Œ$b$çš„æå°å†æ±‚å¯¹$\\alpha$çš„æå¤§ã€‚ (1) æ±‚$\\underset{W, b}{min} L(W,b,\\alpha)$:å¯¹æ‹‰æ ¼æœ—æ—¥å‡½æ•°æ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸º0ï¼Œæœ‰:$$\\nabla_W L(W,b,\\alpha) = W - \\sum_{i=1}^n \\alpha_i y_i X_i = 0 \\implies W= \\sum_{i=1}^n \\alpha_i y_i X_i\\tag{2.4.6}$$$$\\nabla_b L(W,b,\\alpha) = - \\sum_{i=1}^n \\alpha_i y_i = 0 \\implies \\sum_{i=1}^n \\alpha_i y_i = 0 \\tag{2.4.7}$$å°†ä¸Šé¢ä¸¤å¼ä»£å…¥$L(W,b,\\alpha)$ï¼š æ‰€ä»¥ï¼Œ$$\\underset{W, b}{min} L(W,b,\\alpha) = -\\frac 1 2 \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j X_i^T X_j \\ + \\ \\sum_{i=1}^n \\alpha_i \\tag{2.4.8}$$ (2) æ±‚$\\underset{W, b}{min} L(W,b,\\alpha)$ å¯¹$\\alpha$çš„æå¤§:ç­‰ä»·äºå¼$(2.4.8)$å¯¹$\\alpha$æ±‚æå¤§ï¼Œä¹Ÿç­‰ä»·äºå¼$(2.4.8)$å–è´Ÿæ•°åå¯¹$\\alpha$æ±‚æå°ï¼Œå³$$\\underset{\\alpha}{min} \\quad \\frac 1 2 \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j X_i^T X_j \\ - \\ \\sum_{i=1}^n \\alpha_i \\tag{2.4.9}$$åŒæ—¶æ»¡è¶³çº¦æŸæ¡ä»¶:$$\\sum_{i=1}^n \\alpha_i y_i = 0 \\\\\\\\\\alpha_i \\ge 0, i=1,2,â€¦,n. \\tag{2.4.10}$$ è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†åŸå§‹æœ€ä¼˜åŒ–é—®é¢˜$(2.2.4)$å’Œå¯¹å¶æœ€ä¼˜åŒ–é—®é¢˜$(2.4.9)$ã€$(2.4.10)$ã€‚ ç”±slateræ¡ä»¶çŸ¥ï¼Œå› ä¸ºåŸå§‹ä¼˜åŒ–é—®é¢˜çš„ç›®æ ‡å‡½æ•°å’Œä¸ç­‰å¼çº¦æŸæ¡ä»¶éƒ½æ˜¯å‡¸å‡½æ•°ï¼Œå¹¶ä¸”è¯¥ä¸ç­‰å¼çº¦æŸæ˜¯ä¸¥æ ¼å¯è¡Œçš„(å› ä¸ºæ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„), æ‰€ä»¥å­˜åœ¨ $ \\hat{W} $, $ \\hat{b}$ ,$\\hat{\\alpha} $ï¼Œä½¿å¾—$ \\hat{W} $, $ \\hat{b}$æ˜¯åŸå§‹é—®é¢˜çš„è§£ï¼Œ$\\hat{\\alpha} $æ˜¯å¯¹å¶é—®é¢˜çš„è§£ã€‚è¿™æ„å‘³ç€æ±‚è§£åŸå§‹æœ€ä¼˜åŒ–é—®é¢˜$(2.2.4)$å¯ä»¥è½¬æ¢ä¸ºæ±‚è§£å¯¹å¶æœ€ä¼˜åŒ–é—®é¢˜$(2.4.9)$ã€$(2.4.10)$ã€‚ slater æ¡ä»¶:åŸå§‹é—®é¢˜ä¸€èˆ¬æ€§è¡¨è¾¾ä¸º$$\\underset{x}{min} \\quad f(x) \\\\\\\\s.t. \\ c_i(x) \\le 0, i=1,2,â€¦k \\\\\\\\\\quad \\quad h_j(x) = 0, j=1,2,â€¦,l$$åˆ™å…¶æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º$$L(x,\\alpha,\\beta)=f(x) + \\sum_{i=1}^k \\alpha_i c_i(x) +\\sum_{j=1}^l \\beta_j h_j(x), \\quad \\alpha_i \\ge 0$$å‡è®¾åŸå§‹é—®é¢˜ç›®æ ‡å‡½æ•° $f(x)$ å’Œä¸ç­‰å¼çº¦æŸæ¡ä»¶ $c_i(x)$éƒ½æ˜¯å‡¸å‡½æ•°ï¼ŒåŸå§‹é—®é¢˜ç­‰å¼çº¦æŸ$h_j(x)$éƒ½æ˜¯ä»¿å°„å‡½æ•°ï¼Œä¸”ä¸ç­‰å¼çº¦æŸ $c_i(x)$æ˜¯ä¸¥æ ¼å¯è¡Œçš„ï¼Œå³å­˜åœ¨ $x$ ï¼Œå¯¹æ‰€æœ‰ $i$ éƒ½æœ‰ $c_i(x) &lt; 0$ ï¼Œåˆ™å­˜åœ¨ $\\hat{x} $, $\\hat{\\alpha} $, $\\hat{\\beta} $ï¼Œä½¿ $\\hat{x} $ æ˜¯åŸå§‹é—®é¢˜çš„è§£ï¼Œ $\\hat{\\alpha} $, $\\hat{\\beta} $æ˜¯å¯¹å¶é—®é¢˜çš„è§£ã€‚ é‚£ä¹ˆå¦‚ä½•æ±‚è§£ä¼˜åŒ–é—®é¢˜$(2.4.9)$ã€$(2.4.10)$çš„æœ€ä¼˜è§£ $\\hat{\\alpha}$ å‘¢ï¼Ÿä¸éš¾å‘ç°è¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œæœ‰ç°æˆçš„é€šç”¨çš„ç®—æ³•æ¥æ±‚è§£ã€‚ äº‹å®ä¸Šé€šç”¨çš„æ±‚è§£äºŒæ¬¡è§„åˆ’é—®é¢˜çš„ç®—æ³•çš„å¤æ‚åº¦æ­£æ¯”äºè®­ç»ƒæ•°æ®æ ·æœ¬æ•°ï¼Œæ‰€ä»¥åœ¨å®é™…åº”ç”¨ä¸­éœ€è¦å¯»æ±‚æ›´åŠ é«˜æ•ˆçš„ç®—æ³•ï¼Œä¾‹å¦‚åºåˆ—æœ€å°ä¼˜åŒ–(Sequential Minimal Optimiation, SMO)ç®—æ³•ã€‚ å‡è®¾æˆ‘ä»¬ç°åœ¨æ±‚å¾—äº†$(2.4.9)$ã€$(2.4.10)$çš„æœ€ä¼˜è§£ $\\hat{\\alpha}$ï¼Œåˆ™æ ¹æ®å¼$(2.4.6)$å¯æ±‚å¾—æœ€ä¼˜$\\hat{W}$ï¼š$$\\hat{W}= \\sum_{i=1}^n \\hat{\\alpha}_i y_i X_i \\tag{2.4.11}$$å› ä¸ºè‡³å°‘å­˜åœ¨ä¸€ä¸ª $\\hat{\\alpha}_j &gt; 0$(è‹¥ä¸å­˜åœ¨ï¼Œå³ $\\hat{\\alpha}$ å…¨ä¸º0ï¼Œåˆ™ $\\hat{W}=0$, å³ $margin = \\frac 2 {||\\hat{W}||}= \\infty $,æ˜¾ç„¶ä¸è¡Œ), å†æ ¹æ®KKTæ¡ä»¶ï¼Œå³$$\\begin{cases}ä¹˜å­éè´Ÿ: \\alpha_i \\ge 0 (i=1,2,â€¦n.ä¸‹åŒ) \\\\\\\\çº¦æŸæ¡ä»¶: y_i(X_i^TW+b) - 1\\ge 0 \\\\\\\\äº’è¡¥æ¡ä»¶: \\alpha_i (y_i(X_i^TW+b) - 1)=0\\end{cases}$$æ‰€ä»¥è‡³å°‘å­˜åœ¨ä¸€ä¸ª $j$ , ä½¿ $ y_j(X_j^T \\hat{W}+\\hat{b}) - 1=0$, å³å¯æ±‚å¾—æœ€ä¼˜ $\\hat{b}$:$$\\begin{aligned}\\hat{b} &amp; = \\frac 1 {y_j} -X_j^T \\hat{W} \\\\\\\\&amp; = y_j -X_j^T \\hat{W} \\\\\\\\&amp; = y_j-\\sum_{i=1}^n \\hat{\\alpha}_i y_i X_j^T X_i\\end{aligned} \\tag{2.4.12}$$è‡³æ­¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ±‚å¾—äº†æ•´ä¸ªçº¿æ€§å¯åˆ†SVMçš„è§£ã€‚æ±‚å¾—çš„åˆ†ç¦»è¶…å¹³é¢ä¸º:$$\\sum_{i=1}^n \\hat{\\alpha}_i y_i X^TX_i + \\hat{b}=0 \\tag{2.4.13}$$åˆ™åˆ†ç±»çš„å†³ç­–å‡½æ•°ä¸º$$f(X) = sign(\\sum_{i=1}^n \\hat{\\alpha}_i y_i X^TX_i + \\hat{b})\\tag{2.4.14}$$å†æ¥åˆ†æKKTæ¡ä»¶é‡Œçš„äº’è¡¥æ¡ä»¶ï¼Œå¯¹äºä»»æ„æ ·æœ¬ $(X_i, y_i)$ ï¼Œæ€»ä¼šæœ‰ $ \\alpha_i=0 $ æˆ–è€… $y_if(X_i)=y_i(X_i^T \\hat{W}+b) = 1$ã€‚åˆ™æœ‰ è‹¥$ \\alpha_i=0$ï¼Œæ­¤æ ·æœ¬ç‚¹ä¸æ˜¯æ”¯æŒå‘é‡ï¼Œå¯¹æ¨¡å‹æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼› è‹¥$ \\alpha_i&gt;0$ï¼Œæ­¤æ ·æœ¬ç‚¹ä½äºæœ€å¤§é—´éš”è¾¹ç•Œä¸Šï¼Œæ˜¯ä¸€ä¸ªæ”¯æŒå‘é‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾2.3 æ­¤å¤–ï¼Œå½“æ ·æœ¬ç‚¹æ˜¯éæ”¯æŒå‘é‡æ—¶ï¼Œå› ä¸º$ \\alpha_i=0$, æ‰€ä»¥SVMçš„è§£ä¸­çš„æ±‚å’Œé¡¹ä¸­ç¬¬ $i$ é¡¹å°±ä¸º0ï¼Œæ‰€ä»¥SVMçš„è§£$(2.4.11)$ã€$(2.4.12)$å¯ç®€åŒ–ä¸ºå¦‚ä¸‹å½¢å¼:$$\\hat{W}= \\sum_{i \\in SV} \\hat{\\alpha}_i y_i X_i \\tag{2.4.15}$$$$\\hat{b} = y_j-\\sum_{i \\in SV} \\hat{\\alpha}_i y_i X_j^T X_i\\tag{2.4.16}$$ç±»ä¼¼çš„ï¼Œåˆ¤åˆ«å‡½æ•°ä¹Ÿå¯è½¬æ¢æˆå¦‚ä¸‹å½¢å¼:$$f(X) = sign(\\sum_{i \\in SV} \\hat{\\alpha}_i y_i X^TX_i + \\hat{b})\\tag{2.4.17}$$æ‰€ä»¥ï¼Œæ•´ä¸ªSVMçš„è§£åªä¸æ”¯æŒå‘é‡SVæœ‰å…³ï¼Œä¸éæ”¯æŒå‘é‡æ— å…³ã€‚è¿™ä¹Ÿå°±è§£é‡Šäº†2.3èŠ‚çš„ç»“è®ºï¼Œå³åœ¨å†³å®šæœ€ä½³è¶…å¹³é¢æ—¶åªæœ‰æ”¯æŒå‘é‡èµ·ä½œç”¨ï¼Œè€Œå…¶ä»–æ•°æ®ç‚¹å¹¶ä¸èµ·ä½œç”¨ã€‚ 3. çº¿æ€§SVMâ€”â€”è½¯é—´éš”åœ¨å‰é¢çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´å‡å®šè®­ç»ƒæ•°æ®æ˜¯ä¸¥æ ¼çº¿æ€§å¯åˆ†çš„ï¼Œå³å­˜åœ¨ä¸€ä¸ªè¶…å¹³é¢èƒ½å®Œå…¨å°†ä¸¤ç±»æ•°æ®åˆ†å¼€ã€‚ä½†æ˜¯ç°å®ä»»åŠ¡è¿™ä¸ªå‡è®¾å¾€å¾€ä¸æˆç«‹ï¼Œä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ•°æ®ã€‚ å›¾3.1 3.1 è½¯é—´éš”æœ€å¤§åŒ–è§£å†³è¯¥é—®é¢˜çš„ä¸€ä¸ªåŠæ³•æ˜¯å…è®¸SVMåœ¨å°‘é‡æ ·æœ¬ä¸Šå‡ºé”™ï¼Œå³å°†ä¹‹å‰çš„ç¡¬é—´éš”æœ€å¤§åŒ–æ¡ä»¶æ”¾å®½ä¸€ç‚¹ï¼Œä¸ºæ­¤å¼•å…¥â€œè½¯é—´éš”(soft margin)â€çš„æ¦‚å¿µã€‚å³å…è®¸å°‘é‡æ ·æœ¬ä¸æ»¡è¶³çº¦æŸ$$y_i(X_i^TW+b) \\ge 1 \\tag{3.1.1}$$ä¸ºäº†ä½¿ä¸æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„æ ·æœ¬ç‚¹å°½å¯èƒ½å°‘ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°$(2.2.2)$é‡Œé¢æ–°å¢ä¸€ä¸ªå¯¹è¿™äº›ç‚¹çš„æƒ©ç½šé¡¹ã€‚æœ€å¸¸ç”¨çš„æ˜¯hingeæŸå¤±:$$l_{hinge}(z) = max(0, 1-z) \\tag{3.1.2}$$å³è‹¥æ ·æœ¬ç‚¹æ»¡è¶³çº¦æŸæ¡ä»¶æŸå¤±å°±æ˜¯0, å¦åˆ™æŸå¤±å°±æ˜¯ $1-z$ ,åˆ™ä¼˜åŒ–ç›®æ ‡ $(2.2.2)$ å˜æˆ$$\\underset{W,b}{min} \\quad \\frac 1 2 ||W||^2 + C \\sum_{i=1}^n max(0, 1 - y_i(X_i^TW+b))\\tag{3.1.3}$$å…¶ä¸­ $C &gt; 0$ ç§°ä¸ºæƒ©ç½šå‚æ•°ï¼Œ$C$ è¶Šå°æ—¶å¯¹è¯¯åˆ†ç±»æƒ©ç½šè¶Šå°ï¼Œè¶Šå¤§æ—¶å¯¹è¯¯åˆ†ç±»æƒ©ç½šè¶Šå¤§ï¼Œå½“ $C$ å–æ­£æ— ç©·æ—¶å°±å˜æˆäº†ç¡¬é—´éš”ä¼˜åŒ–ã€‚å®é™…åº”ç”¨æ—¶æˆ‘ä»¬è¦åˆç†é€‰å– $C$ï¼Œ$C$ è¶Šå°è¶Šå®¹æ˜“æ¬ æ‹Ÿåˆï¼Œ$C$ è¶Šå¤§è¶Šå®¹æ˜“è¿‡æ‹Ÿåˆã€‚ å¦‚æœæˆ‘ä»¬å¼•å…¥â€œæ¾å¼›å˜é‡â€ $ \\xi_i \\ge 0$, é‚£ä¹ˆå¼ $(3.1.3)$ å¯é‡å†™æˆ$$\\underset{W,b,\\xi}{min} \\quad \\frac 1 2 ||W||^2 + C \\sum_{i=1}^n \\xi_i\\\\\\\\s.t.\\ y_i(X_i^TW+b) \\ge 1-\\xi_i \\\\\\\\\\xi_i \\ge 0, i=1,2,â€¦n. \\tag{3.1.4}$$ä¸Šå¼æ‰€è¿°é—®é¢˜å³è½¯é—´éš”æ”¯æŒå‘é‡æœºã€‚ 3.2 å¯¹å¶é—®é¢˜å¼ $(3.1.4)$ è¡¨ç¤ºçš„è½¯é—´éš”æ”¯æŒå‘é‡æœºä¾ç„¶æ˜¯ä¸€ä¸ªå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå’Œç¡¬é—´éš”æ”¯æŒå‘é‡æœºç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•å°†å…¶è½¬æ¢ä¸ºå¯¹å¶é—®é¢˜è¿›è¡Œæ±‚è§£ã€‚å¼ $(3.1.4)$ å¯¹åº”çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸º$$L(W,b,\\xi,\\alpha,\\beta)=\\frac 1 2 ||W||^2 + C \\sum_{i=1}^n \\xi_i - \\sum_{i=1}^n \\alpha_i [y_i(X_i^TW+b) - 1 + \\xi_i] - \\sum_{i=1}^n \\beta_i \\xi_i\\tag{3.2.1}$$ç±»ä¼¼2.4èŠ‚ï¼Œä¸ºäº†æ±‚å¾—å¯¹å¶é—®é¢˜çš„è§£ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ±‚å¾—$L(W,b,\\xi,\\alpha,\\beta)$å¯¹ $W$ã€$b$ å’Œ $\\xi$ çš„æå°å†æ±‚å¯¹ $\\alpha$ å’Œ $\\beta$ çš„æå¤§ã€‚ ä»¥ä¸‹ä¸¤æ­¥å’Œ2.4èŠ‚å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œé™¤äº†æœ€åå¯¹ $\\alpha$ çš„çº¦æŸæ¡ä»¶ç•¥æœ‰ä¸åŒã€‚ (1) æ±‚$\\underset{W, b, \\xi}{min} L(W,b,\\xi,\\alpha,\\beta)$:å°† $L(W,b,\\xi,\\alpha,\\beta)$ åˆ†åˆ«å¯¹ $W$ã€$b$ å’Œ $\\xi$ æ±‚åå¯¼å¹¶ä»¤ä¸º0å¯å¾—$$W=\\sum_{i=1}^n \\alpha_i y_i X_i \\tag{3.2.2}$$$$\\sum_{i=1}^n \\alpha_i y_i = 0 \\tag{3.2.3}$$$$C = \\alpha_i + \\beta_i \\tag{3.2.4}$$å°†ä¸Šé¢ä¸‰ä¸ªå¼å­ä»£å…¥å¼ $(3.2.1)$ å¹¶è¿›è¡Œç±»ä¼¼å¼ $(2.4.8)$ çš„æ¨å¯¼å³å¾—$$\\underset{W, b, \\xi}{min} L(W,b,\\xi,\\alpha,\\beta) =-\\frac 1 2 \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j X_i^T X_j \\ + \\ \\sum_{i=1}^n \\alpha_i \\tag{3.2.5}$$æ³¨æ„å…¶ä¸­çš„ $\\beta$ è¢«æ¶ˆå»äº†ã€‚ (2) æ±‚$\\underset{W, b, \\xi}{min} L(W,b,\\xi,\\alpha,\\beta)$å¯¹ $\\alpha$ çš„æå¤§ï¼šå¼$(3.2.5)$å¯¹$\\alpha$æ±‚æå¤§ï¼Œä¹Ÿç­‰ä»·äºå¼$(3.2.5)$å–è´Ÿæ•°åå¯¹$\\alpha$æ±‚æå°ï¼Œå³$$\\underset{\\alpha}{min} \\quad \\frac 1 2 \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j X_i^T X_j \\ - \\ \\sum_{i=1}^n \\alpha_i \\tag{3.2.6}$$åŒæ—¶æ»¡è¶³çº¦æŸæ¡ä»¶:$$\\sum_{i=1}^n \\alpha_i y_i = 0 \\\\\\\\\\quad 0 \\le \\alpha_i \\le C, i=1,2,â€¦,n. \\tag{3.2.7}$$ è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†åŸå§‹æœ€ä¼˜åŒ–é—®é¢˜$(3.1.4)$å’Œå¯¹å¶æœ€ä¼˜åŒ–é—®é¢˜$(3.2.6)$ã€$(3.2.7)$ã€‚ ç±»ä¼¼2.4èŠ‚åœ°ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨é€šè¿‡é€šç”¨çš„äºŒæ¬¡è§„åˆ’æ±‚è§£æ–¹æ³•æˆ–è€…SMOç®—æ³•æ±‚å¾—äº†$(3.2.6)$ã€$(3.2.7)$çš„æœ€ä¼˜è§£ $\\hat{\\alpha}$ï¼Œåˆ™æ ¹æ®å¼$(3.2.2)$å¯æ±‚å¾—æœ€ä¼˜$\\hat{W}$ï¼š$$\\hat{W}= \\sum_{i=1}^n \\hat{\\alpha}_i y_i X_i \\tag{3.2.8}$$å†æ ¹æ®KKTæ¡ä»¶ï¼Œå³$$\\begin{cases}ä¹˜å­éè´Ÿ: \\alpha_i \\ge 0 ,\\enspace \\beta_i \\ge 0 (i=1,2,â€¦n.ä¸‹åŒ)\\\\\\\\çº¦æŸæ¡ä»¶: y_i(X_i^TW+b) - 1\\ge \\xi_i \\\\\\\\äº’è¡¥æ¡ä»¶: \\alpha_i [y_i(X_i^TW+b) - 1+\\xi_i]=0, \\enspace \\beta_i \\xi_i=0\\end{cases}$$å¯æ±‚å¾—æ•´ä¸ªè½¯é—´éš”SVMçš„è§£ï¼Œå³:$$\\hat{W}= \\sum_{i \\in SV} \\hat{\\alpha}_i y_i X_i \\tag{3.2.9}$$$$\\hat{b} = y_j-\\sum_{i \\in SV} \\hat{\\alpha}_i y_i X_j^T X_i\\tag{3.2.10}$$å…¶ä¸­ $j$ éœ€æ»¡è¶³ $0 &lt; \\hat{\\alpha}_j &lt; C$ ã€‚ å¯¹äºä»»æ„æ ·æœ¬ $(X_i, y_i)$ ï¼Œ è‹¥ $ \\alpha_i=0$ï¼Œæ­¤æ ·æœ¬ç‚¹ä¸æ˜¯æ”¯æŒå‘é‡ï¼Œè¯¥æ ·æœ¬å¯¹æ¨¡å‹æ²¡æœ‰ä»»ä½•çš„ä½œç”¨ï¼› è‹¥ $ \\alpha_i&gt;0$ï¼Œæ­¤æ ·æœ¬æ˜¯ä¸€ä¸ªæ”¯æŒå‘é‡ã€‚ è‹¥æ»¡è¶³ $ \\alpha_i&gt;0$ ï¼Œè¿›ä¸€æ­¥åœ°ï¼Œ è‹¥ $ 0 &lt; \\alpha_i &lt; C$, ç”±å¼ $(3.2.4)$ å¾— $\\beta_i = 0$ï¼Œå³åˆšå¥½ $y_i(X_i^TW+b) =1$ï¼Œæ ·æœ¬æ°å¥½åœ¨æœ€å¤§é—´éš”è¾¹ç•Œä¸Šï¼› è‹¥ $\\alpha_i = C$ï¼Œæœ‰$\\beta_i &gt; 0$ï¼Œæ­¤æ—¶è‹¥ $\\beta_i &lt; 1$åˆ™è¯¥æ ·æœ¬è½åœ¨æœ€å¤§é—´éš”å†…éƒ¨ï¼Œè‹¥ $\\beta_i &gt; 1$ åˆ™è¯¥æ ·æœ¬è½åœ¨æœ€å¤§é—´éš”å†…éƒ¨å³è¢«é”™è¯¯åˆ†ç±»ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾3.2 å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸2.4èŠ‚ç›¸åŒçš„ç»“è®ºï¼Œæœ€ä¼˜è¶…å¹³é¢åªä¸æ”¯æŒå‘é‡æœ‰å…³è€Œä¸éæ”¯æŒå‘é‡æ— å…³ã€‚ 3.3 æƒ©ç½šå‚æ•° $C$å¯¹äºä¸åŒæƒ©ç½šå‚æ•° $C$ï¼ŒSVMç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ å›¾3.3 å†æ¥çœ‹çœ‹æˆ‘ä»¬çš„åŸå§‹ç›®æ ‡å‡½æ•°:$$\\underset{W,b,\\xi}{min} \\quad \\frac 1 2 ||W||^2 + C \\sum_{i=1}^n \\xi_i$$ å¯¹äºæ›´åŠ ä¸€èˆ¬åŒ–çš„é—®é¢˜ï¼Œå¯å°†ä¸Šè¿°å¼å­æŠ½è±¡æˆï¼š$$\\underset{f}{min} \\quad \\Omega(f) + C \\sum_{i=1}^n l(f(x_i),y_i) \\tag{3.3.1}$$å‰ä¸€é¡¹å¯ä»¥ç†è§£ä¸ºâ€œç»“æ„é£é™©(structural risk)â€ï¼Œç”¨æ¥æè¿°æ‰€æ±‚æ¨¡å‹çš„æŸäº›æ€§è´¨(SVMå°±æ˜¯è¦æ±‚é—´éš”æœ€å¤§)ï¼›ç¬¬äºŒé¡¹ç§°ä¸ºâ€œç»éªŒé£é™©(empirical risk)â€ï¼Œç”¨æ¥æè¿°æ¨¡å‹ä¸è®­ç»ƒæ•°æ®çš„å¥‘åˆç¨‹åº¦(å³è¯¯å·®)ã€‚è€Œå‚æ•° $C$ å°±æ˜¯ç”¨äºå¯¹äºŒè€…çš„æŠ˜ä¸­,å³æˆ‘ä»¬ä¸€æ–¹é¢è¦æ±‚æ¨¡å‹è¦æ»¡è¶³æŸç§æ€§è´¨å¦ä¸€æ–¹é¢åˆæƒ³ä½¿æ¨¡å‹ä¸è®­ç»ƒæ•°æ®å¾ˆå¥‘åˆã€‚ ä»æ­£åˆ™åŒ–è§’åº¦æ¥è®²ï¼Œ $\\Omega(f)$ ç§°ä¸ºæ­£åˆ™åŒ–é¡¹ï¼Œ$C$ ç§°ä¸ºæƒ©ç½šå‚æ•°ï¼Œ$C$ è¶Šå¤§å³å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šè¶Šå¤§(è¦æ±‚æ¨¡å‹å¯¹è®­ç»ƒæ¨¡å‹æ›´å¥‘åˆ)ï¼Œè¿™å¯èƒ½ä¼šå­˜åœ¨è¿‡æ‹Ÿåˆï¼›$C$ è¶Šå°å³ç›¸å¯¹æ›´åŠ çœ‹é‡æ­£åˆ™åŒ–é¡¹ï¼Œæ­¤æ—¶å¯èƒ½å­˜åœ¨æ¬ æ‹Ÿåˆã€‚ 4. éçº¿æ€§SVMâ€”â€”æ ¸æŠ€å·§å‰é¢ä»‹ç»çš„éƒ½æ˜¯çº¿æ€§é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éçº¿æ€§çš„é—®é¢˜(ä¾‹å¦‚å¼‚æˆ–é—®é¢˜)ï¼Œæ­¤æ—¶å°±éœ€è¦ç”¨åˆ°æ ¸æŠ€å·§(kernel trick)å°†çº¿æ€§æ”¯æŒå‘é‡æœºæ¨å¹¿åˆ°éçº¿æ€§æ”¯æŒå‘é‡æœºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ä»…ä»…æ˜¯SVMï¼Œå¾ˆå¤šçº¿æ€§æ¨¡å‹éƒ½å¯ä»¥ç”¨æ ¸æŠ€å·§æ¨å¹¿åˆ°éçº¿æ€§\u001cæ¨¡å‹ï¼Œä¾‹å¦‚æ ¸çº¿æ€§åˆ¤åˆ«åˆ†æ(KLDA)ã€‚ 4.1 æ ¸å‡½æ•°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ ¸æŠ€å·§çš„åŸºæœ¬æ€è·¯åˆ†ä¸ºä¸¤æ­¥: ä½¿ç”¨ä¸€ä¸ªå˜æ¢å°†åŸç©ºé—´çš„æ•°æ®æ˜ å°„åˆ°æ–°ç©ºé—´(ä¾‹å¦‚æ›´é«˜ç»´ç”šè‡³æ— ç©·ç»´çš„ç©ºé—´)ï¼› ç„¶ååœ¨æ–°ç©ºé—´é‡Œç”¨çº¿æ€§æ–¹æ³•ä»è®­ç»ƒæ•°æ®ä¸­å­¦ä¹ å¾—åˆ°æ¨¡å‹ã€‚ å›¾4.1 æ€æ ·æ˜ å°„åˆ°ç‰¹å¾ç©ºé—´ï¼Ÿ å…ˆæ¥çœ‹çœ‹æ ¸å‡½æ•°çš„å®šä¹‰ï¼Œ è®¾ $\\mathcal{X}$ æ˜¯è¾“å…¥ç©ºé—´(æ¬§å¼ç©ºé—´$R^n$çš„å­é›†æˆ–ç¦»æ•£é›†åˆ)ï¼Œåˆè®¾ $\\mathcal{H}$ æ˜¯ç‰¹å¾ç©ºé—´(å¸Œå°”ä¼¯ç‰¹ç©ºé—´)ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ª $\\mathcal{X}$ åˆ° $\\mathcal{H}$ çš„æ˜ å°„$$\\phi(x): \\mathcal{X} \\to \\mathcal{H}$$ä½¿å¾—å¯¹æ‰€æœ‰ $x,z \\in \\mathcal{X}$ï¼Œå‡½æ•° $K(x,z)$ æ»¡è¶³æ¡ä»¶$$K(x,z)=\\phi(x) \\cdot \\phi(z)$$åˆ™ç§° $K(x,z)$ ä¸ºæ ¸å‡½æ•°ï¼Œ $\\phi(x)$ ä¸ºæ˜ å°„å‡½æ•°ï¼Œå¼ä¸­ $\\phi(x) \\cdot \\phi(z)$ ä¸º $\\phi(x)$ å’Œ $\\phi(z)$ çš„å…§ç§¯ã€‚ é€šå¸¸ï¼Œç›´æ¥è®¡ç®— $K(x,z)$ æ¯”è¾ƒå®¹æ˜“è€Œé€šè¿‡ $\\phi(x)$ å’Œ $\\phi(z)$ è®¡ç®— $K(x,z)$ å¹¶ä¸å®¹æ˜“ã€‚è€Œå¹¸è¿çš„æ˜¯ï¼Œåœ¨çº¿æ€§æ”¯æŒå‘é‡æœºçš„å¯¹å¶é—®é¢˜ä¸­ï¼Œæ— è®ºæ˜¯ç›®æ ‡å‡½æ•°è¿˜æ˜¯å†³ç­–å‡½æ•°éƒ½åªæ¶‰åŠåˆ°è¾“å…¥æ ·æœ¬ä¸æ ·æœ¬ä¹‹é—´çš„å…§ç§¯ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦æ˜¾å¼åœ°å®šä¹‰æ˜ å°„ $\\phi(x)$ æ˜¯ä»€ä¹ˆè€Œåªéœ€äº‹å…ˆå®šä¹‰æ ¸å‡½æ•° $K(x,z)$ å³å¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ ¸å‡½æ•° $K(x,z)$ ç»™å®šçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ©ç”¨è§£çº¿æ€§é—®é¢˜çš„æ–¹æ³•æ±‚è§£éçº¿æ€§é—®é¢˜çš„æ”¯æŒå‘é‡æœºï¼Œæ­¤è¿‡ç¨‹æ˜¯éšå¼åœ°åœ¨ç‰¹å¾ç©ºé—´ä¸­è¿›è¡Œçš„ã€‚ 4.2 æ­£å®šæ ¸ç”±ä¸Šé¢çš„ä»‹ç»å¯çŸ¥ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰æ ¸å‡½æ•°å°±å¯ä»¥äº†ã€‚ä½†æ˜¯å¦‚ä½•ä¸é€šè¿‡æ˜ å°„ $\\phi(x)$ åˆ¤æ–­ç»™å®šçš„ä¸€ä¸ªå‡½æ•° $K(x,z)$ æ˜¯ä¸æ˜¯æ ¸å‡½æ•°å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œ$K(x,z)$ éœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶æ‰æ˜¯ä¸€ä¸ªæ ¸å‡½æ•°ã€‚ é€šå¸¸æ‰€è¯´çš„æ ¸å‡½æ•°å°±æ˜¯æ­£å®šæ ¸å‡½æ•°ï¼Œä¸‹é¢ä¸åŠ è¯æ˜çš„ç»™å‡ºæ­£å®šæ ¸çš„å……è¦æ¡ä»¶ï¼Œå…·ä½“è¯æ˜ç•¥æ˜¾å¤æ‚ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹ã€‚ è®¾ $\\mathcal{X} \\subset R^n$ ,$K(x,z)$ æ˜¯å®šä¹‰åœ¨ $\\mathcal{X} \\times \\mathcal{X}$ ä¸Šçš„å¯¹ç§°å‡½æ•°ï¼Œå¦‚æœå¯¹ä»»æ„çš„ $x_i \\in \\mathcal{X}, i=1,2,â€¦,m$ï¼Œ$K(x,z)$ å¯¹åº”çš„GramçŸ©é˜µ$$K = [K(x_i, x_j)]_{m \\times m}$$æ˜¯åŠæ­£å®šçŸ©é˜µï¼Œåˆ™ $K(x,z)$ æ˜¯æ­£å®šæ ¸ã€‚ è™½ç„¶æœ‰äº†ä¸Šè¿°å®šä¹‰ï¼Œä½†æ˜¯å®é™…åº”ç”¨æ—¶éªŒè¯ $K(x,z)$ æ˜¯å¦æ˜¯æ­£å®šæ ¸ä¾ç„¶ä¸å®¹æ˜“ï¼Œå› æ­¤åœ¨å®é™…é—®é¢˜ä¸­ä¸€èˆ¬ä½¿ç”¨å·²æœ‰çš„æ ¸å‡½æ•°ï¼Œä¸‹é¢ç»™å‡ºä¸€äº›å¸¸ç”¨çš„æ ¸å‡½æ•°ã€‚ å¤šé¡¹å¼æ ¸å‡½æ•°(polynomial kernel function)$$K(x,z) = (x \\cdot z + 1)^p \\tag{4.2.1}$$ é«˜æ–¯æ ¸å‡½æ•°(Guassian kernel function)$$K(x,z) = exp(- \\frac {||x-z||^2} {2 \\sigma^2} ) \\tag{4.2.2}$$ 4.3 éçº¿æ€§æ”¯æŒå‘é‡æœºå¦‚å‰4.1ã€4.2æ‰€è¿°ï¼Œåˆ©ç”¨æ ¸æŠ€å·§å¯ä»¥å¾ˆç®€å•åœ°æŠŠçº¿æ€§æ”¯æŒå‘é‡æœºæ‰©å±•åˆ°éçº¿æ€§æ”¯æŒå‘é‡æœºï¼Œåªéœ€å°†çº¿æ€§æ”¯æŒå‘é‡æœºä¸­çš„å…§ç§¯æ¢æˆæ ¸å‡½æ•°å³å¯ã€‚ä¸‹é¢ç®€è¿°éçº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•ã€‚ é¦–å…ˆé€‰å–é€‚å½“çš„æ ¸å‡½æ•° $K(x,z)$ å’Œé€‚å½“çš„å‚æ•° $C$ï¼Œæ„é€ æœ€ä¼˜åŒ–é—®é¢˜$$\\begin{aligned}&amp; \\underset{\\alpha}{min} \\quad \\frac 1 2 \\sum_{i=1}^n \\sum_{j=1}^n \\alpha_i \\alpha_j y_i y_j K(X_i,X_j) \\ - \\ \\sum_{i=1}^n \\alpha_i \\\\\\\\&amp; s.t. \\quad \\sum_{i=1}^n \\alpha_i y_i = 0 \\\\\\\\&amp; \\qquad 0 \\le \\alpha_i \\le C, i=1,2,â€¦,n.\\end{aligned} \\tag{4.3.1}$$å†åˆ©ç”¨ç°æˆçš„äºŒæ¬¡è§„åˆ’é—®é¢˜æ±‚è§£ç®—æ³•æˆ–è€…SMOç®—æ³•æ±‚å¾—æœ€ä¼˜è§£ $\\hat{\\alpha}$ ã€‚ é€‰æ‹© $\\hat{\\alpha}$ çš„ä¸€ä¸ªæ»¡è¶³ $0 &lt; \\hat{\\alpha}_j &lt; C$ çš„åˆ†é‡ $\\hat{\\alpha}_j$ ï¼Œè®¡ç®—$$\\hat{b} = y_j-\\sum_{i \\in SV} \\hat{\\alpha}_i y_i K(X_j,X_i)\\tag{4.3.2}$$ æ„é€ å†³ç­–å‡½æ•°ï¼š$$f(x)=sign(\\sum_{i \\in SV}\\hat{\\alpha}_i y_i K(X_j,X_i) + \\hat{b}) \\tag{4.3.3}$$ 5. æ€»ç»“5.1 SVMä¼˜ç¼ºç‚¹ä»»ä½•ç®—æ³•éƒ½æœ‰å…¶ä¼˜ç¼ºç‚¹ï¼Œæ”¯æŒå‘é‡æœºä¹Ÿä¸ä¾‹å¤–ã€‚ æ”¯æŒå‘é‡æœºçš„ä¼˜ç‚¹æ˜¯: ç”±äºSVMæ˜¯ä¸€ä¸ªå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œæ‰€ä»¥æ±‚å¾—çš„è§£ä¸€å®šæ˜¯å…¨å±€æœ€ä¼˜è€Œä¸æ˜¯å±€éƒ¨æœ€ä¼˜ã€‚ ä¸ä»…é€‚ç”¨äºçº¿æ€§çº¿æ€§é—®é¢˜è¿˜é€‚ç”¨äºéçº¿æ€§é—®é¢˜(ç”¨æ ¸æŠ€å·§)ã€‚ æ‹¥æœ‰é«˜ç»´æ ·æœ¬ç©ºé—´çš„æ•°æ®ä¹Ÿèƒ½ç”¨SVMï¼Œè¿™æ˜¯å› ä¸ºæ•°æ®é›†çš„å¤æ‚åº¦åªå–å†³äºæ”¯æŒå‘é‡è€Œä¸æ˜¯æ•°æ®é›†çš„ç»´åº¦ï¼Œè¿™åœ¨æŸç§æ„ä¹‰ä¸Šé¿å…äº†â€œç»´æ•°ç¾éš¾â€ã€‚ ç†è®ºåŸºç¡€æ¯”è¾ƒå®Œå–„(ä¾‹å¦‚ç¥ç»ç½‘ç»œå°±æ›´åƒä¸€ä¸ªé»‘ç›’å­)ã€‚ æ”¯æŒå‘é‡æœºçš„ç¼ºç‚¹æ˜¯: äºŒæ¬¡è§„åˆ’é—®é¢˜æ±‚è§£å°†æ¶‰åŠmé˜¶çŸ©é˜µçš„è®¡ç®—(mä¸ºæ ·æœ¬çš„ä¸ªæ•°), å› æ­¤SVMä¸é€‚ç”¨äºè¶…å¤§æ•°æ®é›†ã€‚(SMOç®—æ³•å¯ä»¥ç¼“è§£è¿™ä¸ªé—®é¢˜) åªé€‚ç”¨äºäºŒåˆ†ç±»é—®é¢˜ã€‚(SVMçš„æ¨å¹¿SVRä¹Ÿé€‚ç”¨äºå›å½’é—®é¢˜ï¼›å¯ä»¥é€šè¿‡å¤šä¸ªSVMçš„ç»„åˆæ¥è§£å†³å¤šåˆ†ç±»é—®é¢˜) 5.2 SVMè°ƒå‚ç»éªŒSVMå¾ˆé€‚åˆåšåˆ†ç±»ä»»åŠ¡ï¼Œä½†æ˜¯å¦‚æœåˆšå¼€å§‹æ¥è§¦SVMè€Œä¸çŸ¥é“å¦‚ä½•è¿›è¡Œåˆç†çš„å‚æ•°é€‰æ‹©çš„è¯å¯èƒ½å¾—ä¸åˆ°æ»¡æ„çš„ç»“æœã€‚ä¸‹é¢ç®€ä»‹è¿ç”¨SVMçš„åŸºæœ¬æ­¥éª¤ï¼Œæˆ–è€…è¯´è°ƒå‚ç»éªŒã€‚ ä¸»è¦å‚è€ƒ:Hsu C W, Chang C C, Lin C J. A practical guide to support vector classification[J]. 2003. å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºSVMç®—æ³•æœŸå¾…çš„æ ¼\u001c\u001cå¼ï¼› å°†æ•°æ®è¿›è¡Œscaling(å¾ˆé‡è¦)ï¼› ä¸€èˆ¬è€ƒè™‘ç”¨é«˜æ–¯æ ¸RBF(å¦‚æœç‰¹å¾ç»´åº¦å¤ªé«˜ï¼Œå»ºè®®ç›´æ¥ç”¨çº¿æ€§SVM)ï¼› äº¤å‰éªŒè¯å¯»æ‰¾æœ€ä¼˜çš„RBFçš„å‚æ•°ä»¥åŠå‚æ•° $C$ ; ç”¨ä¸Šé¢æ‰¾åˆ°çš„æœ€ä¼˜å‚æ•°åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šè®­ç»ƒï¼›","categories":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"https://tangshusen.me/categories/Machine-Learning/"}],"tags":[{"name":"SVM","slug":"SVM","permalink":"https://tangshusen.me/tags/SVM/"},{"name":"kernel trick","slug":"kernel-trick","permalink":"https://tangshusen.me/tags/kernel-trick/"},{"name":"classification","slug":"classification","permalink":"https://tangshusen.me/tags/classification/"}]}]}