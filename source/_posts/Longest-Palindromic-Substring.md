---
title: Longest Palindromic Substring(æœ€é•¿å›æ–‡å­ä¸²)
date: 2018-12-01 22:23:15
toc: true
mathjax: true
categories: 
- LeetCode
tags:
- åŠ¨æ€è§„åˆ’
- é©¬æ‹‰è½¦ç®—æ³•
- å­—ç¬¦ä¸²
---


# 1. é—®é¢˜æè¿°
Given a string s, find the longest palindromic substring in s. You may assume that the maximum length of s is 1000.
ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œæ‰¾å‡ºsä¸­çš„æœ€é•¿å›æ–‡å­ä¸²ã€‚sçš„é•¿åº¦ä¸è¶…è¿‡1000.

<!-- more -->

Example 1:
>Input: "babad"
Output: "bab"
Note: "aba" is also a valid answer.

Example 2:
> Input: "cbbd"
Output: "bb"

# 2. é¢˜è§£
## 2.1 æš´åŠ›æ³•
### 2.1.1 æ€è·¯
æš´åŠ›ç©·ä¸¾æ‰€æœ‰å­å­—ç¬¦ä¸²çš„å¯èƒ½ï¼Œç„¶åä¾æ¬¡æŒ‰ä½åˆ¤æ–­å…¶æ˜¯å¦æ˜¯å›æ–‡ã€‚è™½ç„¶å…¶æ—¶é—´å¤æ‚åº¦å¾ˆé«˜ï¼Œä½†å®ƒå¯¹ç©ºé—´çš„è¦æ±‚å¾ˆä½ã€‚
### 2.1.2 å¤æ‚åº¦
ç©ºé—´å¤æ‚åº¦æ˜¾ç„¶ä¸º $O(1)$ ï¼›
ç©·ä¸¾æ‰€æœ‰å­—ç¬¦ä¸²å¤æ‚åº¦ä¸º $O(n^2)$ ï¼Œå†åŠ ä¸Šåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡çš„ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ ã€‚

### 2.1.3 ä»£ç 
ä»£ç å°±ä¸ç»™äº†ï¼Œç»™äº†ä½ ä¹Ÿä¸ä¼šçœ‹ğŸ˜€

## 2.2 åŠ¨æ€è§„åˆ’
### 2.2.1 æ€è·¯
æˆ‘ä»¬çŸ¥é“ï¼Œå½“æŸä¸ªå­—ç¬¦ä¸²æ˜¯å›æ–‡çš„æ—¶å€™ï¼Œåœ¨å®ƒä¸¤è¾¹åŒæ—¶å¢åŠ ä¸€ä¸ªç›¸åŒå­—ç¬¦åè‚¯å®šä¾ç„¶æ˜¯å›æ–‡çš„ï¼Œä¾‹å¦‚ bccb -> abccbaã€‚åŸºäºè¿™ä¸ªç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†æš´åŠ›æ³•ä¸­çš„åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡è¿™ä¸€æ­¥ç”¨åŠ¨æ€è§„åˆ’è§£å†³ã€‚

å…·ä½“çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ‰€æœ‰é•¿åº¦ä¸º1çš„å­å­—ç¬¦ä¸²è®¡ç®—å‡ºæ¥ï¼Œè¿™äº›å¿…å®šæ˜¯å›æ–‡çš„ï¼›ç„¶åè®¡ç®—å‡ºæ‰€æœ‰é•¿åº¦ä¸º2çš„å­å­—ç¬¦ä¸²å¹¶åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡ã€‚åˆ°é•¿åº¦ä¸º3çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸Šæ¬¡çš„è®¡ç®—ç»“æœï¼šå¦‚æœä¸­å¿ƒå¯¹ç§°çš„çŸ­å­—ç¬¦ä¸²ä¸æ˜¯å›æ–‡ï¼Œé‚£é•¿å­—ç¬¦ä¸²ä¹Ÿä¸æ˜¯ï¼Œå¦‚æœçŸ­å­—ç¬¦ä¸²æ˜¯å›æ–‡ï¼Œé‚£å°±è¦çœ‹é•¿å­—ç¬¦ä¸²ä¸¤å¤´æ˜¯å¦ä¸€æ ·ã€‚è¿™æ ·ï¼Œä¸€ç›´åˆ°é•¿åº¦æœ€å¤§çš„å­å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°±æŠŠæ•´ä¸ªå­—ç¬¦ä¸²é›†ç©·ä¸¾å®Œäº†ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç”¨ä¸€ä¸ª n x n çš„äºŒç»´boolå‹æ•°ç»„`isOK`è®°å½•æ˜¯å¦ä¼šå›æ–‡ï¼Œå…¶ä¸­næ˜¯å­—ç¬¦ä¸²sçš„é•¿åº¦ï¼Œ`isOK[i][j] == true`å°±è¡¨ç¤ºå­ä¸²`s[i...j]`æ˜¯å›æ–‡çš„ã€‚

### 2.2.2 å¤æ‚åº¦
ç”±äºè¦ç”³è¯·ä¸€ä¸ªäºŒç»´æ•°ç»„`isOK`, æ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸º $O(n^2)$ ;
ç”±äºä½¿ç”¨åŠ¨æ€è§„åˆ’ï¼Œæ—¶é—´å¤æ‚åº¦ä»æš´åŠ›æ³•çš„ $O(n^3)$ å‡å°‘åˆ° $O(n^2)$ã€‚
å®æµ‹:
> Runtime: 244 ms, faster than 14.67% of C++ online submissions for Longest Palindromic Substring.

### 2.2.3 ä»£ç 
``` C++
class Solution {
public:
    string longestPalindrome(string s) {
        if(!s.size()) return "";
        vector<vector<bool>>isOK(s.size(), vector<bool>(s.size(), false));
        string res = "";
        for(int len = 1; len <= s.size(); len++){ // lenä»£è¡¨å­ä¸²é•¿åº¦
            for(int start = 0; start + len <= s.size(); start++){ // startä»£è¡¨å­ä¸²èµ·å§‹ä½ç½®
                if(len == 1) isOK[start][start] = true;
                else if(len == 2) isOK[start][start + 1] = (s[start] == s[start + 1]);
                else isOK[start][start + len - 1] = isOK[start + 1][start + len - 2] \
                    && s[start] == s[start + len - 1];
                
                // æ›´æ–°ç»“æœ
                if(isOK[start][start + len - 1] && len > res.size())
                    res = s.substr(start, len);
            } 
        } 
        return res;
    }
};
```

## 2.3 ä¸­å¿ƒæ‰©æ•£æ³•
### 2.3.1 æ€è·¯
ä¸Šé¢è®²çš„åŠ¨æ€è§„åˆ’è™½ç„¶ä¼˜åŒ–äº†æ—¶é—´ï¼Œä½†ä¹Ÿæµªè´¹äº†å¾ˆå¤šç©ºé—´ã€‚å®é™…ä¸Šæˆ‘ä»¬å¹¶ä¸éœ€è¦ä¸€ç›´å­˜å‚¨æ‰€æœ‰å­å­—ç¬¦ä¸²çš„å›æ–‡æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„åªæ˜¯ä¸­å¿ƒå¯¹ç§°çš„è¾ƒå°ä¸€å±‚æ˜¯å¦æ˜¯å›æ–‡ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬ä»å°åˆ°å¤§è¿ç»­ä»¥æŸç‚¹ä¸ºä¸ªä¸­å¿ƒçš„æ‰€æœ‰å­å­—ç¬¦ä¸²è¿›è¡Œè®¡ç®—ï¼Œå°±èƒ½çœç•¥è¿™ä¸ªç©ºé—´ã€‚ 
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºä¸­å¿ƒå¯¹ç§°æœ‰ä¸¤ç§æƒ…å†µ:
1. é•¿åº¦ä¸ºå¥‡æ•°ï¼Œåˆ™ä»¥ä¸­å¿ƒå­—æ¯å¯¹ç§°ï¼›
2. é•¿åº¦ä¸ºå¶æ•°ï¼Œåˆ™ä»¥ä¸¤ä¸ªå­—æ¯ä¸­é—´ä¸ºå¯¹ç§°ã€‚

æ‰€ä»¥æˆ‘ä»¬è¦åˆ†åˆ«è®¡ç®—è¿™ä¸¤ç§å¯¹ç§°æƒ…å†µã€‚

### 2.3.2 å¤æ‚åº¦
ç›¸è¾ƒäº2.2çš„åŠ¨æ€è§„åˆ’ï¼Œç©ºé—´å¤æ‚åº¦ç¼©å°ä¸º $O(1)$ï¼›
æ—¶é—´å¤æ‚åº¦ä¸€æ ·ï¼Œéƒ½æ˜¯ $O(n^2)$ã€‚
å®æµ‹:
> Runtime: 20 ms, faster than 57.88% of C++ online submissions for Longest Palindromic Substring.

### 2.3.3 ä»£ç 
``` C++
class Solution {
public:
    string longestPalindrome(string s) {
        if(!s.size()) return "";
        string res = s.substr(0, 1); 
        for(int mid = 0; mid < s.size(); mid++){ // midä¸ºä¸­å¿ƒå­—æ¯æˆ–è€…å¯¹ç§°è½´çš„å‰ä¸€ä¸ªå­—æ¯çš„ä¸‹æ ‡
            // midä¸ºä¸­å¿ƒå­—æ¯ä¸‹æ ‡ï¼Œå³å­ä¸²é•¿åº¦ä¸ºå¥‡æ•°
            for(int half_len = 1; mid + half_len < s.size() && mid - half_len >= 0; half_len++){
                if(s[mid + half_len] != s[mid - half_len]) break;
                if(2 * half_len + 1 > res.size())
                    res = s.substr(mid - half_len, 2*half_len + 1);
            }
            
            // midä¸ºå¯¹ç§°è½´çš„å‰ä¸€ä¸ªå­—æ¯ï¼Œå³å­ä¸²é•¿åº¦ä¸ºå¶æ•°
            for(int half_len = 1; mid + half_len < s.size() && mid - half_len >= -1; half_len++){
                if(s[mid + half_len] != s[mid - half_len + 1]) break;
                if(2 * half_len > res.size())
                    res = s.substr(mid - half_len + 1, 2 * half_len);
            }
        }
        return res;
    }
};
```
## 2.4 é©¬æ‹‰è½¦(Manacher)ç®—æ³•
ä¸‹é¢è¦å‡ºåœºçš„å°±æ˜¯å¤§åé¼é¼çš„é©¬æ‹‰è½¦ç®—æ³•äº†ï¼Œå‰é¢ä»‹ç»çš„ç®—æ³•æœ€å¿«ä¹Ÿä¸è¿‡ $O(n^2)$ çš„æ—¶é—´å¤æ‚åº¦ï¼Œè€Œé©¬æ‹‰è½¦çš„æ—¶é—´å¤æ‚åº¦ä¸ºé€†å¤©çš„ $O(n)$ ğŸ˜¨ï¼Œæ˜¯æ­¤é¢˜æœ€ç†æƒ³çš„å¤æ‚åº¦äº†ã€‚
> æœ¬èŠ‚ä¸»è¦å‚è€ƒ[LeetCodeå¯¹æ­¤ç®—æ³•çš„è¯¦ç»†è§£é‡Šã€‚](https://articles.leetcode.com/longest-palindromic-substring-part-ii/)

### 2.4.1 æ€è·¯
é¦–å…ˆï¼Œä¸ºäº†é¿å…2.3é‚£æ ·å°†å­ä¸²åˆ†ä¸ºé•¿åº¦ä¸ºå¥‡æ•°å’Œå¶æ•°ä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬å…ˆå°†å­—ç¬¦ä¸²ç®€å•å¤„ç†ä¸€ä¸‹, åœ¨sä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸¤è¾¹æ’å…¥ä¸€ä¸ªå­—ç¬¦â€œ#â€å¾—åˆ°å­—ç¬¦ä¸²(åœ¨å…·ä½“å®ç°ä¸­ï¼Œä¸ºäº†é¿å…è¶Šç•Œæ£€æŸ¥ï¼Œé€šå¸¸è¿˜ä¼šåœ¨é¦–å°¾é¢å¤–æ’å…¥ä¸¤ä¸ªä¸æ‰€æœ‰å¯èƒ½çš„å­—ç¬¦éƒ½ä¸åŒçš„å­—ç¬¦å¦‚^ã€$),ä¾‹å¦‚ï¼š
> s = abaaba  ---æ’å…¥å­—ç¬¦-->  T = #a#b#a#a#b#a#

ä¸ºäº†æ‰¾åˆ°æœ€é•¿çš„å›æ–‡å­ä¸²ï¼Œæˆ‘ä»¬å…ˆè®¡ç®—å‡ºä»¥æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²ï¼Œç„¶åæ¯”è¾ƒä¹‹åæ‰¾å‡ºæœ€é•¿çš„ã€‚æˆ‘ä»¬ä½¿ç”¨æ•°ç»„Pæ¥ä¿å­˜ä»¥Tä¸­æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²çš„åŠå¾„(æ—¢é•¿åº¦çš„ä¸€åŠ)ã€‚ç´§æ¥ç€ä¸Šé¢çš„ä¾‹å­:
> T : # a # b # a # a # b # a #
P : 0 1 0 3 0 1 6 1 0 3 0 1 0

é€šè¿‡æ•°ç»„Pï¼Œæ‰¾åˆ°å…¶ä¸­æœ€å¤§çš„æ•°å­—6ï¼Œæˆ‘ä»¬å¯ä»¥é©¬ä¸Šå¾—å‡ºæœ€é•¿çš„å›æ–‡å­—ç¬¦ä¸²å°±æ˜¯sæœ¬èº«`abaaba`ï¼Œå³**é—®é¢˜è½¬æ¢ä¸ºå¦‚ä½•é«˜æ•ˆåœ°æ±‚è§£æ•°ç»„P**ã€‚

æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ä¸Šé¢è¿™ä¸ªç‰¹æ®Šçš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸ä»…Tæ˜¯å¯¹ç§°çš„ï¼Œå°±è¿Péƒ½æ˜¯å¯¹ç§°çš„ï¼Œç”±äºæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®¡ç®—å‡ºPçš„æ‰€æœ‰å…ƒç´ å€¼ï¼Œé‚£ä¹ˆå¦‚æœPæ˜¯å¯¹ç§°çš„ï¼Œå²‚ä¸æ˜¯å¯ä»¥å¤§å¤§å‡å°‘è®¡ç®—é‡ï¼é©¬æ‹‰è½¦ç®—æ³•å°±æ˜¯åŸºäºè¿™æ ·ä¸€ä¸ªæƒ³æ³•å±•å¼€çš„ã€‚

ä¸ºäº†è¯¦ç»†ä»‹ç»é©¬æ‹‰è½¦ç®—æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­`s = babcbabcbaccba`:
<center>
    <img src="./Longest-Palindromic-Substring/2.4.1.png" width="800" class="full-image">
</center>

å¦‚ä¸Šå›¾æ‰€ç¤º,å‡è®¾å·²ç»å®Œæˆäº†Pæ•°ç»„çš„éƒ¨åˆ†æ•°å€¼çš„è®¡ç®—ï¼Œå½“å‰éœ€è¦è®¡ç®—çš„æ˜¯`P[i]`ã€‚æˆ‘ä»¬**å¼•å…¥å˜é‡ Rï¼Œè¡¨ç¤ºå½“å‰è®¿é—®åˆ°çš„æ‰€æœ‰å›æ–‡å­ä¸²ä¸­æ‰€èƒ½è§¦åŠçš„æœ€å³ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®**ã€‚å¦å¤–è¿˜è¦è®°å½•ä¸‹Rå¯¹åº”çš„å›æ–‡ä¸²çš„å¯¹ç§°è½´æ‰€åœ¨çš„ä½ç½®ï¼Œè®°ä¸ºCã€‚å¦å¤–ä¹Ÿå¯æ¨æ–­å‡ºè¯¥å›æ–‡ä¸²çš„å·¦è¾¹ä½ç½®Lã€‚å›¾ä¸­çš„å®çº¿å³è¡¨ç¤ºCï¼Œä¸¤æ¡è™šçº¿(Lå’ŒR)åˆ†åˆ«è¡¨ç¤ºä»¥Cä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„è¾¹ç•Œã€‚ç°åœ¨éœ€è¦è®¡ç®—çš„æ˜¯ `P[i]` çš„å€¼ï¼Œå›¾ä¸­ i' è¡¨ç¤ºçš„æ˜¯ i å…³äº C å¯¹ç§°çš„ç‚¹ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆé«˜æ•ˆåœ°ç®—å‡º`P[i]`ã€‚

å½“å‰ i çš„å€¼æ˜¯ 13ï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°`P[13]`çš„å€¼ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹ä¸‹ i å…³äº Cå¯¹ç§°çš„ `i' = 9`çš„å€¼ã€‚
<center>
    <img src="./Longest-Palindromic-Substring/2.4.2.png" width="800" class="full-image">
</center>

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸¤æ¡ç»¿è‰²å®çº¿è¦†ç›–çš„åŒºåŸŸåˆ†è¡¨è¡¨ç¤ºçš„æ˜¯ ä»¥ i' å’Œ i ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“äº† `P[i'] = 1`, é‚£ä¹ˆç”±äºå›æ–‡å­ä¸²çš„å¯¹ç§°æ€§(å³ä¸Šå›¾L\~Cå’ŒC\~Rå¯¹åº”çš„å­ä¸²æ˜¯å…³äºCå¯¹ç§°çš„)ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡º `P[i] = p[i'] = 1`ã€‚å®é™…ä¸Šï¼ŒCä¹‹åçš„ä¸‰ä¸ªå…ƒç´ éƒ½éµå¾ªäº†è¿™ç§å¯¹ç§°æ€§ï¼ˆæ—¢ `P[12] = P[10] = 0, P[13] = P[9] =1, P[14] = P[8] = 0`)ã€‚

<center>
    <img src="./Longest-Palindromic-Substring/2.4.3.png" width="800" class="full-image">
</center>

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç°åœ¨æˆ‘ä»¬åˆ°äº† `i = 15` è¿™ä¸ªç‚¹ï¼Œi å…³äº Cå¯¹ç§°çš„ç‚¹æ˜¯ `i' = 7`, é‚£ä¹ˆè¿™é‡Œ `P[15] = P[7] = 7` è¿˜ä¼šä¸ä¼šæˆç«‹å‘¢ï¼Ÿ

å¾ˆæ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ï¼Œæˆ‘ä»¬å‡­è‚‰çœ¼è§‚å¯Ÿå¯çŸ¥ `p[15] = 5` è€Œ `P[7] = 7`ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
<center>
    <img src="./Longest-Palindromic-Substring/2.4.4.png" width="800" class="full-image">
</center>

ä¸Šå›¾ä¸­ï¼Œç»¿è‰²å®çº¿è¡¨ç¤ºçš„æ˜¯ä»¥Cä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²æ‰€è¦†ç›–çš„åŒºåŸŸï¼Œçº¢è‰²å®çº¿è¡¨ç¤ºçš„æ˜¯ä¸ç»¿è‰²åŒºåŸŸä¸åŒ¹é…çš„éƒ¨åˆ†ï¼Œå·¦è¾¹çš„çº¢è‰²å®çº¿æ˜¯ä»¥`T[i']`ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²æ‰€è¦†ç›–åŒºåŸŸè¶…å‡ºç»¿è‰²å®çº¿çš„éƒ¨åˆ†ã€‚å³è¾¹çš„çº¢è‰²å®çº¿æ˜¯ä»¥`T[i]`ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²æ‰€è¦†ç›–åŒºåŸŸè¶…å‡ºç»¿è‰²å®çº¿çš„éƒ¨åˆ†ã€‚è€Œç»¿è‰²çš„è™šçº¿éƒ¨åˆ†åˆ™æ˜¯åˆ†åˆ«ä»¥`T[i]`å’Œ`T[i']`ä¸ºä¸­å¿ƒæœ€é•¿å›æ–‡å­ä¸²ä¸ç»¿è‰²å®çº¿éƒ¨åˆ†çš„é‡å éƒ¨åˆ†ã€‚

ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥æ˜æ˜¾çš„çœ‹å‡ºè¢«ä¸¤æ¡ç»¿è‰²å®çº¿æ‰€è¦†ç›–çš„åŒºåŸŸä¸­ï¼ŒCä¸¤è¾¹çš„å­ä¸²æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚åŒæ—¶ç»¿è‰²è™šçº¿çš„é‚£éƒ¨åˆ†ä¹Ÿæ˜¯å…³äºä¸­å¿ƒå¯¹ç§°çš„ã€‚å½“ `i = 12,13,14` å³ `i' = 10,9,8` æ—¶ï¼Œä»¥`T[i']`ä¸ºä¸­å¿ƒçš„æœ€å¤§å›æ–‡å­ä¸²å…¨è½åœ¨äº†Lå’ŒRä¹‹é—´ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨LRçš„å¯¹ç§°æ€§ç›´æ¥å¾—å‡ºå…³äº`T[i]`å¯¹ç§°çš„æœ€å¤§å›æ–‡å­ä¸²ï¼›ä½†å½“ `i' = 7` å³ `P[i'] = 7`ï¼Œæ­¤æ—¶ä»¥`T[i']`ä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²è¶…å‡ºäº†ä»¥Cä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡å­ä¸²çš„å·¦è¾¹ç•Œ(å›¾ä¸­Lå·¦è¾¹çº¢è‰²å®çº¿)ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ­¤æ—¶æ— æ³•å†æŒ‰ç…§å¯¹ç§°æ€§ç›´æ¥å¾—å‡º `P[i]` çš„å€¼äº†ï¼Œä½†æ˜¯å¯ä»¥æ¨å‡º `P[i] >= 5`ã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“çš„æ˜¯`P[i] >= 5`, ä¸ºäº†æ‰¾å‡º`P[i]`æœ€ç»ˆçš„å€¼ï¼Œæˆ‘ä»¬åªæœ‰ç»§ç»­ä»¥`P[i]`ä¸ºä¸­å¿ƒå‘ä¸¤è¾¹æ‰©å±•è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­`P[21] != P[1]`,é‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆæ¨æ–­æ˜¯`P[i] = 5`ã€‚

æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­ï¼Œéƒ½å­˜åœ¨ä¸¤ç§å¯èƒ½:
1. `R > i`ï¼Œä¹Ÿå°±æ˜¯åˆšåˆšæˆ‘ä»¬è®¨è®ºçš„æƒ…å†µï¼Œæ­¤æ—¶åˆç»†åˆ†ä¸ºä¸¤ç§æƒ…å†µ:
(1) è‹¥ `P[i'] < R â€“ i`, åˆ™ä»¤ `P[i] = P[i']`;
(2) å¦åˆ™ï¼Œ å…ˆä»¤`P[i] = P[i']`ï¼Œå†ä»¥iä¸ºä¸­å¿ƒæ‰©å±•å›æ–‡ä¸²å¹¶`P[i]++`ï¼Œç›´åˆ°å·¦å³ä¸¤è¾¹å­—ç¬¦ä¸åŒæˆ–è€…åˆ°è¾¾è¾¹ç•Œã€‚å¹¶æ›´æ–°å˜é‡Rã€Cã€‚
2. `R <= i`ï¼Œå³iç§»åŠ¨åˆ°Rå³è¾¹äº†ï¼Œæ­¤æ—¶ä¹Ÿåº”è¯¥ä»¥iä¸ºä¸­å¿ƒæ‰©å±•å›æ–‡ä¸²ã€‚ç±»ä¼¼æƒ…å†µ1(2),åªæ˜¯`P[i]`åˆå§‹ä¸º0ã€‚

### 2.4.2 å¤æ‚åº¦
ç©ºé—´å¤æ‚åº¦æ˜¾ç„¶æ˜¯O(n).
ä¸‹é¢è®¨è®ºä¸€ä¸‹æ—¶é—´å¤æ‚åº¦ï¼Œè™½ç„¶ä»£ç ä¸­å­˜åœ¨ä¸¤ä¸ªå¾ªç¯forå’Œwhileï¼Œä½†æ˜¯éœ€è¦æ³¨æ„æ˜¯ï¼š
* å½“Rä¸éœ€è¦è¿›è¡Œæ‰©å±•æ—¶ï¼Œä¸ä¼šè¿›å…¥whileå¾ªç¯ï¼›
* Réœ€è¦è¿›è¡Œæ‰©å±•æ—¶ï¼Œä¼šè¿›å…¥whileå¾ªç¯ï¼Œä½†æ•´ä¸ªç®—æ³•è¿‡ç¨‹while**ä¸€å…±**å¾ªç¯æœ€å¤šnæ¬¡ï¼Œå³Rä»0ä¸æ–­æ‰©å±•åˆ°nã€‚

ç”±æ­¤å¯è§ï¼Œé©¬æ‹‰è½¦ç®—æ³•æ˜¯çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦ï¼Œå³O(n)ã€‚

äº²æµ‹:
> Runtime: 8 ms, faster than 88.39% of C++ online submissions for Longest Palindromic Substring.

### 2.5.1 ä»£ç 
``` C++
class Solution {
private:
    // å°†å­—ç¬¦ä¸²Sè½¬æ¢æˆTï¼Œä¾‹å¦‚S = "abba", T = "^#a#b#b#a#$".
    // ^ å’Œ $ æ˜¯ä¸ºäº†é¿å…è¶Šç•Œæ£€æŸ¥
    string preProcess(string s) {
        int n = s.size();
        if (n == 0) return "^$";
        string t = "^";
        for (int i = 0; i < n; i++)
            t += "#" + s.substr(i, 1);
      
        t += "#$";
        return t;
    }
    
public:
    string longestPalindrome(string s) {
        string T = preProcess(s);
        int n = T.size();
        vector<int>P(n);
        int C = 0, R = 0;
        for (int i = 1; i < n-1; i++) {
            int i_mirror = 2 * C - i; // i' = C - (i-C)

            P[i] = (R > i) ? min(R - i, P[i_mirror]) : 0;

            // å°è¯•æ‰©å±•ä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²
            while (T[i + 1 + P[i]] == T[i - 1 - P[i]]) P[i]++;
 
            // å¦‚æœä»¥iä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²çš„å³è¾¹ç•Œè¶…è¿‡äº†Rï¼Œåˆ™åº”è¯¥æ›´æ–°Rå’ŒC
            if (i + P[i] > R) {
                C = i;
                R = i + P[i];
            }
        }

        // æ‰¾å‡ºPä¸­æœ€å¤§çš„å…ƒç´ 
        int maxLen = 0;
        int centerIndex = 0;
        for (int i = 1; i < n-1; i++) { //æ³¨æ„è·³è¿‡é¦–å°¾
            if (P[i] > maxLen) {
            maxLen = P[i];
            centerIndex = i;
            }
        }

        return s.substr((centerIndex - 1 - maxLen)/2, maxLen); // å‡ä¸€æ˜¯å› ä¸ºå»æ‰ç¬¬ä¸€ä¸ªå­—ç¬¦^
    }
};
```


